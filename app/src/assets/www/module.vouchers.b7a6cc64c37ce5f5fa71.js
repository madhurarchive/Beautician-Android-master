(window.webpackJsonp=window.webpackJsonp||[]).push([[287,3],{"//j4":function(e,t,a){"use strict";(function(e){a.d(t,"f",(function(){return M})),a.d(t,"a",(function(){return w})),a.d(t,"h",(function(){return x})),a.d(t,"g",(function(){return L})),a.d(t,"q",(function(){return V})),a.d(t,"p",(function(){return F})),a.d(t,"o",(function(){return R})),a.d(t,"e",(function(){return q})),a.d(t,"i",(function(){return D})),a.d(t,"m",(function(){return B})),a.d(t,"s",(function(){return G})),a.d(t,"r",(function(){return Y})),a.d(t,"j",(function(){return z})),a.d(t,"k",(function(){return H})),a.d(t,"c",(function(){return W})),a.d(t,"l",(function(){return Q})),a.d(t,"b",(function(){return K})),a.d(t,"d",(function(){return J})),a.d(t,"n",(function(){return $}));var r=a("VkAN"),o=a.n(r),n=a("9oTK"),c=a("lSNA"),i=a.n(c),s=a("mwIZ"),l=a.n(s),u=a("gY1J"),d=a("+fKR"),h=a("Q2AE"),p=a("5ZU+"),m=a("HTL0"),b=a("nbpM"),v=a("XOD0"),f=a("4r8K"),O=a("9hcw"),g=a("tT9G"),y=a("q9fD"),j=a("gsAU"),E=a("kZhr"),C=a("ePPS"),T=a("1UfZ"),S=a("15o+"),P=a("0VKN"),k=a("hr8B");function A(){var e=o()(["Mobile number not valid"]);return A=function(){return e},e}function N(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function I(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?N(Object(a),!0).forEach((function(t){i()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function M(){var e=h.a.getState(),t=!b.a.isCheckoutFlowExist(e),{operation:a,clientId:r}=b.a.getClientContext(e);return null===a?p.a.ensureCheckoutFlowExists():(t&&p.a.ensureCheckoutFlowExists(),a!==u.c.CREATE&&a!==u.c.EDIT||p.a.setCheckoutCustomer(r),p.a.resetCustomerContext()),null===a||t}function w(e,{appointmentId:t,locationId:a}){var r=x(I(I({},e.packageItems?e.packageItems[0]:e),{},{appointmentId:t})),o=e.packageItems?e.packageItems:[e],c=o.map(e=>function(e,t){if(e.voucher&&e.voucher.value)return Object(n.resolve)();var a=e.service||e.voucher&&e.voucher.service;return p.a.readItemLocationTaxRatesList({locationId:t,itemId:e.product||a,itemType:a?y.b.SERVICE:y.b.PRODUCT})}(e,a));return Object(n.all)([r,...c]).then(()=>p.a.addCheckoutItems(o))}function x(e){var t,a,{product:r,voucher:o,servicePricingLevel:n,appointmentId:c,packageInfo:i}=e;r?(t=g.a.PRODUCT,a=r):o?o.servicePricingLevel?(t=g.a.SERVICE_VOUCHER,a=o.servicePricingLevel):(t=g.a.GIFT_VOUCHER,a="".concat(o.value,":").concat(o.expirationPeriod)):i?i.packageVersionId?(t="packageVersion",a=i.packageVersionId):(t="package",a=i.packageId):n&&(t=g.a.SERVICE_PRICING_LEVEL,a=n);var s=I({itemType:t,itemId:a},c&&{appointmentId:c});return p.a.readCheckoutItemAutomaticDiscountsList(s)}function L({saleId:e,bookingId:t,locationId:a,voucherId:r,refund:o,cancellation:c,noShow:i,cancellationReasonId:s}){return(l,u)=>p.a.bulk([p.a.readLocationList,[p.a.readEmployeeList,{locationId:a}],p.a.readDiscountList,[p.a.readCheckoutPaymentMethodsList,{locationId:a}],p.a.readCancellationReasonList]).then(()=>r?function(e,t,a){return p.a.initCheckoutFromVoucherTemplate(t,a),Object(n.resolve)()}(0,a,r):e?function(e,t,a){return Object(n.all)([p.a.readSale(t),p.a.readSaleTransactionsList(t)]).then(()=>{var a=b.a.getSale(e(),t);return p.a.bulk([a.customer&&[p.a.readCustomer,a.customer,{include:"customer-payment-method"}],a.booking&&[p.a.readBooking,a.booking],[p.a.readSaleTransactionsList,t]])}).then(()=>{p.a.initCheckoutFromSale(t,a)})}(u,e,o):t?function(e,t,a,r,o){return p.a.readBooking(t).then(()=>{var a=b.a.getBooking(e(),t);return a.parent?p.a.readBooking(a.parent).then(()=>a.parent):t}).then(t=>{var a=b.a.getBooking(e(),t);return p.a.readAppointmentCheckoutItemAutomaticDiscounts(a.appointment).then(()=>a)}).then(t=>p.a.bulk([t.customer&&[p.a.readCustomer,t.customer,{include:"customer-payment-method"}],[p.a.readItemLocationTaxRatesList,{appointmentId:t.appointment}]]).then(()=>{var{operation:n}=b.a.getClientContext(e());if(null==n){var c=d.a.DEFAULT;a?c=d.a.CANCELLATION:o&&(c=d.a.NO_SHOW),p.a.initCheckoutFromAppointment(t.appointment,{cancellationReasonId:r,mode:c})}}))}(u,t,c,s,i):a?function(e,t){p.a.initCheckoutFromLocation(t);var a=e(),r=b.a.getCheckoutFlowInitialAddItemModalShown(a);return Object(O.a)()||r||(p.a.setCheckoutFlowInitialAddItemModalShown(),Object(v.c)(S.C())),Object(n.resolve)()}(u,a):Object(n.reject)(new Error("sentry fixes 1")))}var V=({cancelFutureBookings:e,cancellationReasonId:t,noShow:a}={})=>(r,o)=>{var c,i,s;try{var l=o();c=b.a.getCheckout(l),i=b.a.getCheckoutSaleId(l),s=b.a.getCheckoutItems(l)}catch(e){return Object(n.reject)(e)}if(i)return Object(n.resolve)(i);if(!c||s.length<=0)return Object(n.reject)(new Error("Sale cannot be empty"));var u=m.a.saleCreateRequest({checkout:c,checkoutItems:s,cancelFutureBookings:e,cancellationReasonId:t,noShow:a});return p.a.createSale(u).then(e=>{var{body:{data:{id:t}}}=e;return p.a.setCheckoutSale(t),t})},F=()=>(e,t)=>{var a,r,o,c;try{var i=t();a=b.a.getCheckout(i),r=b.a.getCheckoutSaleId(i),o=b.a.getCheckoutItems(i),c=b.a.getCheckoutTipList(i)}catch(e){return Object(n.reject)(e)}if(!a||o.length<=0||!r)return Object(n.reject)(new Error("Sale cannot be empty"));var s=m.a.refundCreateRequest(a,o,c);return p.a.createRefund(s).then(e=>{var{body:{data:{id:t}}}=e;return p.a.setCheckoutSale(t),t})},R=({payByApp:e=!1}={})=>(t,a)=>{var r,o,c,i,s,l,u;try{var d=a();r=b.a.getCheckoutPaymentList(d),o=Object(P.x)(d),c=b.a.getCheckoutPaymentSummary(d),i=b.a.getCheckoutTipList(d),s=b.a.getCheckoutPaymentEmployee(d),l=b.a.getCheckoutSaleId(d),u=b.a.isCheckoutRefund(d)}catch(e){return Object(n.reject)(e)}if((o||e)&&0!==Object(f.b)(c.amountDue)&&(r=[{amount:c.amountDue,freshaPay:!0,payByApp:e},...r]),!r.length)return Object(n.resolve)();var{vouchers:h,rest:v}=r.reduce((e,t)=>(e[t.voucherCode?"vouchers":"rest"].push(t),e),{vouchers:[],rest:[]}),O={employee:s,saleId:l,orderedPayments:h.concat(v),tips:i};if(u){var g=m.a.paymentRefundsCreateRequest(O);return p.a.createPaymentRefund(g)}var y=m.a.paymentsCreateRequest(O);return p.a.createPayment(y)};function q(e){var t={type:"payment-cancellation-create-requests",relationships:{payment:{data:{type:"payments",id:String(e)}}}};return p.a.createPaymentCancellation({data:t})}function D(e){var t=encodeURI(e);return(e,a)=>p.a.readVoucherCode(t).then(e=>{var t=a(),r=e.body.data.id,o=b.a.getVoucherCodeList(t).find(e=>e.id===r);return null!=o?Object(n.resolve)(o):Object(n.reject)(o)}).catch(()=>Object(n.reject)(null))}function B(e,t){p.a.addCheckoutRedeemedVoucher({voucherCode:e,amount:t})}var U,_,G=(e={})=>((e={})=>(t,a)=>p.a.searchProductList(e).then(t=>{var{data:r}=t.body,o=r.map(e=>e.id),c=a(),i=b.a.getLocationProductList(c,e.locationId);return Object(n.resolve)(i.filter(e=>o.includes(e.id)))}))(I(I({},e),{},{sellableOnly:1})),Z=Object(j.a)(p.a.readOfferCatalog,{lifeTimeInSec:300,hashParams:e=>"".concat(e.offset,":").concat(e.limit,":").concat(e.categoryId,":").concat(e.searchTerm,":").concat(e.locationId)}),Y=(e={})=>(t,a)=>{var r=Z(I(I({},e),{},{blockClearingModels:!0})),o=r.then(e=>{var t=e.map(e=>e.id),r=a(),o=b.a.getOfferCatalogItemList(r);return Object(n.resolve)(o.filter(e=>t.includes(e.id)&&!l()(e,"servicePricingLevel.deletedAt",!1)&&!l()(e,"servicePricingLevel.service.deletedAt",!1)&&!l()(e,"package.deletedAt",!1)).sort((e,t)=>e.sortingId-t.sortingId))});return o.cancel=()=>{r.cancel()},o},z=()=>(U||(U=Object(j.a)(p.a.readProductCategoryList,{lifeTimeInSec:300,hashParams:()=>"getProductCategoryList"})),U()),H=()=>(_||(_=Object(j.a)(p.a.readServiceGroupList,{lifeTimeInSec:300,hashParams:()=>"getServiceGroupList"})),_());function W(){var e=h.a.getState(),{enableOrmClear:t}=b.a.getProviderFeatureFlags(e);t&&(Z.reset(),p.a.readOfferCatalog.cache.clear(),p.a.clearOfferCatalogItems())}var Q=(t,a)=>(r,o)=>{var n=o(),c=b.a.getCheckoutCustomer(n),{amountDue:i,tipAmount:s}=b.a.getCheckoutPaymentSummary(n);s>=i?Object(v.c)(S.M(t)):(c||p.a.setCheckoutCustomerWalkIn(),Object(v.f)("".concat(t?S.o:S.u).concat(e.location.search),{skipVerification:a}))},K=e=>(t,a)=>{var r=a(),o=b.a.getCheckoutLocationId(r),n=b.a.getActiveTerminalsInLocation(r,o),c=b.a.getTerminalCheckoutPaymentMethod(r),i=Object(P.d)(r);p.a.setCheckoutPaymentFresha(),p.a.addCheckoutPayment({checkoutPaymentMethod:c.id,amount:Number(i),freshaPay:!0,terminalId:e||n[0].id}),Object(v.f)(S.x)},X=e=>{Object(E.ib)(e,{fields:[{code:"invalid-phone-number",field:k.a.CONTACT_NUMBER,jsonPointer:/\/contact-number$/,message:Object(C.c)(A())}]})},J=(e,t)=>{var a,r;return p.a.createMarketplaceCheckoutUser(m.a.createMarketplaceCheckoutUser(I({id:t},e))).catch(X).then(e=>(r=l()(e,"body.data.attributes.hasCreditCard"),a=l()(e,"body.data.id"),Object(T.i)(a,{include:"customer-payment-method"}))).then(()=>p.a.setCheckoutCustomer(a)).then(()=>r)},$=()=>e=>e(V()).then(t=>e(R({payByApp:!0})).then(()=>t))}).call(this,a("yLpj"))},"0VKN":function(e,t,a){"use strict";a.d(t,"i",(function(){return b})),a.d(t,"y",(function(){return v})),a.d(t,"v",(function(){return O})),a.d(t,"d",(function(){return g})),a.d(t,"w",(function(){return y})),a.d(t,"r",(function(){return j})),a.d(t,"p",(function(){return E})),a.d(t,"x",(function(){return C})),a.d(t,"k",(function(){return S})),a.d(t,"j",(function(){return P})),a.d(t,"B",(function(){return k})),a.d(t,"l",(function(){return A})),a.d(t,"s",(function(){return N})),a.d(t,"e",(function(){return I})),a.d(t,"o",(function(){return M})),a.d(t,"m",(function(){return w})),a.d(t,"t",(function(){return x})),a.d(t,"q",(function(){return L})),a.d(t,"h",(function(){return V})),a.d(t,"z",(function(){return F})),a.d(t,"A",(function(){return R})),a.d(t,"a",(function(){return q})),a.d(t,"n",(function(){return B})),a.d(t,"b",(function(){return U})),a.d(t,"f",(function(){return _})),a.d(t,"g",(function(){return G})),a.d(t,"u",(function(){return Z})),a.d(t,"c",(function(){return Y}));var r=a("CxY0"),o=a("G4qV"),n=a("mwIZ"),c=a.n(n),i=a("Jlc5"),s=a.n(i),l=a("jwng"),u=a("nbpM"),d=a("OXtF"),h=a("SoMk"),p=a("4r8K"),m=a("V/N5"),b=Object(o.a)(u.a.getCheckoutSalePaymentList,e=>(e||[]).filter(e=>e.status!==h.a.statuses.FAILED)),v=Object(o.a)(b,u.a.isCheckoutRefund,(e,t)=>(t||e.length>0)&&s()(e,["status",h.a.statuses.COMPLETED])),f=e=>{var t=u.a.getCheckoutCustomer(e);return Boolean(t&&t.customerPaymentMethod)},O=Object(o.a)(u.a.getCheckoutCustomer,e=>{var{expMonth:t,expYear:a}=e&&e.customerPaymentMethod||{};if(!t||!a)return!1;var r=Object(l.k)("".concat(a," ").concat(t),"YYYY MM").endOf("month").subtract(1,"day");return!Object(l.k)().isBefore(r)}),g=e=>u.a.getCheckoutPaymentSummary(e).amountDue,y=Object(o.a)(u.a.getFreshaActive,f,e=>{var t=u.a.getCheckoutSaleId(e);if(!t)return null;var a=u.a.getSaleOrignalSaleId(e,t);return u.a.getCompletedPaymentFromSaleWithFreshaPay(e,a||t)},b,u.a.isCheckoutRefund,u.a.checkoutInNoShowOrCancelMode,O,u.a.checkoutAppointmentHasNonCheckedOutFee,u.a.isCheckoutExchange,(e,t,a,r,o,n,c,i,s)=>e&&(t&&(!c||n)&&(!o||s)||a&&!s)&&(o||n||!i)),j=Object(o.a)(u.a.getCheckoutPaymentMethodList,u.a.getOnlineCardCheckoutPaymentMethod,(e,t)=>[t,...e]),E=Object(o.a)(u.a.getTerminalCheckoutPaymentMethod,g,(e,t)=>!!e&&t>0),C=e=>u.a.isCheckoutPaymentFresha(e)&&y(e),T=Object(o.a)(y,u.a.getFreshaPayStatus,u.a.isFreshaSettingPaymentsEnabled,u.a.checkoutInNoShowOrCancelMode,u.a.isCheckoutRefund,f,u.a.hasAnyPaymentNonVoucher,u.a.getCheckoutSale,u.a.checkoutAppointmentHasNonCheckedOutFee,(e,t,a,r,o,n,c,i,s)=>!e&&(!(t===m.b.DISABLED||!a)&&(!(r||o||c||null!==i)&&(!n&&!s)))),S=Object(o.a)(T,u.a.getFreshaPayStatus,u.a.isFeatureBundleEnabled,(e,t,a)=>!!e&&!(t!==m.b.ENABLED||!a)),P=Object(o.a)(T,u.a.getFreshaPayStatus,u.a.isFeatureBundleEnabled,(e,t,a)=>!!e&&(t===m.b.NOT_SET||!a)),k=Object(o.a)(u.a.getCheckoutSale,u.a.checkoutInNoShowOrCancelMode,(e,t)=>!e&&!t),A=e=>u.a.getCheckoutPaymentSummary(e).payedAmount,N=e=>{var{totalGross:t,tipAmount:a}=u.a.getCheckoutPaymentSummary(e);return t+a},I=e=>u.a.getCheckoutItems(e).length,M=Object(o.a)(u.a.getCheckoutItems,e=>e.filter(e=>Boolean(e.voucher)).length),w=e=>u.a.getCheckoutPaymentList(e).filter(e=>e.checkoutPaymentMethod).length,x=e=>u.a.getCheckoutPaymentList(e).filter(e=>e.voucherCode).length,L=e=>u.a.getCheckoutPaymentSummary(e).tipCount,V=e=>u.a.getCheckoutSalePaymentList(e).filter(e=>e.freshaPay).pop(),F=e=>A(e)>0&&0===g(e)&&Boolean(I(e)),R=e=>u.a.isCheckoutRefund(e)&&A(e)<=0&&0===g(e),q=e=>{var t=u.a.isCheckoutRefund(e),a=((e,t)=>u.a.getSaleWithPayments(e,u.a.getCheckoutSaleId(e),t))(e,{freshaPay:!0,status:"completed"}),r=c()(a,"payments",[]).pop(),o=u.a.isInvoiceWithPostTip(e,null==a?void 0:a.id);return!!(t&&a&&r)&&((o?a.totalPayments===r.amount:Object(p.b)(a.totalPayments+a.totalTips)===r.amount)&&g(e)<0)},D=e=>Object(r.parse)(Object(r.format)(e.location),!0),B=Object(o.a)(D,({query:{locationId:e,bookingId:t,saleId:a,refund:r,cancellation:o,noShow:n,cancellationReasonId:c,cancelFutureBookings:i,voucherId:s}={}})=>({locationId:e,voucherId:s,bookingId:t,saleId:a,refund:Boolean(r),cancellation:Boolean(o),noShow:Boolean(n),cancellationReasonId:c||null,cancelFutureBookings:Boolean(i)})),U=Object(o.a)(D,e=>!!e.query.canSubmit),_=Object(o.a)(u.a.getCheckoutItems,u.a.getCheckoutPaymentList,(e,t)=>{var a=e.filter(e=>e.servicePricingLevel).map(e=>Object(d.a)(e.servicePricingLevel.service));return t.filter(e=>e.voucherCode&&e.voucherCode.voucher.servicePricingLevel).map(e=>e.voucherCode.voucher.servicePricingLevel.service).forEach(e=>{var t=a.indexOf(e);t>=0&&a.splice(t,1)}),a}),G=Object(o.a)(u.a.getCheckoutPaymentList,e=>e.filter(e=>e.voucherCode).map(e=>e.voucherCode.id)),Z=Object(o.a)(u.a.getCheckoutSalePaymentList,e=>(e||[]).some(e=>e.status===h.a.statuses.FAILED)),Y=Object(o.a)(u.a.getCheckoutItems,e=>e&&e.filter(e=>!!e.voucher&&!!e.voucher.title).length>0)},"6kp7":function(e,t,a){"use strict";var r=a("q1tI"),o=a("PhEd"),n=a("17x9"),c=a.n(n),i=({children:e,setMobileContainerRef:t})=>{var a=Object(r.useContext)(o.ScrollableContentContext).containerRef;return Object(r.useEffect)(()=>{t(a)},[a,t]),e};i.propTypes={setMobileContainerRef:c.a.func,children:c.a.node},t.a=i},G3IV:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var r,o,n,c=a("lSNA"),i=a.n(c),s=a("q1tI"),l=a.n(s),u=a("17x9"),d=a.n(u),h=a("PhEd"),p=a("/Q2I"),m=a("ePPS"),b=a("dhJQ"),v=Object(b.i)()((n=o=class extends s.PureComponent{constructor(...e){super(...e),i()(this,"state",{pending:!1}),i()(this,"handleEdit",()=>{this.setState({pending:!0},()=>{this.props.onSubmitEditVoucher().then(()=>{this.setState({pending:!1})})})})}render(){var{onModalClose:e,isMatch:t}=this.props,a=Object(m.d)("vouchers","Edit voucher"),r=Object(m.d)("vouchers","Are you sure you want to edit this voucher? Vouchers that have been sold will not be changed."),o=[l.a.createElement(h.Button,{variant:"secondary",qaType:"voucher-template-edit-warning-close-button",onAction:e},Object(m.d)("vouchers","Cancel")),l.a.createElement(h.Button,{variant:"danger",qaType:"voucher-template-edit-warning-confirm-button",isPending:this.state.pending,onAction:this.handleEdit},Object(m.d)("vouchers","Yes, edit"))];return t?l.a.createElement(h.ModalFullScreen,{color:"white",qaType:"voucher-template-edit-warning-modal"},l.a.createElement(h.ModalFullScreenMobileHeader,{onClose:this.onModalClose,center:!0,title:a}),l.a.createElement(h.FullScreenModalContent,{mobileLayout:!0},l.a.createElement(h.Text,{type:"fresha-paragraph"},r)),l.a.createElement(h.ModalFullScreenMobileFooter,{buttons:o})):l.a.createElement(p.d,{fullHeight:!0},l.a.createElement(h.ModalCard,{"data-qa":"voucher-template-edit-warning-modal",title:a,rounded:!0,size:"small",withSections:!0,onClose:this.onModalClose,buttons:o},l.a.createElement(h.CardSection,null,l.a.createElement(h.Text,{type:"fresha-paragraph"},r))))}},i()(o,"propTypes",{onModalClose:d.a.func.isRequired,onSubmitEditVoucher:d.a.func.isRequired,isMatch:d.a.bool}),r=n))||r},Kdjz:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return _}));var r,o,n,c=a("pVnL"),i=a.n(c),s=a("9oTK"),l=a("QILm"),u=a.n(l),d=a("lSNA"),h=a.n(d),p=a("q1tI"),m=a.n(p),b=a("17x9"),v=a.n(b),f=a("PhEd"),O=a("/MKj"),g=a("Ty5D"),y=a("nbpM"),j=a("cB10"),E=a("5ZU+"),C=a("kZhr"),T=a("dhJQ"),S=a("XOD0"),P=a("Jje6"),k=a("ePPS"),A=a("15o+"),N=a("//j4"),I=a("6//9"),M=a("bv1S"),w=a("ZXAD"),x=a("ZoaQ"),L=a("Tven"),V=a("P4U6"),F=a("6kp7"),R=a("G3IV"),q=a("ToRZ"),D=a.n(q);function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function U(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(Object(a),!0).forEach((function(t){h()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _=Object(O.b)((e,t)=>{var a,r=y.a.isCheckoutFlowExist(e),{templateId:o}=t.match.params,n=r?y.a.getCheckoutLocationId(e):y.a.getCalendarLocationId(e)||(null===(a=y.a.getExistingLocationList(e)[0])||void 0===a?void 0:a.id);return{matchId:t.match.params.id,valid:Object(C.cb)(M.a)(e),errors:Object(C.V)(M.a)(e),meta:Object(C.U)(M.a)(e),appointmentId:r&&y.a.getCheckoutAppointmentId(e),locationId:n,locationAvatar:y.a.getLocationAvatar(e,n)||"",editMode:t.match.path===I.c,templateId:o,voucherTemplate:y.a.getVoucherTemplate(e,o),provider:y.a.getProvider(e),voucherValues:Object(C.R)(M.a)(e,"description","expirationPeriod","color","title","value","bookNowButtonEnabled","notesEnabled","notes")}},{submitForm:M.f,touchFields:M.g})(r=Object(T.g)()((n=o=class extends p.PureComponent{constructor(...t){super(...t),h()(this,"state",{submitting:!1,customVoucherMode:!1,formValuesForEdit:{},verifiedSteps:Object.fromEntries(w.g.map(({route:e})=>[e,!1]))}),h()(this,"splitLeftColumnRef",m.a.createRef()),h()(this,"mobileContainerRef",m.a.createRef()),h()(this,"navigateToNextStep",e=>{var{errors:t,matchId:a,editMode:r,templateId:o}=this.props,{verifiedSteps:n,customVoucherMode:c}=this.state,i=w.g[e].fields,s=w.g[e+1].route;this.props.touchFields(Object.keys(i)),Object(M.h)(t,i)||this.setState({verifiedSteps:U(U({},n),{},{[a]:!0})}),Object(S.c)(r?I.s(o,s):"".concat(I.r(s)).concat(c?"?custom":"")),this.scrollFormToTop()}),h()(this,"navigateToPreviousStep",()=>{var{matchId:e,editMode:t,templateId:a}=this.props,{customVoucherMode:r}=this.state,o=w.g.findIndex(({route:t})=>t===e);Object(S.c)(t?I.s(a,w.g[o-1].route):"".concat(I.r(w.g[o-1].route)).concat(r?"?custom":"")),this.scrollFormToTop()}),h()(this,"scrollFormToTop",()=>{this.splitLeftColumnRef.current&&(this.splitLeftColumnRef.current.scrollTop=0),this.mobileContainerRef.current&&(this.mobileContainerRef.current.scrollTop=0)}),h()(this,"setMobileContainerRef",e=>{this.mobileContainerRef=e}),h()(this,"handleSubmit",t=>{var{editMode:a,appointmentId:r,matchId:o,locationId:n,templateId:c}=this.props,{customVoucherMode:i}=this.state,{saveVoucher:l}=t,d=u()(t,["saveVoucher"]);if(i)this.setState({submitting:!0},()=>(l?Object(x.a)(d):Object(s.resolve)()).then(t=>{Object(N.a)({voucher:l?t:Object(x.e)(d)},{appointmentId:r,locationId:n}).then(()=>{this.setState({submitting:!1}),e.requestAnimationFrame(()=>{Object(S.f)(A.d)}),Object(S.c)("/")})}));else if(a)if(this.props.voucherTemplate&&this.props.voucherTemplate.soldVouchersCount>0){this.setState({formValuesForEdit:t});var h=w.g.findIndex(({route:e})=>e===o);Object(S.c)("".concat(I.s(c,w.g[h].route),"?confirm"))}else this.setState({submitting:!0},()=>{this.onSubmitEditVoucher(t)});else this.setState({submitting:!0},()=>{Object(x.a)(t).finally(()=>{this.setState({submitting:!1}),Object(S.c)(I.k)})})}),h()(this,"handleClose",()=>{var{customVoucherMode:e}=this.state;e?Object(S.b)(A.d):Object(S.c)(I.k)}),h()(this,"makeApiCalls",()=>E.a.readFreshaLocationProfilesList().then(()=>E.a.readLocationAvatarsList({locationIds:this.props.locationId}))),h()(this,"onEditWarningModalClose",()=>{var{matchId:e,templateId:t}=this.props,a=w.g.findIndex(({route:t})=>t===e);Object(S.b)(I.s(t,w.g[a].route))}),h()(this,"onSubmitEditVoucher",e=>{var{templateId:t}=this.props;return Object(x.g)(t,e).finally(()=>{this.setState({submitting:!1}),Object(S.c)(I.k)})})}componentDidMount(){var{matchId:e,location:{search:t},editMode:a,templateId:r}=this.props,{verifiedSteps:o}=this.state,n=w.g.findIndex(({route:t})=>t===e),c=w.g[n].fields;0===n||o[w.g[n-1].route]||Object(S.c)(w.g[w.f].route),"?custom"===t&&this.setState({customVoucherMode:!0}),a&&r&&E.a.readVoucherTemplate(r).then(()=>{this.props.touchFields(Object.keys(c))}).catch(()=>{E.a.addGlobalErrorToast(),Object(S.f)(I.k)})}componentDidUpdate(e){if(e.matchId!==this.props.matchId){var t=w.g.findIndex(({route:t})=>t===e.matchId),a=w.g.findIndex(({route:e})=>e===this.props.matchId);if(t<a&&a>0){var r=w.g[a-1].fields;!Object(M.h)(this.props.errors,r)||this.navigateToPreviousStep()}}}render(){var{isMatch:e,matchId:t,valid:a,errors:r,voucherValues:{title:o},location:{search:n},editMode:c,templateId:s,voucherTemplate:l,provider:u,locationAvatar:d}=this.props,{submitting:h,customVoucherMode:p,formValuesForEdit:b}=this.state,v=w.g.findIndex(({route:e})=>e===t),O=w.g.length,y=w.g[v].fields,E=!!l&&Object(M.e)(w.g.map(({fields:e})=>Object.keys(e)).flat(),l),C=!Object(M.h)(r,y),T=c?w.h.EDIT:w.h.NEW;p&&(T=w.h.CUSTOM_VOUCHER);var A=v<O-1?m.a.createElement(f.Button,{qaType:"next-button",variant:"primary",onAction:()=>{this.navigateToNextStep(v)},disabled:!C},Object(k.d)("vouchers","Next step")):m.a.createElement(m.a.Fragment,null,e&&m.a.createElement(f.Button,{qaType:"preview-button",variant:"secondary",onAction:()=>{Object(S.c)(c?I.o(s,t):"".concat(I.p(t)).concat(p?"?custom":""))}},Object(k.d)("vouchers","Preview")),m.a.createElement(f.Button,{qaType:"save-button",variant:"primary",onAction:this.props.submitForm,isPending:h,disabled:!a},Object(k.d)("vouchers","Save"))),N=m.a.createElement(f.ModalFullScreenDesktopHeader,{sticky:!0,onClose:this.handleClose,buttons:A,onBack:0!==v&&this.navigateToPreviousStep,onBackText:Object(k.d)("vouchers","Previous"),title:Object(w.l)(T),aboveText:Object(k.d)("vouchers","Step ".concat(v+1," of ").concat(O,": ").concat(Object(w.k)(w.g[v].route,T)))}),x=m.a.createElement(f.ModalFullScreenMobileHeader,{onClose:this.handleClose,onBack:0!==v&&this.navigateToPreviousStep,aboveText:Object(k.d)("vouchers","Step ".concat(v+1," of ").concat(O)),title:"".concat(Object(w.k)(w.g[v].route,T))}),q=m.a.createElement(P.b,{qaType:"voucher-preview",className:D.a.wizardPreview},m.a.createElement(f.EmailPreview,{title:Object(k.d)("vouchers","Voucher preview"),subtitlePrefix:Object(k.d)("vouchers","Voucher email subject:"),subTitle:Object(k.d)("vouchers","%{voucher_title} from %{provider_name}",{voucher_title:o||Object(k.d)("vouchers","Voucher"),provider_name:u.name}),provider:!0,qaType:"email-preview",className:D.a.voucherPreview},m.a.createElement(L.a,{wizardPreview:!0,voucherValues:this.props.voucherValues,imageUrl:d?d.thumbUrl:""}))),B=m.a.createElement(g.d,null,w.g.map(({component:e,route:t})=>m.a.createElement(g.b,{render:t=>m.a.createElement(e,U(U({},t),{},{customVoucherMode:p})),key:t,path:c?I.s(s,t):I.r(t)})));return m.a.createElement(m.a.Fragment,null,m.a.createElement(f.ModalFullScreen,{fixedContentHeight:!e,className:D.a.self,color:e?"lightGray150":"white"},e?x:N,m.a.createElement(j.a,{makeApiCalls:this.makeApiCalls},m.a.createElement(M.c,{onSubmit:this.handleSubmit,className:D.a.voucherWizardForm,voucherEditValues:c?E:null},e?m.a.createElement(F.a,{setMobileContainerRef:this.setMobileContainerRef},B):m.a.createElement(f.SplitViewUnequal,null,m.a.createElement(f.SplitViewContentLeft,{ref:this.splitLeftColumnRef},B),m.a.createElement(f.SplitViewContentRight,null,q)))),e&&m.a.createElement(f.ModalFullScreenMobileFooter,{buttons:A})),e&&m.a.createElement(g.d,null,m.a.createElement(g.b,{path:c?I.o(s,t):I.p(t),render:e=>m.a.createElement(V.a,i()({},e,{previousUrl:c?I.s(s,t):I.r(t),voucherValues:this.props.voucherValues,imageUrl:d?d.thumbUrl:""}))})),"?confirm"===n&&m.a.createElement(R.a,{onModalClose:this.onEditWarningModalClose,onSubmitEditVoucher:()=>this.onSubmitEditVoucher(b)}))}},h()(o,"propTypes",{isMatch:v.a.bool.isRequired,matchId:v.a.string,submitForm:v.a.func,touchFields:v.a.func,valid:v.a.bool,errors:v.a.object,meta:v.a.object,editMode:v.a.bool,templateId:v.a.string,voucherValues:v.a.shape({description:v.a.string,color:v.a.string,title:v.a.string,value:v.a.number,bookNowButtonEnabled:v.a.bool,notesEnabled:v.a.bool,notes:v.a.string}),locationAvatar:v.a.shape({thumbUrl:v.a.string}),location:v.a.object,provider:v.a.object,appointmentId:v.a.string,locationId:v.a.string,expirationPeriod:v.a.string,voucherTemplate:v.a.object}),r=n))||r)||r}).call(this,a("yLpj"))},M5vY:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return E}));var r=a("pVnL"),o=a.n(r),n=a("QILm"),c=a.n(n),i=a("VkAN"),s=a.n(i),l=a("lSNA"),u=a.n(l),d=a("q1tI"),h=a.n(d),p=a("17x9"),m=a.n(p),b=a("+QRC"),v=a.n(b),f=a("PhEd"),O=a("5ZU+"),g=a("ePPS");function y(){var e=s()(["Copy link"]);return y=function(){return e},e}function j(){var e=s()(["Press #{key} to copy link"]);return j=function(){return e},e}class E extends d.PureComponent{constructor(...t){super(...t),u()(this,"state",{copied:!1}),u()(this,"copyLink",e=>{e.clipboardData.setData("text/plain",this.props.url),e.preventDefault()}),u()(this,"copy",()=>{this.clearTimeout(),e.addEventListener("copy",this.copyLink),O.a.addToast(Object(g.d)("vouchers","Link copied")),this.setState({copied:v()(this.props.url,{message:Object(g.c)(j())})},()=>{this.timeout=setTimeout(()=>this.setState({copied:!1}),1e3)}),e.removeEventListener("copy",this.copyLink)})}componentWillUnmount(){this.clearTimeout()}clearTimeout(){this.timeout&&clearTimeout(this.timeout)}render(){var e=this.props,{url:t}=e,a=c()(e,["url"]),{copied:r}=this.state;return h.a.createElement(f.Button,o()({variant:"secondary",onClick:this.copy,"data-qa":"button-copy-link",icon:"shedul/share-link",isComplete:r},a),Object(g.c)(y()))}}u()(E,"propTypes",{className:m.a.string,url:m.a.string})}).call(this,a("yLpj"))},P4U6:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var r=a("lSNA"),o=a.n(r),n=a("q1tI"),c=a.n(n),i=a("17x9"),s=a.n(i),l=a("PhEd"),u=a("XOD0"),d=a("ePPS"),h=a("Tven");class p extends n.PureComponent{render(){var{voucherValues:e,previousUrl:t,imageUrl:a}=this.props;return c.a.createElement(l.ModalFullScreen,{qaType:"preview-modal"},c.a.createElement(l.ModalFullScreenMobileHeader,{qaSuffix:"preview",sticky:!0,title:Object(d.d)("vouchers","Voucher preview"),onClose:()=>{Object(u.b)(t)}}),c.a.createElement(h.a,{wizardPreview:!0,imageUrl:a,voucherValues:e}))}}o()(p,"propTypes",{voucherValues:s.a.shape({description:s.a.string,color:s.a.string,title:s.a.string,value:s.a.number,bookNowButtonEnabled:s.a.bool,notesEnabled:s.a.bool,notes:s.a.string,expirationPeriod:s.a.string,qaSuffix:s.a.string}),previousUrl:s.a.string,imageUrl:s.a.string})},Tven:function(e,t,a){"use strict";a.d(t,"a",(function(){return N}));var r,o,n,c=a("lSNA"),i=a.n(c),s=a("q1tI"),l=a.n(s),u=a("/MKj"),d=a("17x9"),h=a.n(d),p=a("PhEd"),m=a("TSYQ"),b=a.n(m),v=a("jwng"),f=a("ePPS"),O=a("nbpM"),g=a("Jje6"),y=a("dhJQ"),j=a("1Ggn"),E=a("ZXAD"),C=a("bv1S"),T=a("ZdaZ"),S=a.n(T),P=Object(f.d)("vouchers","Your location address will appear here"),k=Object(f.d)("vouchers","Redeem on all services"),A=Object(f.d)("vouchers","For multiple-use"),N=Object(u.b)(e=>({currencyCode:O.a.getCurrencyCode(e),provider:O.a.getProvider(e)}))(r=Object(y.i)("isMobile")(r=Object(y.g)("isTablet")((n=o=class extends s.PureComponent{render(){var{currencyCode:e,isMobile:t,isTablet:a,normalizedColorValue:r,provider:o,voucherValues:{description:n,color:c,value:i,bookNowButtonEnabled:s,notesEnabled:u,notes:d,expirationDate:h,expirationPeriod:m},locationName:O,wizardPreview:y,locationDescription:T,recipientName:N,overWriteBackground:I,personalisedMessage:M,voucherCode:w,printPreview:x,imageUrl:L}=this.props,V=r?c:Object(C.d)(c),F="";return F=y?Object(E.j)(m):h?Object(f.d)("vouchers","Valid until %{expirationDate}",{expirationDate:Object(v.k)(h).format("D MMM YYYY")}):Object(f.d)("vouchers","No expiry date"),l.a.createElement(g.b,{qaType:"voucher-template-preview",className:b()(S.a.self,t&&S.a.mobile,a&&S.a.tablet)},(M||n)&&l.a.createElement(p.Text,{type:"fresha-paragraph",className:S.a.voucherDescription,qaType:"voucher-description",align:"center"},M||n),N&&l.a.createElement(l.a.Fragment,null,l.a.createElement(p.Text,{qaType:"voucher-for-label",type:"fresha-caption",className:S.a.voucherForLabel,align:"center"},Object(f.d)("vouchers","Voucher for")),l.a.createElement(p.Text,{qaType:"voucher-recipient",className:S.a.voucherRecipient,align:"center"},N)),l.a.createElement(p.VoucherVertical,{qaType:"voucher-preview-color-".concat(V),className:S.a.voucherVertical,imageUrl:L,locationName:O||o.name,locationDescription:T||P,voucherValueText:Object(f.d)("vouchers","Voucher value"),voucherValueBig:i?Object(j.e)(i,{currencyCode:e}):Object(j.e)(0,{currencyCode:e}),voucherCode:w||"XXXXXX",voucherPrefix:Object(f.d)("vouchers","Voucher code"),redeemText:k,color:V,usageLimitText:A,bookNowButtonText:!x&&s?Object(f.d)("vouchers","Book now"):void 0,onlyBorder:x,overWriteBackground:I||(a?"light-gray-150":void 0),validityPeriod:F}),u&&d&&l.a.createElement(l.a.Fragment,null,l.a.createElement(p.Text,{qaType:"voucher-notes-header",type:"fresha-caption",className:S.a.voucherNotesLabel,align:"center"},Object(f.d)("vouchers","Notes from %{provider_name}",{provider_name:o.name})),l.a.createElement(p.Text,{qaType:"voucher-for-label",type:"fresha-paragraph",align:"center"},d)),!1)}},i()(o,"propTypes",{currencyCode:h.a.string,voucherValues:h.a.shape({description:h.a.string,color:h.a.string,title:h.a.string,value:h.a.number,bookNowButtonEnabled:h.a.bool,notesEnabled:h.a.bool,notes:h.a.string,expirationDate:h.a.string,expirationPeriod:h.a.string}),isMobile:h.a.bool,provider:h.a.object,isTablet:h.a.bool,normalizedColorValue:h.a.bool,locationName:h.a.string,locationDescription:h.a.string,recipientName:h.a.string,overWriteBackground:h.a.string,personalisedMessage:h.a.string,voucherCode:h.a.string,imageUrl:h.a.string,printPreview:h.a.bool,wizardPreview:h.a.bool}),r=n))||r)||r)||r},WY53:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return x}));var r,o,n,c=a("9oTK"),i=a("lSNA"),s=a.n(i),l=a("q1tI"),u=a.n(l),d=a("/MKj"),h=a("17x9"),p=a.n(h),m=a("PhEd"),b=a("cB10"),v=a("XOD0"),f=a("Jje6"),O=a("1Ggn"),g=a("5ZU+"),y=a("nbpM"),j=a("ePPS"),E=a("/Q2I"),C=a("TSDZ"),T=a("dhJQ"),S=a("unan"),P=a("/pl8"),k=a("ZXAD"),A=a("6//9"),N=a("FVmt"),I=a.n(N),M=e=>{Object(v.c)(A.m(e))},w=e=>{Object(v.c)(A.n(e))},x=Object(T.g)()(r=Object(d.b)((e,t)=>{var a=t.match.params.id;return{matchId:a,voucherTemplate:y.a.getVoucherTemplate(e,a),currencyCode:y.a.getCurrencyCode(e),locationId:y.a.getCalendarLocationId(e)||y.a.getExistingLocationList(e)[0].id}},{fetchLocations:S.e})((n=o=class extends l.PureComponent{constructor(...t){super(...t),s()(this,"onModalClose",()=>{Object(v.b)(A.k)}),s()(this,"onSellVoucher",()=>{var{matchId:t,locationId:a}=this.props;Object(v.c)(A.k),e.requestAnimationFrame(()=>{Object(v.c)(A.l(t,a))})}),s()(this,"editVoucherTemplate",e=>{Object(v.c)(A.s(e))}),s()(this,"renderDesktopActions",()=>{var{voucherTemplate:{id:e,isUsed:t},canEditVoucher:a}=this.props;return[{name:"duplicate",label:Object(j.d)("vouchers","Duplicate voucher"),color:"gray100",action:Object(P.c)(a,w)},...t?[]:[{name:"edit",label:Object(j.d)("vouchers","Edit voucher"),color:"gray100",action:Object(P.c)(a,this.editVoucherTemplate)}],{name:"remove",label:Object(j.d)("vouchers","Delete voucher"),color:"red200",action:Object(P.c)(a,M)}].map(({name:t,label:a,action:r,color:o})=>u.a.createElement(m.Button,{qaType:"button-voucher-".concat(t),variant:"secondary",compact:!0,square:!0,rounded:!0,icon:"shedul/vouchers-".concat(t),onAction:r&&(()=>{r(e)})||void 0},u.a.createElement(m.Text,{type:"fresha-h5",className:I.a.buttonLabel,color:o},a)))}),s()(this,"makeApiCalls",()=>Object(c.all)([g.a.readVoucherTemplate(this.props.matchId).catch(()=>{g.a.addGlobalErrorToast(),Object(v.f)(A.k)}),this.props.fetchLocations()]))}render(){var{currencyCode:e,isMatch:t,canEditVoucher:a,canCheckoutSales:r}=this.props,{color:o,value:n,retailPrice:c,soldVouchersCount:i,maxNumberOfSales:s,name:l,notes:d,id:h,isUsed:p,expirationPeriod:v}=this.props.voucherTemplate||{};return Number.isNaN(parseInt(this.props.matchId,10))?null:t?u.a.createElement(C.d,{mobileMode:!0,disableCloseOnAction:!0,onClose:this.onModalClose},!p&&u.a.createElement(C.c,{"data-qa":"voucher-sell",onAction:Object(P.c)(r,()=>this.onSellVoucher())},Object(j.d)("vouchers","Sell voucher")),u.a.createElement(C.c,{onAction:Object(P.c)(a,()=>w(h)),"data-qa":"voucher-duplicate"},Object(j.d)("vouchers","Duplicate voucher")),!p&&u.a.createElement(C.c,{onAction:Object(P.c)(a,()=>this.editVoucherTemplate(h)),"data-qa":"voucher-edit"},Object(j.d)("vouchers","Edit voucher")),u.a.createElement(C.b,{onAction:Object(P.c)(a,()=>M(h)),"data-qa":"voucher-delete"},Object(j.d)("vouchers","Delete voucher"))):u.a.createElement(E.i,{qaType:"voucher-template-modal",noPadding:!0,sidebarContent:this.props.voucherTemplate&&u.a.createElement(m.VoucherTypeFull,{qaType:"voucher-preview",voucherName:l,voucherValueText:Object(j.d)("vouchers","Voucher value"),voucherValuePrice:Object(O.e)(n,{currencyCode:e}),voucherRetailPrice:Object(O.e)(c,{currencyCode:e}),voucherRetailPriceText:Object(j.d)("vouchers","Voucher price"),discountBadge:Object(k.i)(this.props.voucherTemplate)>0?Object(j.d)("vouchers","Save %{discountPercent}%",{discountPercent:Object(k.i)(this.props.voucherTemplate)}):void 0,redeemText:k.b,color:o,validityPeriod:Object(k.j)(v),overWriteBackground:"light-gray-150",usageLimitText:k.c,isUsed:p,className:I.a.voucherFull}),sidebarClassName:I.a.sidebar,containerClassName:I.a.self,contentClassName:I.a.wrapper,alignContainer:"center"},u.a.createElement(b.a,{makeApiCalls:this.makeApiCalls,showFailedPlaceholder:!0},u.a.createElement(E.g,{containerClassName:I.a.modalHeader,secondaryActionClass:I.a.closeButton,onClose:this.onModalClose}),u.a.createElement(E.c,{className:I.a.content,wrapperClassName:I.a.contentWrapper,noPadding:!0},u.a.createElement(m.Text,{type:"fresha-temporary-28",qaType:"voucher-modal-title",className:I.a.voucherName},Object(O.e)(n,{currencyCode:e})," ",l),u.a.createElement(m.Text,{qaType:"availabilty-and-sales-text",type:"fresha-caption",color:"gray50",className:I.a.voucherAvailability},k.a," •"," ",null===s?Object(j.d)("vouchers","Sold %{numberOfSales}",{numberOfSales:i||0}):Object(j.d)("vouchers","Sold %{numberOfSales}/%{maxNumberOfSales}",{numberOfSales:i||0,maxNumberOfSales:s})),u.a.createElement(m.Button,{variant:"primary",qaType:"button-voucher-sell",onAction:Object(P.c)(r,()=>this.onSellVoucher()),disabled:p},Object(j.d)("vouchers","Sell voucher")),u.a.createElement(f.b,{className:I.a.buttonRow},this.props.voucherTemplate&&this.renderDesktopActions()),d&&u.a.createElement(u.a.Fragment,null,u.a.createElement(m.Separator,{className:I.a.noteSeparator}),u.a.createElement(m.Text,{type:"fresha-h5",className:I.a.noteTitle,qaType:"notes-text"},Object(j.d)("vouchers","Note")),u.a.createElement(m.Text,{type:"fresha-paragraph",qaType:"voucher-notes"},d)))))}},s()(o,"propTypes",{voucherTemplate:p.a.object,currencyCode:p.a.string,isMatch:p.a.bool,locationId:p.a.string,matchId:p.a.string,fetchLocations:p.a.func,canEditVoucher:p.a.bool,canCheckoutSales:p.a.bool}),r=n))||r)||r}).call(this,a("yLpj"))},Yui9:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return ke}));var r,o,n,c,i,s,l,u,d,h,p,m,b=a("pVnL"),v=a.n(b),f=a("lSNA"),O=a.n(f),g=a("q1tI"),y=a.n(g),j=a("Ty5D"),E=a("17x9"),C=a.n(E),T=a("/pl8"),S=a("X67z"),P=a("ZXAD"),k=a("6//9"),A=a("Kdjz"),N=a("9oTK"),I=a("/MKj"),M=a("PhEd"),w=a("TSYQ"),x=a.n(w),L=a("XOD0"),V=a("1Ggn"),F=a("ePPS"),R=a("8TPp"),q=a("L8xJ"),D=a("cB10"),B=a("aAma"),U=a("Jje6"),_=a("dhJQ"),G=a("5ZU+"),Z=a("nbpM"),Y=a("i6OX"),z=a("qGVk"),H=a("TSDZ"),W=a("89Lc"),Q=a("lYDa"),K=a.n(Q),X=Object(_.i)("isMobile")(r=Object(_.g)("isTablet")((n=o=class extends g.PureComponent{render(){var{isMobile:e,isTablet:t}=this.props;return y.a.createElement(U.b,{className:x()(K.a.self,t&&K.a.tablet,e&&K.a.mobile)},this.props.children)}},O()(o,"propTypes",{isMobile:C.a.bool.isRequired,isTablet:C.a.bool.isRequired,children:C.a.node}),r=n))||r)||r,J=a("WY53"),$=a("5o92"),ee=a("FAYg"),te=a("DTRD"),ae=a("g+MP"),re=a("2ta/"),oe=a("61cg"),ne=a("kWUZ"),ce=a("M5vY"),ie=a("B1GA"),se=a.n(ie),le=a("qqFt"),ue=Object(I.b)(e=>{var t=Z.a.getFreshaSetting(e);return{provider:Z.a.getProvider(e),providerSlug:Z.a.getProviderSlug(e),providerId:Z.a.getProviderId(e),isFreshaPaySetUp:Z.a.isFreshaPaySetUp(e),isFreshaPlusEnabled:t!==ne.d.DISABLED&&!!Z.a.getPublishedLocations(e).length}})((s=i=class extends g.PureComponent{constructor(...e){super(...e),O()(this,"onModalClose",()=>{Object(L.b)(k.k)}),O()(this,"getOnlineSalesExtraNotes",()=>y.a.createElement(le.a,{paymentsComingSoonNote:y.a.createElement(M.MediaCardNote,{className:se.a.extraNotes,variant:"information",description:Object(F.d)("vouchers","Online voucher sales and payments on Fresha are coming soon to %{country_name}",{country_name:ae.a.find(({value:e})=>e===this.props.provider.countryCode).label}),iconName:"bulb",qaType:"info-fresha-pay-soon"}),freshaPayNote:y.a.createElement(M.MediaCardNote,{className:se.a.extraNotes,variant:"information",description:Object(F.d)("vouchers","Set-up online payments to share your vouchers online."),iconName:"bulb",linkChildren:y.a.createElement(M.Link,{inheritFontSize:!0,qaType:"link",variant:"inline",linkTo:oe.s},Object(F.d)("vouchers","Learn more")),qaType:"info-fresha-pay"}),freshaPlusNote:y.a.createElement(M.MediaCardNote,{className:se.a.extraNotes,variant:"information",description:Object(F.d)("vouchers","Enable Fresha Plus to share your voucher online."),iconName:"bulb",linkChildren:y.a.createElement(M.Link,{inheritFontSize:!0,qaType:"link",variant:"inline",linkTo:re.v},Object(F.d)("vouchers","Learn more")),qaType:"info-enable-fresha"})}))}render(){var{providerSlug:e,providerId:t,isFreshaPaySetUp:a,isFreshaPlusEnabled:r}=this.props,o="".concat(ee.FRESHA_SPA_URL,"/vouchers/provider/").concat(e||t),n=Object($.a)(o),c=a&&r;return y.a.createElement(te.a,{show:!0,onAction:this.onModalClose},y.a.createElement(U.b,{className:se.a.self,qaType:"share-vouchers-modal"},y.a.createElement(M.RoundedCornersModal,{onOverlayAction:this.onModalClose,title:Object(F.d)("vouchers","Share your vouchers"),onClose:this.onModalClose},y.a.createElement(U.b,null,y.a.createElement(M.Text,{type:"fresha-caption",className:se.a.textSpace},Object(F.d)("vouchers","Copy a link to share your available vouchers with your clients on your website and social media pages.")),y.a.createElement(M.Form.TextField,{noMargin:!0,label:Object(F.d)("vouchers","Vouchers link"),prefix:Object(F.e)("vouchers","Prefix for inputField with voucher direct link","URL"),disabled:!0,value:n}),y.a.createElement(ce.a,{disabled:!c,className:x()(se.a.copyButton,!c&&se.a.disabledCopyLink),url:n}),this.getOnlineSalesExtraNotes()))))}},O()(i,"propTypes",{providerId:C.a.string,providerSlug:C.a.string,isFreshaPaySetUp:C.a.bool,isFreshaPlusEnabled:C.a.bool,provider:C.a.object}),c=s))||c,de=a("mwIZ"),he=a.n(de),pe=a("/Q2I"),me=Object(_.i)()(l=Object(I.b)((e,t)=>{var a=t.match.params.id;return{voucherTemplateId:a,voucherTemplate:Z.a.getVoucherTemplate(e,a)}})((d=u=class extends g.PureComponent{constructor(...e){super(...e),O()(this,"onModalClose",()=>{Object(L.c)(k.k)}),O()(this,"handleDelete",()=>{var{voucherTemplateId:e}=this.props;return G.a.deleteVoucherTemplate(e).then(()=>{G.a.deleteVoucherTemplateFromORM(e),G.a.addDeletedToast(Object(F.d)("vouchers","Voucher template"))}).catch(()=>{G.a.addErrorToast(Object(F.d)("vouchers","Unable to remove voucher template, please try again later"))}).finally(()=>{Object(L.c)(k.k)})})}render(){var{isMatch:e,voucherTemplateId:t,voucherTemplate:a}=this.props,r=a&&a.soldVouchersCount>0,o=Object(F.d)("vouchers","Delete voucher"),n=r?Object(F.d)("vouchers","Are you sure you want to delete this voucher? Vouchers that have been sold will still be valid."):Object(F.d)("vouchers","Are you sure you want to delete this voucher? This action can’t be undone."),c=[y.a.createElement(M.Button,{variant:"secondary",qaType:"voucher-template-delete-close-button",onAction:this.onModalClose},Object(F.d)("vouchers","Cancel")),y.a.createElement(M.Button,{variant:"danger",qaType:"voucher-template-delete-confirm-button",onAction:this.handleDelete},Object(F.d)("vouchers","Yes, delete"))];return y.a.createElement(D.a,{makeApiCalls:()=>G.a.readVoucherTemplate(t).catch(e=>{"not-found"!==he()(e,"response.body.errors[0].code")&&G.a.addGlobalErrorToast(),Object(L.f)(k.k)}),showFailedPlaceholder:!0},e?y.a.createElement(M.ModalFullScreen,{color:"white",qaType:"voucher-template-delete-modal"},y.a.createElement(M.ModalFullScreenMobileHeader,{onClose:this.onModalClose,center:!0,title:o}),y.a.createElement(M.FullScreenModalContent,{mobileLayout:!0},y.a.createElement(M.Text,{type:"fresha-paragraph"},n)),y.a.createElement(M.ModalFullScreenMobileFooter,{buttons:c})):y.a.createElement(pe.d,{fullHeight:!0},y.a.createElement(M.ModalCard,{"data-qa":"voucher-template-delete-modal",title:o,rounded:!0,size:"small",withSections:!0,onClose:this.onModalClose,buttons:c},y.a.createElement(M.CardSection,null,y.a.createElement(M.Text,{type:"fresha-paragraph"},n)))))}},O()(u,"propTypes",{voucherTemplateId:C.a.number.isRequired,voucherTemplate:C.a.object,isMatch:C.a.bool}),l=d))||l)||l,be=a("ZoaQ"),ve=a("bv1S");function fe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Oe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(a),!0).forEach((function(t){O()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):fe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ge,ye,je,Ee=Object(_.i)()(h=Object(I.b)((e,t)=>{var a=t.match.params.id;return{voucherTemplateId:a,voucherTemplate:Z.a.getVoucherTemplate(e,a)}})((m=p=class extends g.PureComponent{constructor(...e){super(...e),O()(this,"state",{isSubmitting:!1}),O()(this,"onModalClose",()=>{Object(L.c)(k.k)}),O()(this,"handleDuplicateVoucher",()=>{var{voucherTemplate:e}=this.props,t=!!e&&Oe(Oe({},Object(ve.e)(P.g.map(({fields:e})=>Object.keys(e)).flat(),e)),{},{name:"".concat(e.name," 2")});this.setState({isSubmitting:!0},()=>{Object(be.b)(t).then(e=>{this.setState({isSubmitting:!1}),e?Object(L.c)(Object(k.s)(e)):Object(L.c)(k.k)})})})}render(){var{isMatch:e,voucherTemplateId:t}=this.props,{isSubmitting:a}=this.state,r=Object(F.d)("vouchers","This action will create a new voucher based on selected one."),o=Object(F.d)("vouchers","Duplicate voucher"),n=[y.a.createElement(M.Button,{variant:"secondary",qaType:"voucher-template-duplicate-close-button",onAction:this.onModalClose},Object(F.d)("vouchers","Cancel")),y.a.createElement(M.Button,{variant:"primary",pending:a,qaType:"voucher-template-duplicate-confirm-button",onAction:this.handleDuplicateVoucher},Object(F.d)("vouchers","Duplicate"))];return y.a.createElement(D.a,{makeApiCalls:()=>G.a.readVoucherTemplate(t).catch(()=>{G.a.addGlobalErrorToast(),Object(L.f)(k.k)})},e?y.a.createElement(M.ModalFullScreen,{color:"white",qaType:"voucher-template-duplicate-modal"},y.a.createElement(M.ModalFullScreenMobileHeader,{onClose:this.onModalClose,center:!0,title:o}),y.a.createElement(M.FullScreenModalContent,{mobileLayout:!0},y.a.createElement(M.Text,{type:"fresha-paragraph"},r)),y.a.createElement(M.ModalFullScreenMobileFooter,{buttons:n})):y.a.createElement(pe.d,{fullHeight:!0},y.a.createElement(M.ModalCard,{"data-qa":"voucher-template-duplicate-modal",title:o,rounded:!0,size:"small",withSections:!0,onClose:this.onModalClose,buttons:n},y.a.createElement(M.CardSection,null,y.a.createElement(M.Text,{type:"fresha-paragraph"},r)))))}},O()(p,"propTypes",{voucherTemplateId:C.a.number.isRequired,voucherTemplate:C.a.object,isMatch:C.a.bool}),h=m))||h)||h,Ce=a("oziH"),Te=a("Yoda"),Se=a.n(Te),Pe=Object(_.i)("isMobile")(ge=Object(_.g)("isTablet")(ge=Object(I.b)(e=>({voucherTemplates:Z.a.getVoucherTemplatesList(e),currencyCode:Z.a.getCurrencyCode(e)}))((je=ye=class extends g.PureComponent{constructor(...e){super(...e),O()(this,"openVoucherModal",e=>{Object(L.c)(k.q(e))}),O()(this,"openVoucherWizard",()=>{Object(L.c)(k.r())}),O()(this,"getOnlineSalesExtraNotes",()=>y.a.createElement(le.a,{freshaPlusNote:y.a.createElement(Ce.b,{title:Object(F.f)("Increase sales by selling vouchers online with Fresha <span>Plus!<span>",{},{span:e=>y.a.createElement("span",{className:Se.a.plus},e)}),description:Object(F.d)("vouchers","Let clients buy your vouchers online through the Fresha marketplace and via direct booking links by enabling Fresha Plus."),button:y.a.createElement(M.Button,{variant:"secondary",onAction:()=>Object(W.g)()},Object(F.d)("vouchers","Learn more")),className:x()(this.props.isMobile?Se.a.bannerRowMobile:Se.a.bannerRow,this.props.voucherTemplates.length>0&&Se.a.withButtons),mobile:this.props.isMobile}),freshaPayNote:y.a.createElement(Ce.b,{variant:Ce.a.Payment,title:Object(F.d)("vouchers","Set up payments to sell vouchers online and increase sales"),description:Object(F.d)("vouchers","Congrats! You have Fresha Plus enabled. Let clients buy your vouchers online through the Fresha marketplace and via direct booking links by setting up payments in your account."),button:y.a.createElement(M.Button,{variant:"secondary",onAction:()=>Object(W.g)()},Object(F.d)("vouchers","Learn more")),className:x()(this.props.isMobile?Se.a.bannerRowMobile:Se.a.bannerRow,this.props.voucherTemplates.length>0&&Se.a.withButtons),mobile:this.props.isMobile})})),O()(this,"renderDesktopBar",e=>{var{isTablet:t}=this.props;return y.a.createElement(U.b,{className:x()(Se.a.buttonRow,t&&Se.a.buttonRowTablet)},y.a.createElement(M.Button,{variant:"secondary",icon:"shedul/share-link",qaType:"vouchers-share-button",square:t,className:t?void 0:Se.a.shareButton,linkTo:k.g},!t&&Object(F.d)("vouchers","Sell vouchers online")),!1,y.a.createElement(M.Button,{variant:"primary",qaType:"vouchers-new-button",onAction:Object(T.c)(e,this.openVoucherWizard)},Object(F.d)("vouchers","Add voucher type")))}),O()(this,"renderMobileActions",e=>y.a.createElement(z.a,{actions:[{id:"voucher-template-new",onAction:Object(T.c)(e,this.openVoucherWizard),content:y.a.createElement(Y.b,{name:"plus"}),qaType:"voucher-template-new"}]})),O()(this,"renderVoucherList",e=>{var{voucherTemplates:t,currencyCode:a,isMobile:r}=this.props;return t.length>0?y.a.createElement(X,null,t.map(e=>y.a.createElement(U.b,{className:Se.a.voucherContainer},y.a.createElement(M.VoucherType,{className:Se.a.voucherType,qaType:"voucher-template-item-".concat(e.id),voucherName:e.name,voucherValueText:Object(F.d)("vouchers","Voucher value"),voucherValuePrice:Object(V.e)(e.value,{currencyCode:a}),voucherRetailPrice:Object(V.e)(e.retailPrice,{currencyCode:a}),discountBadge:Object(P.i)(e)>0?Object(F.d)("vouchers","Save %{discountPercent}%",{discountPercent:Object(P.i)(e)}):void 0,informationAboutQuantity:null===e.maxNumberOfSales?Object(F.d)("vouchers","Sold %{numberOfSales}",{numberOfSales:e.soldVouchersCount||0}):Object(F.d)("vouchers","Sold %{numberOfSales}/%{maxNumberOfSales}",{numberOfSales:e.soldVouchersCount||0,maxNumberOfSales:e.maxNumberOfSales}),redeemText:P.b,color:e.color,overWriteBackground:r?void 0:"light-gray-100",onAction:()=>this.openVoucherModal(e.id),isUsed:e.isUsed})))):y.a.createElement(M.EmptyState,{title:Object(F.d)("vouchers","Add a voucher type"),description:Object(F.d)("vouchers","You have no active voucher types."),btnText:Object(F.d)("vouchers","Add voucher type"),iconName:"shedul/vouchers-empty-list",onAction:Object(T.c)(e,this.openVoucherWizard),className:Se.a.emptyState})}),O()(this,"makeApiCalls",()=>Object(N.all)([G.a.readVoucherTemplatesList(),G.a.readFreshaLocationProfilesList()]))}render(){var{isMobile:e,voucherTemplates:t}=this.props;return y.a.createElement(U.b,{grow:1,className:Se.a.viewContainer},y.a.createElement(D.a,{makeApiCalls:this.makeApiCalls,showFailedPlaceholder:!0},y.a.createElement(T.b,{keys:[S.a.MANAGE_VOUCHERS,S.a.CAN_CHECKOUT_SALES]},({manageVouchers:a,canCheckoutSales:r})=>y.a.createElement(g.Fragment,null,y.a.createElement(R.d,{title:Object(F.d)("vouchers","Vouchers"),mobileRightContent:y.a.createElement(H.f,{icon:"options",className:Se.a.iconDropdownMenu,"data-qa":"mobile-toolbar"},y.a.createElement(H.c,{linkTo:k.g,"data-qa":"share-modal"},Object(F.d)("vouchers","Sell vouchers online")))}),y.a.createElement(q.b,{color:e?void 0:"gray-2",className:x()(Se.a.self,e&&Se.a.mobile)},e?y.a.createElement(g.Fragment,null,this.getOnlineSalesExtraNotes(),this.renderVoucherList(a),this.renderMobileActions(a)):y.a.createElement(B.b,{grow:1,shrink:0,type:"plain"},this.getOnlineSalesExtraNotes(),t.length>0&&this.renderDesktopBar(a),this.renderVoucherList(a))),y.a.createElement(j.d,null,y.a.createElement(j.b,{component:ue,path:k.g}),y.a.createElement(j.b,{component:e=>y.a.createElement(T.b,{keys:S.a.MANAGE_VOUCHERS,withPlaceholder:!0},y.a.createElement(me,e)),path:k.a}),y.a.createElement(j.b,{render:e=>y.a.createElement(T.b,{keys:S.a.MANAGE_VOUCHERS,withPlaceholder:!0},y.a.createElement(Ee,e)),path:k.b}),y.a.createElement(j.b,{render:e=>y.a.createElement(J.a,v()({},e,{canEditVoucher:a,canCheckoutSales:r})),path:k.h}))))))}},O()(ye,"propTypes",{isMobile:C.a.bool.isRequired,isTablet:C.a.bool.isRequired,voucherTemplates:C.a.arrayOf(C.a.object),currencyCode:C.a.string}),ge=je))||ge)||ge)||ge;class ke extends g.PureComponent{render(){var{location:{search:e}}=this.props;return"?custom"===e?y.a.createElement(T.b,{keys:[S.a.CAN_CHECKOUT_SALES],withPlaceholder:!0},y.a.createElement(j.d,null,y.a.createElement(j.b,{exact:!0,path:k.i},y.a.createElement(j.a,{push:!0,to:k.r(P.g[P.f].route)})),y.a.createElement(j.b,{path:[k.f,k.c],component:A.a}),y.a.createElement(j.b,{path:[k.e,k.d],component:A.a}))):y.a.createElement(T.b,v()({},P.d,{withPlaceholder:!0}),y.a.createElement(j.d,null,y.a.createElement(j.b,{exact:!0,path:k.i},y.a.createElement(j.a,{push:!0,to:k.r(P.g[P.f].route)})),y.a.createElement(j.b,{path:[k.f,k.c],render:e=>y.a.createElement(T.b,{keys:[S.a.MANAGE_VOUCHERS],withPlaceholder:!0},y.a.createElement(A.a,e))}),y.a.createElement(j.b,{path:[k.e,k.d],render:e=>y.a.createElement(T.b,{keys:[S.a.MANAGE_VOUCHERS],withPlaceholder:!0},y.a.createElement(A.a,e))}),y.a.createElement(j.b,{path:k.k,component:Pe})))}}O()(ke,"propTypes",{location:C.a.object})},ZoaQ:function(e,t,a){"use strict";a.d(t,"e",(function(){return m})),a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return v})),a.d(t,"g",(function(){return f})),a.d(t,"f",(function(){return O})),a.d(t,"c",(function(){return g})),a.d(t,"d",(function(){return y}));var r=a("lSNA"),o=a.n(r),n=a("mwIZ"),c=a.n(n),i=a("5ZU+"),s=a("HTL0"),l=a("ePPS"),u=a("MDPv"),d=a("bv1S");function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){o()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var m=e=>p(p({},e),{},{color:Object(d.d)(e.color)});function b(e){return i.a.createVoucherTemplate(s.a.voucherTemplateCreateRequest(m(e))).then(e=>{var t=c()(e,"body.data.attributes"),a=c()(e,"body.data.id");return i.a.addGlobalSuccessToast(Object(l.d)("vouchers","Voucher template has been created.")),p(p({},t),{},{id:a})}).catch(()=>{i.a.addErrorToast()})}function v(e){return i.a.createVoucherTemplate(s.a.voucherTemplateCreateRequest(m(e))).then(e=>{var t=c()(e,"body.data.id");return i.a.addGlobalSuccessToast(Object(l.d)("vouchers","Voucher template has been duplicated.")),t}).catch(()=>{i.a.addErrorToast()})}function f(e,t){return i.a.patchVoucherTemplate(e,s.a.voucherTemplateCreateRequest(m(t))).then(()=>{i.a.addGlobalSuccessToast(Object(l.d)("vouchers","Voucher template has been updated."))}).catch(()=>{i.a.addErrorToast()})}function O(e,t){return i.a.sendVoucherEmail(e,{data:{type:"send-email",attributes:t}}).then(()=>{i.a.addGlobalSuccessToast(Object(l.d)("vouchers","Voucher has been sent."))}).catch(()=>{i.a.addErrorToast()})}function g(e,t){return i.a.printVoucher(e,{data:{type:"print-voucher",attributes:{customName:"".concat(t.firstName).concat(t.lastName&&" ".concat(t.lastName)||""),customMessage:t.personalisedMessage}}}).then(({body:{data:{attributes:{url:e}}}})=>Object(u.a)(e)).catch(()=>{i.a.addErrorToast()})}function y(){return i.a.readVoucherTemplatesList.cache.clear(),i.a.readVoucherTemplatesList()}},gsAU:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a("9oTK"),o=e=>"".concat(e.query);function n(e,{lifeTimeInSec:t,hashParams:a=o,cancelPrevious:n=!1}){var c={},i={},s=o=>{var s=a(o);if(i[s]&&!i[s].isCancelled()){if(!n)return i[s];i[s].cancel(),i[s]=void 0}else if(c[s]){if(c[s].expirationTimestamp>=Date.now())return Object(r.resolve)(c[s].data);c[s]=void 0}var l=e(o);l.finally(()=>{l.isCancelled()||(i[s]=void 0)});var u=l.then(e=>{var a=Date.now(),{data:r}=e.body;return c[s]={expirationTimestamp:a+1e3*t,data:r},r}),d=u.cancel.bind(u);return u.cancel=()=>{d(),l.cancel()},i[s]=u,u};return s.reset=()=>{c={}},s}},hr8B:function(e,t,a){"use strict";a.d(t,"a",(function(){return H})),a.d(t,"e",(function(){return W})),a.d(t,"d",(function(){return Q})),a.d(t,"c",(function(){return K})),a.d(t,"b",(function(){return J}));var r,o,n,c,i,s,l=a("pVnL"),u=a.n(l),d=a("lSNA"),h=a.n(d),p=a("VkAN"),m=a.n(p),b=a("q1tI"),v=a.n(b),f=a("/MKj"),O=a("17x9"),g=a.n(O),y=a("Jje6"),j=a("kZhr"),E=a("uZ2f"),C=a("ePPS"),T=a("nbpM"),S=a("gY1J"),P=a("cLIp"),k=a.n(P),A=a("9oTK"),N=a("TSYQ"),I=a.n(N),M=a("mwIZ"),w=a.n(M),x=a("5ZU+"),L=a("g5rd"),V=a("cB10"),F=a("1UfZ"),R=a("GJzV"),q=a.n(R),D=Object(f.b)((e,{customer:{id:t,contactNumber:a}})=>({contactNumber:w()(T.a.getOnlineProfile(e,t),"contactNumber",a)}))((n=o=class extends b.PureComponent{constructor(...e){super(...e),h()(this,"fetchCustomerOnlineProfile",()=>{var{customer:{id:e,isFresha:t}}=this.props;return t?Object(F.h)(e).catch(()=>{x.a.addGlobalErrorToast()}):Object(A.resolve)()})}render(){var{isMatch:e,contactNumber:t,customer:{avatar:a,name:r,email:o,id:n}}=this.props;return v.a.createElement(y.b,{className:I()(q.a.self,{[q.a.isDesktop]:!e,[q.a.hasAvatar]:Boolean(a)})},v.a.createElement(V.a,{makeApiCalls:this.fetchCustomerOnlineProfile},a&&v.a.createElement(L.a,{qaType:"fresha-customer-info-avatar",className:q.a.avatar,customerId:n,size:L.e.SIZE.X_LARGE}),v.a.createElement(y.b,{className:q.a.basicInfo},v.a.createElement(y.b,{className:q.a.name,qaType:"fresha-customer-info-name",title:r},r),v.a.createElement(y.b,{className:q.a.email,qaType:"fresha-customer-info-email",title:o},o),v.a.createElement(y.b,{className:q.a.contactNumber,qaType:"fresha-customer-info-contactNumber"},t))))}},h()(o,"propTypes",{customer:g.a.object,contactNumber:g.a.string,isMatch:g.a.bool}),r=n))||r;function B(){var e=m()(["Client mobile number"]);return B=function(){return e},e}function U(){var e=m()(["Client last name"]);return U=function(){return e},e}function _(){var e=m()(["Client first name"]);return _=function(){return e},e}function G(){var e=m()(["Mobile number"]);return G=function(){return e},e}function Z(){var e=m()(["Last name"]);return Z=function(){return e},e}function Y(){var e=m()(["First name"]);return Y=function(){return e},e}var z="payByAppAddCustomer",H={FIRST_NAME:"firstName",LAST_NAME:"lastName",CONTACT_NUMBER:"contactNumber",NOTIFICATION_SETTING:"notificationSetting",ACCEPTS_MARKETING_NOTIFICATIONS:"acceptsMarketingNotifications",MARKETPLACE_APPOINTMENT_CONFIRMATION_ENABLED:"marketplaceAppointmentConfirmationEnabled"},W=()=>Object(j.hb)(z),Q=Object(j.bb)(z),K=Object(j.cb)(z),X={[H.FIRST_NAME]:[j.kb.required(Object(C.c)(Y())),j.kb.maxLength(30)],[H.LAST_NAME]:[j.kb.required(Object(C.c)(Z())),j.kb.maxLength(30)],[H.CONTACT_NUMBER]:[j.kb.requiredPhoneNumber(Object(C.c)(G()))]},J=Object(f.b)((e,{customer:t})=>({initialValues:{[H.FIRST_NAME]:t.firstName,[H.LAST_NAME]:t.lastName,[H.CONTACT_NUMBER]:t.contactNumber||T.a.getProviderPhonePrefix(e),[H.NOTIFICATION_SETTING]:T.a.getCustomerDefaultNotifactionSetting(e),[H.ACCEPTS_MARKETING_NOTIFICATIONS]:!0,[H.MARKETPLACE_APPOINTMENT_CONFIRMATION_ENABLED]:!0},isFreshaCustomer:t.isFresha}))(c=Object(j.q)({form:z})((s=i=class extends b.PureComponent{constructor(...e){super(...e),h()(this,"hasInitialCustomer",this.props.customer.id!==S.d)}render(){var{isFreshaCustomer:e,customer:t,isMatch:a}=this.props,r={alwaysShowError:this.hasInitialCustomer};return e?v.a.createElement(D,{isMatch:a,customer:t}):v.a.createElement(y.b,{className:k.a.self},v.a.createElement(E.s,u()({className:k.a.firstName,label:Object(C.c)(_()),name:H.FIRST_NAME,validate:X[H.FIRST_NAME]},r,{autoFocus:!0,noMargin:!a})),v.a.createElement(E.s,u()({className:k.a.lastName,label:Object(C.c)(U()),name:H.LAST_NAME,validate:X[H.LAST_NAME]},r,{noMargin:!a})),v.a.createElement(E.o,u()({className:k.a.contactNumber,label:Object(C.c)(B()),name:H.CONTACT_NUMBER,validate:X[H.CONTACT_NUMBER]},r,{grow:1,noMargin:!a})))}},h()(i,"propTypes",{isFreshaCustomer:g.a.bool,customer:g.a.object,isMatch:g.a.bool}),c=s))||c)||c},qGVk:function(e,t,a){"use strict";a.d(t,"b",(function(){return F})),a.d(t,"a",(function(){return ee}));var r=a("pVnL"),o=a.n(r),n=a("QILm"),c=a.n(n),i=a("lSNA"),s=a.n(i),l=a("lSCD"),u=a.n(l),d=a("pZt1"),h=a.n(d),p=a("q1tI"),m=a.n(p),b=a("17x9"),v=a.n(b),f=a("TSYQ"),O=a.n(f),g=a("pQ8y"),y=a("VeD8"),j=a("JqEL");class E extends p.PureComponent{constructor(e){super(e),this.state={isRendered:!1}}componentDidMount(){this.timeout=setTimeout(()=>this.setState({isRendered:!0}),this.props.delay)}componentWillUnmount(){Object(j.d)(this.timeout)}render(){return this.state.isRendered?p.Children.only(this.props.children):null}}s()(E,"propTypes",{delay:v.a.number,children:v.a.node}),s()(E,"defaultProps",{delay:500});a("uHid");var C=a("DTRD"),T=a("jXSx"),S=a("i6OX"),P=a("Jje6"),k=a("9wjN"),A=a("ww3E"),N=a("R3Cl"),I=a.n(N);class M extends p.Component{constructor(e){super(e),this.state={showTooltip:!1},this.handleActionRef=this.handleActionRef.bind(this)}UNSAFE_componentWillMount(){this.props.tooltip&&(this.timeout=setTimeout(()=>{this.setState({showTooltip:!0})},300))}componentWillUnmount(){clearTimeout(this.timeout)}handleActionRef(e){if(Object(j.h)(e)){"object"==typeof this.actionRefListener&&this.actionRefListener.remove();var{action:t}=this.props;this.actionRefListener=Object(j.a)(e,"touchstart",e=>{e.preventDefault(),"function"==typeof t&&t(e)},{passive:!1})}}render(){var e=this.props,{content:t,disabled:a,tooltip:r,expanded:n,action:i,qaType:s,buttonClassName:l,noFillIcon:u}=e,d=c()(e,["content","disabled","tooltip","expanded","action","qaType","buttonClassName","noFillIcon"]),{showTooltip:h}=this.state;return m.a.createElement(P.b,{className:O()(I.a.self,{[I.a.expanded]:n,[I.a.whiteIcon]:!u}),onClick:i,selfRef:this.handleActionRef,qaType:s},m.a.createElement(A.a,o()({disabled:a,type:"info float",className:O()(I.a.action,l),noFillIcon:u},d),t),m.a.createElement(y.a,null,n&&h?m.a.createElement(g.a,{classNames:{enter:I.a.tooltipAppear,enterActive:I.a.tooltipAppearActive,exit:I.a.tooltipLeave,exitActive:I.a.tooltipLeaveActive},timeout:200},m.a.createElement("div",{className:I.a.tooltip},r)):null))}}s()(M,"propTypes",{content:v.a.node.isRequired,disabled:v.a.bool,expanded:v.a.bool,tooltip:v.a.string,action:v.a.func,qaType:P.b.propTypes.qaType,buttonClassName:v.a.string,noFillIcon:v.a.bool});var w=a("tdHr"),x=a.n(w);function L(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function V(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?L(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):L(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}class F extends m.a.PureComponent{constructor(...e){super(...e),s()(this,"state",{isOpen:!1,showOverlay:!1}),s()(this,"onRootActionTouchStart",()=>{this.setState({showOverlay:!0})}),s()(this,"onRootActionMouseEnter",()=>{this.props.disabled||(this.setState({showOverlay:!1}),this.showActions())}),s()(this,"hideActions",()=>{this.setState({isOpen:!1})}),s()(this,"showActions",()=>{this.setState({isOpen:!0})}),s()(this,"renderActions",()=>this.props.actions.map((e,t)=>{var a=t,{onAction:r}=e,n=c()(e,["onAction"]);return m.a.createElement(g.a,{key:a,classNames:{enter:x.a.actionEnter,enterActive:x.a.actionEnterActive,exit:x.a.actionLeave,exitActive:x.a.actionLeaveActive},timeout:{enter:250,exit:200}},m.a.createElement(M,o()({},n,{action:()=>{this.hideActions(),"function"==typeof r&&r()},expanded:!0})))}))}UNSAFE_componentWillReceiveProps(e){!this.props.disabled&&e.disabled&&this.setState({isOpen:!1,showOverlay:!1})}get isOpen(){return this.state.isOpen&&this.state.showOverlay}render(){var{rootAction:e,disabled:t,noFillRootIcon:a,floatClassName:r,transitionSelfAppear:n,transitionSelfAppearActive:i,inModal:s}=this.props,{isOpen:l}=this.state,{onAction:d}=e,p=c()(e,["onAction"]);return m.a.createElement(T.b,{stopActionEvents:!1},m.a.createElement(C.a,{show:this.isOpen,onAction:this.hideActions},m.a.createElement(E,{delay:800},m.a.createElement(y.a,{appear:!0,enter:!1,exit:!1},m.a.createElement(g.a,{classNames:{appear:n,appearActive:i},timeout:500},m.a.createElement(P.b,{className:O()(x.a.self,r,{[x.a.mobile]:Object(k.f)(),[x.a.inModal]:s}),qaType:"floating-menu-button"},m.a.createElement(y.a,{appear:!0,enter:!1},l||t?null:m.a.createElement(g.a,{classNames:{appear:x.a.rootActionEnter,appearActive:x.a.rootActionEnterActive,exit:x.a.rootActionLeave,exitActive:x.a.rootActionLeaveActive},timeout:200},m.a.createElement(M,o()({action:()=>{if(this.props.actions.length>1)this.showActions();else{var e=h()(this.props.actions);e&&u()(e.onAction)&&e.onAction()}"function"==typeof d&&d()},onMouseEnter:this.onRootActionMouseEnter,onTouchStart:this.onRootActionTouchStart,noFillIcon:a,"data-qa":"floating-root-menu-button"},p)))))))),m.a.createElement("div",{className:O()(x.a.self,x.a.open,{[x.a.mobile]:Object(k.f)(),[x.a.inModal]:s}),onMouseLeave:this.hideActions},m.a.createElement(y.a,null,l&&this.renderActions()))))}}s()(F,"defaultProps",{rootAction:{content:m.a.createElement(S.b,{name:"plus"})},transitionSelfAppear:x.a.selfAppear,transitionSelfAppearActive:x.a.selfAppearActive}),s()(F,"propTypes",{actions:v.a.arrayOf(v.a.shape(V(V({},M.propTypes),{},{content:v.a.node,onAction:v.a.func}))).isRequired,rootAction:v.a.shape(M.propTypes),disabled:v.a.bool,noFillRootIcon:v.a.bool,floatClassName:v.a.string,transitionSelfAppear:v.a.string,transitionSelfAppearActive:v.a.string,inModal:v.a.bool});var R,q,D,B=a("VkAN"),U=a.n(B),_=a("/MKj"),G=a("PhEd"),Z=a("ePPS"),Y=a("dhJQ"),z=a("3wSE"),H=a("TSDZ"),W=a("nbpM"),Q=a("3+wM"),K=a.n(Q);function X(){var e=U()(["Add New"]);return X=function(){return e},e}function J(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function $(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?J(Object(a),!0).forEach((function(t){s()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):J(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ee=Object(Y.g)()(R=Object(_.b)(e=>({isReshedulEnabled:W.a.isReshedulEnabled(e)}))((D=q=class extends p.PureComponent{render(){var{isMatch:e,hideOnDesktop:t,hideOnMobile:a,iconOnlyOnDesktop:r,actions:o,label:n,className:c,inModal:i,isReshedulEnabled:s,buttonSize:l}=this.props;if(e&&!a)return m.a.createElement(F,{actions:o,inModal:i});if(!e&&!t){var u=o.slice();u.reverse();var d={as:G.Button,variant:"primary",size:l,iconSize:"16",iconColor:"white",wrapChildren:!0,showRipple:!1};if(u.length>1){var h=$(r?{label:null,as:z.f,showIcon:!0,icon:"plus",size:"large",className:O()(K.a.self,K.a.iconOnly,c),iconClassName:K.a.iconOnlyIcon,align:"right",qaType:"floating-menu-button"}:{label:n,as:z.f,showIcon:!1,className:O()(K.a.self,c),align:"right",qaType:"floating-menu-button"},s?d:{});return m.a.createElement(H.g,h,u.map(({id:e,onAction:t,tooltip:a,linkTo:r,qaType:o})=>m.a.createElement(H.c,{key:e,onAction:t,linkTo:r,qaType:o},a)))}if(1===o.length){var{tooltip:p,onAction:b}=o[0],v=r?{showIcon:!0,icon:"plus",size:"large",className:O()(K.a.iconOnly,c),iconClassName:K.a.iconOnlyIcon,onAction:b,qaType:"floating-menu-button"}:{showIcon:!1,onAction:b,className:c,qaType:"floating-menu-button"};return m.a.createElement(z.f,v,r?null:p)}return null}return null}},s()(q,"propTypes",{isMatch:v.a.bool,hideOnDesktop:v.a.bool,hideOnMobile:v.a.bool,iconOnlyOnDesktop:v.a.bool,actions:v.a.arrayOf(v.a.object),label:v.a.string,className:v.a.string,inModal:v.a.bool,isReshedulEnabled:v.a.bool,buttonSize:v.a.oneOf(["small","default","large"])}),s()(q,"defaultProps",{hideOnDesktop:!1,hideOnMobile:!1,iconOnlyOnDesktop:!1,actions:[],label:Object(Z.c)(X()),buttonSize:"default"}),R=D))||R)||R},uHid:function(e,t,a){"use strict";(function(e){var t=a("lSNA"),r=a.n(t),o=a("q1tI"),n=a("17x9"),c=a.n(n);class i extends o.PureComponent{constructor(e){super(e),this.state={isRendered:!1}}componentDidMount(){this.timeout=e.requestAnimationFrame(()=>{e.requestAnimationFrame(()=>{this.setState({isRendered:!0})})})}componentWillUnmount(){e.cancelAnimationFrame(this.timeout)}render(){var e=this.state.isRendered?this.props:{};return this.props.children(e)}}r()(i,"propTypes",{children:c.a.func})}).call(this,a("yLpj"))},ww3E:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var r=a("lSNA"),o=a.n(r),n=a("QILm"),c=a.n(n),i=a("q1tI"),s=a.n(i),l=a("17x9"),u=a.n(l),d=a("TSYQ"),h=a.n(d),p=a("QXy2"),m=a("FAYg"),b=a("i6OX"),v=a("YeTj"),f=a.n(v);function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function g(e){var{active:t,as:a,disabled:r,inGroup:n,type:l,children:u,className:d,iconClass:p,iconCollapse:v,collapse:g,qaType:y,noFillIcon:j}=e,E=c()(e,["active","as","disabled","inGroup","type","children","className","iconClass","iconCollapse","collapse","qaType","noFillIcon"]),C=l;"string"==typeof l&&(C=l.split(" ")),Array.isArray(C)||(C=[]);var T=h()(f.a.btn,f.a.btnCollapse,C.map(e=>f.a["btn-".concat(e)]),{[f.a.active]:t,[f.a.disabled]:r,[f.a.inGroup]:n,[f.a[g]]:v,[f.a.whiteIcon]:!j},d),S=u;return v&&(S=[s.a.createElement("span",{key:"1",className:h()(f.a.childrenCollapse,f.a[g])},u),s.a.createElement(b.b,{key:"2",name:v,className:h()(p,f.a.iconCollapse,f.a[g])})]),!m.DISABLE_QA_TYPE&&y&&(E["data-qa"]=y),Object(i.createElement)(a,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){o()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({className:T,disabled:r},E),S)}g.defaultProps={as:"button",type:"default",collapse:"small"},g.propTypes={type:Object(p.c)(Object.keys(f.a).filter(e=>/^btn-/g.test(e)).map(e=>e.substring(4))),className:u.a.string,active:u.a.bool,as:u.a.oneOfType([u.a.string,u.a.func]),disabled:u.a.bool,inGroup:u.a.bool,children:u.a.node,iconClass:u.a.string,iconCollapse:u.a.string,collapse:u.a.oneOf(["extra-small","small","medium"]),qaType:u.a.string,noFillIcon:u.a.bool}}}]);