(window.webpackJsonp=window.webpackJsonp||[]).push([[273],{"0JpQ":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return ce}));var a,r,o,i=n("9oTK"),s=n("VkAN"),c=n.n(s),l=n("lSNA"),u=n.n(l),d=n("N1om"),m=n.n(d),p=n("Y+p1"),h=n.n(p),b=n("mwIZ"),f=n.n(b),g=n("CxY0"),O=n("q1tI"),v=n.n(O),y=n("17x9"),E=n.n(y),C=n("/MKj"),j=n("G4qV"),S=n("TSYQ"),N=n.n(S),A=n("fJus"),M=n("ePPS"),T=n("5ZU+"),P=n("nbpM"),w=n("XOD0"),x=n("Jje6"),k=n("dhJQ"),I=n("i6OX"),D=n("XOuL"),R=n("qGVk"),L=n("8TPp"),q=n("L8xJ"),F=n("T38r"),B=n("dsWg"),V=n("1UfZ"),U=n("DuVZ"),_=n("W59S"),G=n("JBi0"),Y=n("fGW6"),Q=n("ofCH"),z=n("IJve"),J=n("dEH0"),Z=n("uWUL"),W=n("zYuS"),H=n("MD3Z"),X=n.n(H);function K(){var e=c()(["Clients"]);return K=function(){return e},e}function $(){var e=c()(["No duplicates found"]);return $=function(){return e},e}function ee(){var e=c()(["New Client"]);return ee=function(){return e},e}function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae=["query","sortBy","sortOrder"],re=["avatar","name","contactNumber","email","gender"];function oe(e){return Object.entries(e).reduce((e,[t,n])=>{switch(t){case"sortBy":return e&&re.includes(n);case"sortOrder":return e&&F.b.includes(n);case"query":return!0;default:return!1}},!0)}var ie=Object(j.a)(_.b,e=>{var t=Object(A.i)(e.query,ae);return t.limit&&(t.limit=Number(t.limit)),t.offset&&(t.offset=Number(t.offset)),t});function se(e={},t=!0){var n=ne({sortBy:"name",sortOrder:"asc",query:""},e),a=Object.keys(n).reduce((e,t)=>(n[t]&&(e[t]=n[t]),e),{}),r=ne(ne({},w.a.location),{},{search:void 0}),o=Object(g.format)(ne(ne({},r),{},{query:a}));t?w.a.replace(o):w.a.push(o)}var ce=Object(k.g)()(a=Object(C.b)((e,t)=>({requestParams:ie(t),clients:P.a.getCustomerSearchResultList(e)}))((o=r=class extends O.Component{constructor(...t){super(...t),u()(this,"state",{hasMore:!0,loading:!0,loadingMore:!1,offset:0,totalRowsCount:null,importModalOpen:!1,duplicatesNotificationVisible:!1,duplicatedProfileExist:!1,autoMergeStatus:null}),u()(this,"onPollingEnded",e=>{this.setState({loading:!0}),T.a.readCustomerMergeGroupsExist().then(t=>{var n=f()(t,"body.meta.existenceCheck");this.makeApiCall(this.props).then(()=>{this.promise=null,this.setState({duplicatesNotificationVisible:n,autoMergeStatus:e,duplicatedProfileExist:n,loading:!1})})}).catch(()=>{this.setState({autoMergeStatus:e,loading:!1})})}),u()(this,"setRef",e=>{this.backgroundRef=e}),u()(this,"setContentRef",e=>{this.contentRef=e}),u()(this,"promise",null),u()(this,"fetchData",(t,n)=>{var a=n?"loadingMore":"loading",{isMatch:r}=t,{hasMore:o}=this.state;if(this.promise||n&&!o)return this.promise;this.setState({[a]:!0});var i=f()(this.contentRef,"scrollTop",0);return this.makeApiCall(t,n).then(({totalRowsCount:t,hasMore:o,nextOffset:s})=>{this.promise=null,this.setState({[a]:!1,offset:s,hasMore:o,totalRowsCount:t},()=>{if(n&&!r){var t=f()(this.backgroundRef,"scrollTop",0);e.requestAnimationFrame(()=>{e.requestAnimationFrame(()=>{this.backgroundRef.scrollTop=t,this.contentRef.scrollTop=i})})}})}).catch(()=>{this.setState({[a]:!1,hasMore:!1})}),this.promise}),u()(this,"handleNewClient",()=>{Object(w.c)(B.a)}),u()(this,"menuActions",[{id:"add-client",tooltip:Object(M.c)(ee()),onAction:this.handleNewClient,content:v.a.createElement(I.b,{name:"users"}),qaType:"add-client"}]),u()(this,"handleSortChange",e=>{var{requestParams:{query:t,sortBy:n,sortOrder:a}}=this.props;se({query:t,sortBy:e,sortOrder:n!==e?F.e:F.g[a]})}),u()(this,"handleFiltersChange",({query:e})=>{var{requestParams:{sortBy:t,sortOrder:n}}=this.props;se({sortBy:t,sortOrder:n,query:e})}),u()(this,"handleLoadMore",()=>this.fetchData(this.props,!0)),u()(this,"navigateToClientProfile",e=>Object(w.c)(B.s(e))),u()(this,"toggleImportModal",()=>{this.setState({importModalOpen:!this.state.importModalOpen})}),u()(this,"handleMergeCustomer",()=>{var{duplicatedProfileExist:e}=this.state;e?Object(V.o)(()=>{Object(w.c)(B.h)}):T.a.addGlobalInfoToast(Object(M.c)($()))}),u()(this,"hideNotificationBar",()=>{this.setState({duplicatesNotificationVisible:!1})})}componentDidMount(){var{requestParams:e}=this.props;oe(e)?Object(i.all)([this.makeApiCall(this.props),T.a.bulk([T.a.readCustomerMergeGroupsExist,T.a.readCustomerMergeAutoStatus])]).then(([{totalRowsCount:e,hasMore:t,nextOffset:n},[a,r]])=>{var o=f()(a,"body.meta.existence-check"),i=f()(r,"body.data.attributes.status");this.promise=null,i===U.g&&Object(V.k)().then(this.onPollingEnded),this.setState({offset:n,hasMore:t,loading:!1,totalRowsCount:e,autoMergeStatus:i,duplicatedProfileExist:o,duplicatesNotificationVisible:o})}):se({})}UNSAFE_componentWillReceiveProps(e){h()(this.props.requestParams,e.requestParams)||(oe(e.requestParams)?this.fetchData(e,!1):se({}))}shouldComponentUpdate(e,t){return!(this.state.loading&&t.loading||this.state.loadingMore&&t.loadingMore)}componentWillUnmount(){T.a.resetCustomerSearchResult(),Object(V.l)()}makeApiCall(e,t=!1){var{requestParams:{query:n=" ",sortBy:a,sortOrder:r}}=e,{offset:o}=this.state;return this.promise=Object(V.j)({query:n,offset:t?o:0,limit:100,sortBy:m()(a),sortOrder:r},!t),this.promise}renderDuplicatesNotification(){var{isMatch:e}=this.props,{duplicatesNotificationVisible:t,duplicatedProfileExist:n,autoMergeStatus:a}=this.state,r=a===U.g;return r||n&&(e||t)?v.a.createElement(W.a,{isMatch:e,handleMergeCustomer:this.handleMergeCustomer,hideNotificationBar:this.hideNotificationBar,className:X.a.duplicatesNotification,type:r?W.a.types.MERGE_RUNNING:W.a.types.LIST}):null}render(){var{isMatch:e,clients:t,requestParams:{query:n,sortBy:a,sortOrder:r}}=this.props,{importModalOpen:o,loading:i,loadingMore:s,totalRowsCount:c}=this.state,l=c&&t&&t.length>0||n,u=this.renderDuplicatesNotification();return v.a.createElement(O.Fragment,null,v.a.createElement(L.d,{title:Object(M.c)(K())}),!e&&u,v.a.createElement(q.b,{selfRef:this.setContentRef,withPadding:!e,color:e?void 0:"gray-2"},v.a.createElement(D.a,{if:i&&!c&&!n,withPadding:!0,fixedMobile:!0,flex:l?void 0:"column",justifyContent:l?void 0:"center",alignItems:l?void 0:"center",type:e?void 0:"color-gray-2",className:N()(X.a.self,{[X.a.notificationVisible]:u}),childrenClassName:X.a.loaderChildren,selfRef:this.setRef},v.a.createElement(Y.a,{history:w.a}),l?v.a.createElement(x.b,{flex:"column",className:X.a.container},v.a.createElement(G.a,{initialValues:{query:n||""},onSubmit:this.handleFiltersChange,toggleImportModal:this.toggleImportModal,handleMergeCustomer:this.handleMergeCustomer,menuActions:this.menuActions}),e?v.a.createElement(O.Fragment,null,v.a.createElement(R.a,{actions:this.menuActions,hideOnDesktop:!0}),v.a.createElement(J.a,{items:t,notification:u,onLoadMore:this.handleLoadMore,onItemClick:this.navigateToClientProfile})):v.a.createElement(Q.a,{sortBy:a,sortOrder:r,onSortChange:this.handleSortChange,items:t,totalRowsCount:c,limit:100,loading:s,onLoadMore:this.handleLoadMore,onRowClick:this.navigateToClientProfile})):v.a.createElement(z.a,{toggleImportModal:this.toggleImportModal}),o&&v.a.createElement(Z.a,{onClose:this.toggleImportModal}))))}},u()(r,"propTypes",{isMatch:E.a.bool.isRequired,requestParams:E.a.object.isRequired,clients:E.a.arrayOf(E.a.object).isRequired}),a=o))||a)||a}).call(this,n("yLpj"))},"35RN":function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return g}));var a=n("lSNA"),r=n.n(a),o=n("q1tI"),i=n.n(o),s=n("i8i4"),c=n("pVnL"),l=n.n(c),u=n("17x9"),d=n.n(u);function m({text:e,link:t,last:n,history:a}){var r={className:n?"":"top-nav__title--link",children:e};return t&&!n?function(e,t,n){return i.a.createElement("a",l()({onClick:n=>function(e,t,n){e.preventDefault(),t.push(n)}(n,t,e),href:e},n))}(t,a,r):i.a.createElement("span",r)}function p(){return i.a.createElement("span",{className:"top-nav__title--separator"},"/")}function h({paths:e,history:t}){var n=e.length,a=null;if(n>0){var r=n-1,o=[];e.forEach((e,n)=>{var a=n===r;o.push(i.a.createElement(m,l()({key:"crumb-".concat(n)},e,{last:a,history:t}))),a||o.push(i.a.createElement(p,{key:"separator-".concat(n)}))}),a=i.a.createElement("div",null,o)}return a}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}m.propTypes={history:d.a.object.isRequired,text:d.a.string.isRequired,link:d.a.string,last:d.a.bool},h.propTypes={history:d.a.object.isRequired,paths:d.a.arrayOf(d.a.shape({text:d.a.string.isRequired,link:d.a.string}))};class f extends i.a.Component{constructor(e){super(e),this.containerEl=document.querySelector("header .top-nav .top-nav__title--item"),this.renderBreadcrumbs=this.renderBreadcrumbs.bind(this)}componentDidMount(){this.renderBreadcrumbs()}componentDidUpdate(){this.renderBreadcrumbs()}renderBreadcrumbs(){this.containerEl instanceof HTMLElement&&Object(s.render)(i.a.createElement(h,this.props),this.containerEl)}render(){return null}}function g(e,t){return{text:e,link:t}}r()(f,"propTypes",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},h.propTypes))},"5XOi":function(e,t,n){"use strict";n.d(t,"a",(function(){return Z}));var a,r,o,i,s,c,l=n("pVnL"),u=n.n(l),d=n("QILm"),m=n.n(d),p=n("lSNA"),h=n.n(p),b=n("mwIZ"),f=n.n(b),g=n("q1tI"),O=n.n(g),v=n("17x9"),y=n.n(v),E=n("TSYQ"),C=n.n(E),j=n("Jje6"),S=n("TSDZ"),N=n("i6OX"),A=n("JraT"),M=n("AQgK"),T=n("/pl8"),P=n("g5rd"),w=n("NgSR"),x=n("VkAN"),k=n.n(x),I=n("PhEd"),D=n("/MKj"),R=n("ePPS"),L=n("Qs7Y"),q=n("dhJQ"),F=n("jLFJ"),B=n("nbpM"),V=n("3WHN"),U=n("vxZb"),_=n.n(U);function G(){var e=k()(["Walk-In"]);return G=function(){return e},e}function Y(){var e=k()(["Walk-In"]);return Y=function(){return e},e}var Q=(a=Object(q.g)(),r=Object(F.f)(["isHover","isActive"]),o=Object(D.b)((e,{customer:t})=>({isReshedulEnabled:B.a.isReshedulEnabled(e),customerOnlineProfileOverride:Object(V.a)(e,t)})),a(i=Object(F.d)(i=r(i=o((c=s=class extends g.PureComponent{render(){var e=this.props,{className:t,customer:n,customerOnlineProfileOverride:a,children:r,isMatch:o,isActive:i,isHover:s,avatarSize:c,isReshedulEnabled:l}=e,d=m()(e,["className","customer","customerOnlineProfileOverride","children","isMatch","isActive","isHover","avatarSize","isReshedulEnabled"]),{name:p,contactNumber:h,email:b}=a;return O.a.createElement(j.b,u()({className:C()(_.a.self,{[_.a.active]:i,[_.a.hover]:s},t),qaType:"customer-item"},d),O.a.createElement(P.a,{className:_.a.customerAvatar,size:c,customerId:f()(n,"id")}),O.a.createElement(j.b,{className:_.a.customerDetails,flex:"column",grow:1},l?O.a.createElement(I.Text,{type:"fresha-h4",color:"gray100",qaType:"customer-name"},n?n.name:Object(R.c)(Y()),p&&" *"):O.a.createElement(L.d,{type:"item-name",className:_.a.customerName,qaType:"customer-name"},n?n.name:Object(R.c)(G()),p&&" *"),n&&(l?O.a.createElement(I.Text,{type:"fresha-caption",color:"gray50",qaType:"customer-contact-number-email"},n.contactNumber,h&&" *",n.email&&", ",n.email,b&&" *"):O.a.createElement(L.d,{type:o?"form-label":"body-2",qaType:"customer-contact-number-email"},n.contactNumber,h&&" *",n.email&&", ",n.email,b&&" *"))),r)}},h()(s,"propTypes",{className:y.a.string,customer:w.a,customerOnlineProfileOverride:y.a.shape({name:y.a.bool,contactNumber:y.a.bool,email:y.a.bool}),children:y.a.node,isMatch:y.a.bool,isActive:y.a.bool,isHover:y.a.bool,avatarSize:P.e.propTypes.size,isReshedulEnabled:y.a.bool}),h()(s,"defaultProps",{avatarSize:P.e.SIZE.DEFAULT}),i=c))||i)||i)||i)||i),z=n("jT/X"),J=n.n(z);class Z extends g.PureComponent{constructor(...e){super(...e),h()(this,"dropdown",void 0),h()(this,"dropdownRef",e=>{this.dropdown=e}),h()(this,"toggleDropdown",()=>{this.dropdown.toggleMenu()}),h()(this,"renderDropdownAction",({show:e,text:t,onAction:n,danger:a,permissionButton:r,permissionKeys:o,qaType:i})=>e?r?O.a.createElement(T.b,{keys:o},e=>O.a.createElement(S.c,{onAction:Object(T.c)(e,n),qaType:i},t)):a?O.a.createElement(S.b,{onAction:n,qaType:i},t):O.a.createElement(S.c,{onAction:n,qaType:i},t):null)}render(){var e=this.props,{className:t,customer:n,onAction:a,detailsMode:r,isMatch:o,dropdownActions:i=[],avatarSize:s}=e,c=m()(e,["className","customer","onAction","detailsMode","isMatch","dropdownActions","avatarSize"]),l=f()(n,"labels.length",[])>0,d=n&&n.displayNote&&n.note;return O.a.createElement(j.b,u()({qaType:"customer-widget",className:C()(J.a.self,t),shrink:0,flex:"column"},c),O.a.createElement(Q,{className:C()({[J.a.withBadges]:l}),onAction:r?this.toggleDropdown:a,customer:n,avatarSize:s},(r||a)&&O.a.createElement(j.b,{className:J.a.iconWrapper},r?O.a.createElement(S.f,{qaType:"customer-dropdown-menu",icon:S.f.ICON.OPTIONS,align:"right",rwdRef:this.dropdownRef,className:C()(J.a.icon,J.a.dropdown)},i.map(e=>this.renderDropdownAction(e))):a&&O.a.createElement(N.b,{size:"small",name:"arrow-right-cropped",color:"gray-7",className:J.a.iconWrapperIcon}))),l&&O.a.createElement(M.a,{className:C()(J.a.badges,{[J.a.withNote]:d}),customer:n}),d&&O.a.createElement(j.b,{className:J.a.noteWrapper,flex:"row"},O.a.createElement(A.a,{note:n.note})),O.a.createElement(j.b,{className:J.a.border}))}}h()(Z,"propTypes",{customer:w.a,onAction:y.a.func,className:y.a.string,detailsMode:y.a.bool,isMatch:y.a.bool,dropdownActions:y.a.arrayOf(y.a.shape({show:y.a.bool,onAction:y.a.func,text:y.a.string,danger:y.a.bool,permissionButton:y.a.bool,permissionKeys:y.a.string,qaType:y.a.string})),avatarSize:P.e.propTypes.size}),h()(Z,"defaultProps",{detailsMode:!1})},"7NDt":function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Ki}));var a,r,o,i=n("pVnL"),s=n.n(i),c=n("lSNA"),l=n.n(c),u=n("q1tI"),d=n.n(u),m=n("Ty5D"),p=n("/MKj"),h=n("17x9"),b=n.n(h),f=n("/pl8"),g=n("X67z"),O=n("VkAN"),v=n.n(O),y=n("mwIZ"),E=n.n(y),C=n("ePPS"),j=n("XOD0"),S=n("5ZU+"),N=n("Jje6"),A=n("kZhr"),M=n("dhJQ"),T=n("UtX9"),P=n("TSYQ"),w=n.n(P),x=n("PhEd"),k={FIRST_NAME:"firstName",LAST_NAME:"lastName",CONTACT_NUMBER:"contactNumber",EMAIL:"email"},I=n("XkDG"),D=n.n(I);function R(){var e=v()(["Email"]);return R=function(){return e},e}function L(){var e=v()(["Mobile"]);return L=function(){return e},e}function q(){var e=v()(["Last name"]);return q=function(){return e},e}function F(){var e=v()(["First name"]);return F=function(){return e},e}function B(){var e=v()(["Email"]);return B=function(){return e},e}function V(){var e=v()(["Mobile number"]);return V=function(){return e},e}function U(){var e=v()(["Last name"]);return U=function(){return e},e}function _(){var e=v()(["First name"]);return _=function(){return e},e}var G=[A.kb.required(Object(C.c)(_())),A.kb.maxLength(100)],Y=[A.kb.required(Object(C.c)(U())),A.kb.maxLength(100)],Q=A.kb.requiredPhoneNumber(Object(C.c)(V())),z=[A.kb.required(Object(C.c)(B())),A.kb.email()],J=e=>e&&e.toLowerCase(),Z=Object(A.q)({form:"overrideContactDetailsForm"})(a=Object(M.g)()((o=r=class extends u.PureComponent{renderMobile({fieldFirstName:e,fieldLastName:t,fieldContactNumber:n,fieldEmail:a}){var{className:r}=this.props;return d.a.createElement(N.b,{className:w()(D.a.self,r)},e,t,n,a)}renderDesktop({fieldFirstName:e,fieldLastName:t,fieldContactNumber:n,fieldEmail:a}){var{className:r}=this.props;return d.a.createElement(N.b,{className:w()(D.a.self,r)},d.a.createElement(N.b,{flex:"row"},e,t),n,a)}render(){var{isMatch:e}=this.props,t={fieldFirstName:d.a.createElement(x.ReduxForm.TextField,{name:k.FIRST_NAME,label:Object(C.c)(F()),validate:G}),fieldLastName:d.a.createElement(x.ReduxForm.TextField,{name:k.LAST_NAME,label:Object(C.c)(q()),validate:Y}),fieldContactNumber:d.a.createElement(x.ReduxForm.PhoneNumberField,{name:k.CONTACT_NUMBER,label:Object(C.c)(L()),validate:Q}),fieldEmail:d.a.createElement(x.ReduxForm.TextField,{name:k.EMAIL,label:Object(C.c)(R()),validate:z,normalize:J})};return e?this.renderMobile(t):this.renderDesktop(t)}},l()(r,"propTypes",{isMatch:b.a.bool,className:b.a.string}),a=o))||a)||a,W=n("JZM8"),H=n.n(W),X=n("HTL0"),K=n("gY1J");function $(){var e=v()(["them"]);return $=function(){return e},e}function ee(){var e=v()(["her"]);return ee=function(){return e},e}function te(){var e=v()(["him"]);return te=function(){return e},e}function ne(){var e=v()(["their"]);return ne=function(){return e},e}function ae(){var e=v()(["her"]);return ae=function(){return e},e}function re(){var e=v()(["his"]);return re=function(){return e},e}var oe,ie,se,ce,le,ue,de={[K.b.MALE]:Object(C.c)(re()),[K.b.FEMALE]:Object(C.c)(ae()),default:Object(C.c)(ne())},me={[K.b.MALE]:Object(C.c)(te()),[K.b.FEMALE]:Object(C.c)(ee()),default:Object(C.c)($())},pe=(e,t=me)=>t[e]||t.default,he=n("/Q2I"),be=n("tPh7"),fe=n("ivFB"),ge=n("g5rd"),Oe=n("tvPL"),ve=n.n(Oe),ye={SMALL:"small",DEFAULT:"default"},Ee=Object(M.g)()((se=ie=class extends u.PureComponent{constructor(...e){super(...e),l()(this,"extractClientInfo",()=>{var{client:e}=this.props,t=e.onlineProfile||{};return this.props.showOnlyCustomerData?{name:e.name,contactNumber:e.contactNumber,email:e.email}:{name:t.name,contactNumber:t.contactNumber,email:t.email}}),l()(this,"extractUiData",()=>{var{type:e,isMatch:t}=this.props;if(t)return{avatarSize:ge.e.SIZE.VERY_LARGE};switch(e){case ye.SMALL:return{avatarSize:ge.e.SIZE.DEFAULT};default:return{avatarSize:ge.e.SIZE.LARGE}}})}render(){var{client:e,client:{hasOverriddenOnlineProfile:t},className:n,children:a,isMatch:r,transparent:o,type:i,showOnlyCustomerData:s}=this.props,c=this.extractClientInfo(),l=this.extractUiData();return d.a.createElement(N.b,{flex:r?"column":"row",className:w()(ve.a.self,{[ve.a.transparent]:o},n)},d.a.createElement(N.b,{className:w()(ve.a.avatarContainer,{[ve.a.small]:i===ye.SMALL})},d.a.createElement(ge.a,{customerId:e.id,size:l.avatarSize})),d.a.createElement(N.b,{className:ve.a.infoContainer},d.a.createElement(x.Text,{qaType:"fresha-client-name",type:"fresha-h2",color:"gray100",className:w()({[ve.a.name]:i===ye.DEFAULT})},"".concat(c.name).concat(s&&t?" *":"")),d.a.createElement(x.Text,{qaType:"fresha-client-number",type:"fresha-caption",color:"gray100"},c.contactNumber),d.a.createElement(x.Text,{qaType:"fresha-client-email",type:"fresha-caption",color:"gray100"},c.email)),a)}},l()(ie,"propTypes",{isMatch:b.a.bool,client:b.a.shape(fe.a.propTypes).isRequired,className:b.a.string,type:b.a.oneOf(Object.values(ye)),transparent:b.a.bool,children:b.a.node,showOnlyCustomerData:b.a.bool}),l()(ie,"defaultProps",{type:ye.DEFAULT}),oe=se))||oe,Ce=n("dsWg"),je=n("W59S"),Se=n("mGS1"),Ne=n.n(Se);function Ae(){var e=v()(["Cancel"]);return Ae=function(){return e},e}function Me(){var e=v()(["Save"]);return Me=function(){return e},e}function Te(){var e=v()(["Update contact info"]);return Te=function(){return e},e}function Pe(){var e=v()(["Mobile number not valid"]);return Pe=function(){return e},e}function we(){var e=v()(["Contact details overridden"]);return we=function(){return e},e}var xe,ke,Ie,De=Object(p.b)((e,t)=>{var n=E()(t,"match.params.id");return{customer:Object(je.a)(e,n),customerId:n}},{submitForm:()=>Object(A.hb)("overrideContactDetailsForm")})(ce=Object(M.g)()((ue=le=class extends u.PureComponent{constructor(...e){super(...e),l()(this,"state",{isPending:!1}),l()(this,"handleClose",()=>{Object(j.b)(Object(Ce.u)(this.props.customerId))}),l()(this,"handleSubmit",e=>{var{customerId:t}=this.props,n=X.a.customerOverridePersonalInfoRequestFromForm(e);return this.setState({isPending:!0}),S.a.patchCustomerOverridePersonalInfo(t,n).then(()=>{S.a.addGlobalSuccessToast(Object(C.c)(we())),this.setState({isPending:!1}),this.handleClose()}).catch(e=>(this.setState({isPending:!1}),Object(A.ib)(e,{fields:[{code:"invalid-phone-number",field:k.CONTACT_NUMBER,jsonPointer:/\/contact-number$/,message:Object(C.c)(Pe())}]})))})}render(){var{isMatch:e,customer:t,submitForm:n}=this.props,{isPending:a}=this.state,r=Object(C.c)("This client added contact info to %{pronoun} Fresha online booking account. You can optionally update this contact info, any booking notifications for this client will be sent to the contact info set here.",{pronoun:pe(t.gender,de)}),o=H()(t,Object.values(k));return d.a.createElement(he.i,{qaType:"override-contact-details-modal",size:"small"},d.a.createElement(he.g,{subheader:e&&r,onClose:this.handleClose},Object(C.c)(Te())),d.a.createElement(he.c,{className:Ne.a.self,onlyBottomPadding:!0},d.a.createElement(Ee,{className:Ne.a.clientInfo,client:t,type:ye.SMALL}),!e&&d.a.createElement(be.a,{forceShow:!0},r),d.a.createElement(Z,{initialValues:o,onSubmit:this.handleSubmit})),d.a.createElement(he.e,null,d.a.createElement(x.Button,{variant:"primary",qaType:"submit-override",onAction:n,isPending:a,className:Ne.a.grow},Object(C.c)(Me())),d.a.createElement(x.Button,{variant:"secondary",onAction:this.handleClose,disabled:a,className:Ne.a.grow},Object(C.c)(Ae()))))}},l()(le,"propTypes",{isMatch:b.a.bool,customer:b.a.shape({gender:b.a.string}),customerId:b.a.string,submitForm:b.a.func}),ce=ue))||ce)||ce,Re=n("nbpM"),Le=n("Tv31"),qe=n.n(Le);function Fe(){var e=v()(["Cancel"]);return Fe=function(){return e},e}function Be(){var e=v()(["Restore"]);return Be=function(){return e},e}function Ve(){var e=v()(["Restore contact info"]);return Ve=function(){return e},e}function Ue(){var e=v()(["Original contact details couldn't be restored, please try again later"]);return Ue=function(){return e},e}function _e(){var e=v()(["Original contact details restored"]);return _e=function(){return e},e}var Ge,Ye,Qe,ze=Object(M.g)()(xe=Object(p.b)((e,t)=>({customer:Re.a.getCustomer(e,E()(t,"match.params.id"))}))((Ie=ke=class extends u.PureComponent{constructor(...e){super(...e),l()(this,"state",{isPending:!1}),l()(this,"handleClose",()=>{Object(j.b)(Object(Ce.u)(this.customerId))}),l()(this,"handleRestore",()=>(this.setState({isPending:!0}),S.a.patchCustomerRestorePersonalInfo(this.customerId).then(()=>{S.a.addGlobalSuccessToast(Object(C.c)(_e()))}).catch(()=>{S.a.addGlobalErrorToast(Object(C.c)(Ue()))}).finally(()=>{this.handleClose(),this.setState({isPending:!1})})))}get customerId(){return E()(this.props,"match.params.id")}render(){var{isMatch:e,customer:t}=this.props,{isPending:n}=this.state,a=Object(C.c)("This client's contact info has been manually overridden. Click restore to update the contact info to match %{pronoun} Fresha online booking account details.",{pronoun:pe(t.gender,de)});return d.a.createElement(he.i,{size:"small"},d.a.createElement(he.g,{subheader:e&&a,onClose:this.handleClose},Object(C.c)(Ve())),d.a.createElement(he.c,{onlyBottomPadding:!0},!e&&d.a.createElement(be.a,{forceShow:!0},a)),d.a.createElement(he.e,null,d.a.createElement(x.Button,{variant:"primary",onAction:this.handleRestore,withPending:!0,className:qe.a.grow},Object(C.c)(Be())),d.a.createElement(x.Button,{variant:"secondary",onAction:this.handleClose,disabled:n,className:qe.a.grow},Object(C.c)(Fe()))))}},l()(ke,"propTypes",{isMatch:b.a.bool,customer:b.a.shape({gender:b.a.string})}),xe=Ie))||xe)||xe,Je=n("zYuS"),Ze=n("E+oP"),We=n.n(Ze),He=n("ZO1O"),Xe=n("Vows");function Ke(){var e=v()(["Select Client"]);return Ke=function(){return e},e}function $e(){var e=v()(["Select client that you would like to edit."]);return $e=function(){return e},e}var et,tt,nt,at=Object(M.g)()(Ge=Object(p.b)((e,t)=>({customers:Re.a.getCustomerMergeIdentitiesArray(e,t.possibleCustomerDuplicatesIds,"firstName","asc"),customerContext:Re.a.getClientContext(e)}))((Qe=Ye=class extends u.PureComponent{constructor(...e){super(...e),l()(this,"pickCustomer",e=>()=>{var{customerContext:t}=this.props;t&&S.a.resetCustomerContext(K.c.START_EDIT,e),Object(j.f)(Object(Ce.u)(e))}),l()(this,"goBack",()=>{Object(j.f)(j.a.location.pathname.replace("/duplicates",""))})}componentDidMount(){We()(this.props.customers)&&this.goBack()}render(){var{isMatch:e,customers:t}=this.props,n=d.a.createElement(x.Text,{type:"fresha-paragraph",color:"gray50"},Object(C.c)($e()));return d.a.createElement(he.i,{size:"small"},d.a.createElement(he.g,{onClose:this.goBack,subheader:e&&n},Object(C.c)(Ke())),d.a.createElement(he.c,{onlyBottomPadding:!0},!e&&d.a.createElement(He.d,{type:"plain"},n),t.map(e=>d.a.createElement(Xe.f,{key:e.id,grow:0,forceSuffixShow:!0,onAction:this.pickCustomer(e.id),customer:e}))))}},l()(Ye,"propTypes",{customers:b.a.array,customerContext:b.a.object,isMatch:b.a.bool}),Ge=Qe))||Ge)||Ge,rt=n("qkhh"),ot=n("9AV2"),it=n("QqEi"),st=n("nXeb"),ct="basicInfo",lt="personalInfo",ut="addressDetails",dt="firstName",mt="lastName",pt="contactNumber",ht="telephone",bt="email",ft="notificationSetting",gt="acceptsMarketingNotifications",Ot="selectedLanguageCode",vt="marketplaceAppointmentConfirmationEnabled",yt="gender",Et="referralSource",Ct="birthdayDay",jt="birthdayMonth",St="birthdayYear",Nt="note",At="displayNote",Mt="address",Tt="area",Pt="city",wt="state",xt="postCode",kt=n("nIiI"),It=n("TJnl"),Dt=n("TSDZ"),Rt=n("DuVZ");function Lt(){var e=v()(["Learn more"]);return Lt=function(){return e},e}function qt(){var e=v()(["Push notifications"]);return qt=function(){return e},e}function Ft(){var e=v()(["Email"]);return Ft=function(){return e},e}function Bt(){var e=v()(["Text"]);return Bt=function(){return e},e}var Vt={sms:Object(C.c)(Bt()),email:Object(C.c)(Ft()),push:Object(C.c)(qt())},Ut=Object(p.b)((e,t)=>({availableChannels:Re.a.getCustomerAvailableChannelsById(e,t.client.id)}))((nt=tt=class extends u.PureComponent{componentDidMount(){var{id:e}=this.props.client;S.a.readCustomerAvailableChannels(e)}render(){var e,{client:t,availableChannels:n}=this.props,a=n.length>0;return d.a.createElement(x.Text,{type:"fresha-caption-small",color:"gray50"},!a&&Object(C.c)("%{name} set %{pronoun} contact info using %{pronoun} Fresha online booking login.",{name:t.firstName,pronoun:pe(t.gender,de)}),a&&Object(C.c)("%{name} set %{pronoun} contact info using %{pronoun} Fresha online booking login and accepts notifications sent by: %{availableChannels}.",{name:t.firstName,pronoun:pe(t.gender,de),availableChannels:(e=n,e.reduce((e,t)=>[...e,Vt[t]],[]).join(", "))})," ",d.a.createElement(x.Link,{key:"link",inheritFont:!0,linkTo:Rt.k},Object(C.c)(Lt())))}},l()(tt,"propTypes",{client:b.a.shape({firstName:b.a.string,gender:b.a.string,id:b.a.oneOfType([b.a.string,b.a.number])}).isRequired,availableChannels:b.a.array.isRequired}),et=nt))||et,_t=n("etDt"),Gt=n.n(_t);function Yt(){var e=v()(["Restore contact info"]);return Yt=function(){return e},e}function Qt(){var e=v()(["Update contact info"]);return Qt=function(){return e},e}class zt extends u.PureComponent{constructor(...e){super(...e),l()(this,"handleRestoreProfileData",()=>{var{client:e}=this.props;Object(j.c)(Object(Ce.A)(e.id))}),l()(this,"handleOverrideContactDetails",()=>{var{client:e}=this.props;Object(j.c)(Object(Ce.z)(e.id))})}render(){var{client:e,client:{hasOverriddenOnlineProfile:t},className:n}=this.props,a=e.onlineProfile||{};return d.a.createElement(N.b,{className:w()(Gt.a.self,n)},d.a.createElement(Ee,{client:e,transparent:!0,showOnlyCustomerData:!0},d.a.createElement(Dt.f,{className:Gt.a.dropdownMenu,icon:Dt.f.ICON.OPTIONS,align:"right",transparent:!0,qaType:"contact-info-dropdown"},d.a.createElement(Dt.c,{qaType:"update-contact-info",onAction:this.handleOverrideContactDetails},Object(C.c)(Qt())),t&&d.a.createElement(Dt.b,{qaType:"restore-contact-info",onAction:this.handleRestoreProfileData},Object(C.c)(Yt())))),d.a.createElement(N.b,{className:Gt.a.footer},d.a.createElement(Ut,{client:e}),t&&d.a.createElement(x.Text,{type:"fresha-caption-small",color:"gray50",className:Gt.a.overrideNote},Object(C.c)("* Contact info is different to Fresha online booking profile: %{name}",{name:[a.firstName,a.lastName].filter(Boolean).join(" ")}))))}}l()(zt,"propTypes",{client:b.a.shape({id:b.a.oneOfType([b.a.string,b.a.number]),hasOverriddenOnlineProfile:b.a.bool,onlineProfile:b.a.shape({})}).isRequired,className:b.a.string});var Jt,Zt,Wt,Ht=n("CSPg"),Xt=n.n(Ht);function Kt(){var e=v()(["Email"]);return Kt=function(){return e},e}function $t(){var e=v()(["Mobile"]);return $t=function(){return e},e}function en(){var e=v()(["Last name"]);return en=function(){return e},e}function tn(){var e=v()(["First name"]);return tn=function(){return e},e}function nn(){var e=v()(["Ask to confirm appointments with card"]);return nn=function(){return e},e}function an(){var e=v()(["Accepts marketing notifications"]);return an=function(){return e},e}function rn(){var e=v()(["Preferred language"]);return rn=function(){return e},e}function on(){var e=v()(["Send notifications by"]);return on=function(){return e},e}function sn(){var e=v()(["Telephone"]);return sn=function(){return e},e}function cn(){var e=v()(["Email & SMS"]);return cn=function(){return e},e}function ln(){var e=v()(["SMS"]);return ln=function(){return e},e}function un(){var e=v()(["Email"]);return un=function(){return e},e}function dn(){var e=v()(["Don't send notifications"]);return dn=function(){return e},e}var mn,pn,hn,bn={none:Object(C.c)(dn()),email:Object(C.c)(un()),sms:Object(C.c)(ln()),both:Object(C.c)(cn())},fn=A.kb.maxLength(100),gn=A.kb.maxLength(100),On=e=>e&&e.toLowerCase(),vn=Object(p.b)(e=>({providerCommunicationLanguageName:Re.a.getProviderCommunicationLanguageName(e),isMarketplaceAppointmentConfirmationUsable:Re.a.isMarketplaceAppointmentConfirmationUsable(e)}))((Wt=Zt=class extends u.PureComponent{getConsentInfo(){var{consentLog:e}=this.props;return e?Object(C.c)("%{name} updated this setting on %{date}",{name:e.name,date:d.a.createElement(kt.a,{key:"consent-log",date:e.date,dateFormat:It.b})}):""}renderMobile({fieldFirstName:e,fieldLastName:t,fieldContactNumber:n,fieldTelephone:a,fieldNotificationSetting:r,fieldEmail:o,fieldAcceptNotifications:i,fieldSelectedLanguage:s,fieldMarketplaceAppointmentConfirmationEnabled:c}){var{className:l}=this.props;return d.a.createElement(He.d,{flex:null,type:"form mobile",className:w()(Xt.a.self,l)},e,t,n,a,o,r,s,i,c)}renderDesktop({fieldFirstName:e,fieldLastName:t,fieldContactNumber:n,fieldTelephone:a,fieldNotificationSetting:r,fieldEmail:o,fieldAcceptNotifications:i,fieldSelectedLanguage:s,fieldMarketplaceAppointmentConfirmationEnabled:c}){var{className:l}=this.props;return d.a.createElement(N.b,{className:w()(Xt.a.self,l)},d.a.createElement(N.b,{flex:"row"},e,t),d.a.createElement(N.b,{flex:"row"},n,a),o,r,s,i,c)}render(){var{isMatch:e,clientInfo:t,className:n,notificationOptions:a,providerCommunicationLanguageName:r,isMarketplaceAppointmentConfirmationUsable:o}=this.props,i=Object(C.n)(),s=t&&t.isFresha,c=E()(t,"onlineProfile.languageCode"),l=d.a.createElement(x.ReduxForm.PhoneNumberField,{name:ht,label:Object(C.c)(sn())}),u=d.a.createElement(x.ReduxForm.SelectField,{name:ft,label:Object(C.c)(on()),invalidValueLabel:e?"":void 0},a.map(e=>d.a.createElement("option",{key:e,value:e},bn[e]))),m=d.a.createElement(x.ReduxForm.SelectField,{name:Ot,label:Object(C.c)(rn()),disabled:s,invalidValueLabel:e?"":void 0},d.a.createElement("option",{key:st.a,value:st.a},c?Object(C.c)("Set by client (%{languageCode})",{languageCode:c}):Object(C.c)("Use provider language (%{providerLanguage})",{providerLanguage:r})),i.map(e=>d.a.createElement("option",{key:e.code,value:e.code},e.name," (",e.localName,")"))),p=d.a.createElement(x.ReduxForm.BooleanField,{name:gt,asSwitchMobile:!0,label:Object(C.c)(an()),hint:this.getConsentInfo()}),h=o?d.a.createElement(x.ReduxForm.BooleanField,{name:vt,asSwitchMobile:!0,label:Object(C.c)(nn()),hint:this.getConsentInfo()}):null;if(s)return d.a.createElement(N.b,{className:w()(Xt.a.self,n)},d.a.createElement(zt,{client:t,className:Xt.a.clientCard}),d.a.createElement(He.d,{type:"form mobile"},l,m,p,h));var b={fieldFirstName:d.a.createElement(x.ReduxForm.TextField,{name:dt,label:Object(C.c)(tn()),noEditError:!0,validate:fn,className:Xt.a.grow}),fieldLastName:d.a.createElement(x.ReduxForm.TextField,{name:mt,label:Object(C.c)(en()),noEditError:!0,validate:gn,className:Xt.a.grow}),fieldContactNumber:d.a.createElement(x.ReduxForm.PhoneNumberField,{name:pt,label:Object(C.c)($t())}),fieldTelephone:l,fieldEmail:d.a.createElement(x.ReduxForm.TextField,{name:bt,label:Object(C.c)(Kt()),normalize:On,noEditError:!0}),fieldNotificationSetting:u,fieldAcceptNotifications:p,fieldSelectedLanguage:m,fieldMarketplaceAppointmentConfirmationEnabled:h};return e?this.renderMobile(b):this.renderDesktop(b)}},l()(Zt,"propTypes",{isMatch:b.a.bool,clientInfo:b.a.object,consentLog:b.a.shape({name:b.a.string,date:b.a.any}),className:b.a.string,isMarketplaceAppointmentConfirmationUsable:b.a.bool,notificationOptions:b.a.arrayOf(b.a.string).isRequired,providerCommunicationLanguageName:b.a.string}),Jt=Wt))||Jt,yn=n("WjpJ"),En=n.n(yn),Cn=n("6kH+"),jn=Object(A.R)("clientForm"),Sn=n("wQmL"),Nn=n("uZ2f");function An(){var e=v()(["Display on all bookings"]);return An=function(){return e},e}function Mn(){var e=v()(["Client notes"]);return Mn=function(){return e},e}var Tn,Pn,wn,xn=Object(p.b)(e=>{var t=jn(e,lt);return{disableDisplayNote:!E()(t,Nt)}})((hn=pn=class extends u.PureComponent{constructor(...e){super(...e),l()(this,"handleNoteChange",(e,t)=>{var{dispatch:n}=this.props;n(Object(Sn.f)("clientForm","".concat(lt,".").concat(At),!!t))})}render(){var{isMatch:e,disableDisplayNote:t}=this.props,n=d.a.createElement(x.ReduxForm.TextField,{name:Nt,type:"textarea",label:Object(C.c)(Mn()),multiline:!0,noEditError:!0,onChange:this.handleNoteChange}),a=d.a.createElement(Nn.b,{name:At,asSwitchMobile:!0,label:Object(C.c)(An()),disabled:t});return e?d.a.createElement(He.d,{flex:null,type:"form mobile"},n,a):d.a.createElement(N.b,null,n,a)}},l()(pn,"propTypes",{isMatch:b.a.bool,disableDisplayNote:b.a.bool.isRequired,dispatch:b.a.func.isRequired}),mn=hn))||mn,kn=n("Og67"),In=n.n(kn);function Dn(){var e=v()(["Set year"]);return Dn=function(){return e},e}function Rn(){var e=v()(["Year"]);return Rn=function(){return e},e}function Ln(){var e=v()(["Day"]);return Ln=function(){return e},e}function qn(){var e=v()(["Month"]);return qn=function(){return e},e}function Fn(){var e=v()(["Birthday"]);return Fn=function(){return e},e}function Bn(){var e=v()(["Select source"]);return Bn=function(){return e},e}function Vn(){var e=v()(["Referral source"]);return Vn=function(){return e},e}function Un(){var e=v()(["Unknown"]);return Un=function(){return e},e}function _n(){var e=v()(["Female"]);return _n=function(){return e},e}function Gn(){var e=v()(["Male"]);return Gn=function(){return e},e}function Yn(){var e=v()(["Gender"]);return Yn=function(){return e},e}function Qn(){var e=v()(["Birthday"]);return Qn=function(){return e},e}function zn(){var e=v()(["December"]);return zn=function(){return e},e}function Jn(){var e=v()(["November"]);return Jn=function(){return e},e}function Zn(){var e=v()(["October"]);return Zn=function(){return e},e}function Wn(){var e=v()(["September"]);return Wn=function(){return e},e}function Hn(){var e=v()(["August"]);return Hn=function(){return e},e}function Xn(){var e=v()(["July"]);return Xn=function(){return e},e}function Kn(){var e=v()(["June"]);return Kn=function(){return e},e}function $n(){var e=v()(["May"]);return $n=function(){return e},e}function ea(){var e=v()(["April"]);return ea=function(){return e},e}function ta(){var e=v()(["March"]);return ta=function(){return e},e}function na(){var e=v()(["February"]);return na=function(){return e},e}function aa(){var e=v()(["January"]);return aa=function(){return e},e}var ra=(new Date).getFullYear(),oa=En()(1,32).map(e=>({value:String(e),label:e})),ia=[Object(C.c)(aa()),Object(C.c)(na()),Object(C.c)(ta()),Object(C.c)(ea()),Object(C.c)($n()),Object(C.c)(Kn()),Object(C.c)(Xn()),Object(C.c)(Hn()),Object(C.c)(Wn()),Object(C.c)(Zn()),Object(C.c)(Jn()),Object(C.c)(zn())].map((e,t)=>({value:String(t+1),label:e})),sa=En()(ra,ra-100,-1).map(e=>({value:String(e),label:e})),ca=Object(p.b)(e=>{var t=jn(e,lt),n=E()(t,St),a=E()(t,jt);return{birthdayYear:n,dayCount:a?new Date(Number(n||2012),Number(a),0).getDate():31}})((wn=Pn=class extends u.PureComponent{constructor(...e){super(...e),l()(this,"state",{showYearSelect:!1}),l()(this,"handleShowYearSelect",()=>{this.setState({showYearSelect:!0})}),l()(this,"handleChangeBirthday",()=>{var{dispatch:e}=this.props;e(Object(A.jb)("clientForm","".concat(lt,".").concat(jt),"".concat(lt,".").concat(Ct)))})}renderDesktop({fieldGender:e,fieldReferralSource:t,fieldBirthdayMonth:n,fieldBirthdayDay:a,fieldBirthdayYear:r,birthdayEnableYear:o}){var{birthdayYear:i,className:s}=this.props,{showYearSelect:c}=this.state;return d.a.createElement(N.b,{className:w()(In.a.self,s)},d.a.createElement(N.b,{flex:"row",className:In.a.grow},e,t),d.a.createElement(N.b,{flex:"row",className:In.a.grow},n,a,i||c?r:o),d.a.createElement(xn,null))}renderMobile({fieldGender:e,fieldReferralSource:t,fieldBirthdayMonth:n,fieldBirthdayDay:a,fieldBirthdayYear:r,birthdayEnableYear:o}){var{birthdayYear:i,className:s}=this.props,{showYearSelect:c}=this.state;return d.a.createElement(N.b,{className:w()(In.a.self,s)},d.a.createElement(He.d,{flex:null,type:"form"},e,t),d.a.createElement(Cn.b,{label:Object(C.c)(Qn())}),n,d.a.createElement(N.b,{flex:"row"},a,i||c?r:o))}render(){var{isMatch:e,referralSources:t,dayCount:n,disableReferralSourceEdit:a}=this.props,r={fieldGender:d.a.createElement(x.ReduxForm.SelectField,{name:yt,label:Object(C.c)(Yn()),grow:1},d.a.createElement("option",{value:"male"},Object(C.c)(Gn())),d.a.createElement("option",{value:"female"},Object(C.c)(_n())),d.a.createElement("option",{value:""},Object(C.c)(Un()))),fieldReferralSource:d.a.createElement(x.ReduxForm.SelectField,{name:Et,label:Object(C.c)(Vn()),invalidValueLabel:e?"":Object(C.c)(Bn()),resetButton:!a,disabled:a},t.map(({id:e,name:t})=>d.a.createElement("option",{key:e,value:e},t))),fieldBirthdayMonth:d.a.createElement(x.ReduxForm.SelectField,{name:jt,label:!e&&Object(C.c)(Fn()),invalidValueLabel:Object(C.c)(qn()),resetButton:!0,onChange:this.handleChangeBirthday},ia.map(({value:e,label:t})=>d.a.createElement("option",{key:e,value:e},t))),fieldBirthdayDay:d.a.createElement(x.ReduxForm.SelectField,{name:Ct,invalidValueLabel:Object(C.c)(Ln()),resetButton:!0,onChange:this.handleChangeBirthday,className:In.a.birthdayDay},oa.map(({value:e,label:t})=>e<=n?d.a.createElement("option",{key:e,value:e},t):null)),fieldBirthdayYear:d.a.createElement(x.ReduxForm.SelectField,{name:St,invalidValueLabel:Object(C.c)(Rn()),resetButton:!0,className:In.a.birthdayDay},sa.map(({value:e,label:t})=>d.a.createElement("option",{key:e,value:e},t))),birthdayEnableYear:d.a.createElement(N.b,{grow:1,className:In.a.birthdayYearLink},d.a.createElement(x.Link,{qaType:"setBirthdayYear",onAction:this.handleShowYearSelect},Object(C.c)(Dn())))};return e?this.renderMobile(r):this.renderDesktop(r)}},l()(Pn,"propTypes",{isMatch:b.a.bool,className:b.a.string,referralSources:b.a.arrayOf(b.a.object).isRequired,birthdayYear:b.a.string,dayCount:b.a.number.isRequired,dispatch:b.a.func.isRequired,disableReferralSourceEdit:b.a.bool}),Tn=wn))||Tn,la=n("Bk8S"),ua=n.n(la);function da(){var e=v()(["Zip / Post Code"]);return da=function(){return e},e}function ma(){var e=v()(["State"]);return ma=function(){return e},e}function pa(){var e=v()(["City"]);return pa=function(){return e},e}function ha(){var e=v()(["Suburb"]);return ha=function(){return e},e}function ba(){var e=v()(["Address"]);return ba=function(){return e},e}class fa extends u.PureComponent{renderMobile({fieldAddress:e,fieldArea:t,fieldCity:n,fieldPostcode:a,fieldState:r}){var{className:o}=this.props;return d.a.createElement(He.d,{type:"form plain",className:w()(ua.a.self,o)},e,t,n,r,a)}renderDesktop({fieldAddress:e,fieldArea:t,fieldCity:n,fieldPostcode:a,fieldState:r}){var{className:o}=this.props;return d.a.createElement(N.b,{className:w()(ua.a.self,o)},e,t,d.a.createElement(N.b,{flex:"row"},n,r),a)}render(){var{isMatch:e}=this.props,t=d.a.createElement(x.ReduxForm.TextField,{name:Mt,label:Object(C.c)(ba()),noEditError:!0}),n=d.a.createElement(x.ReduxForm.TextField,{name:Tt,label:Object(C.c)(ha()),noEditError:!0}),a=d.a.createElement(x.ReduxForm.TextField,{name:Pt,label:Object(C.c)(pa()),noEditError:!0}),r=d.a.createElement(x.ReduxForm.TextField,{name:wt,label:Object(C.c)(ma()),noEditError:!0}),o={fieldAddress:t,fieldArea:n,fieldCity:a,fieldPostcode:d.a.createElement(x.ReduxForm.TextField,{name:xt,label:Object(C.c)(da()),noEditError:!0}),fieldState:r};return e?this.renderMobile(o):this.renderDesktop(o)}}l()(fa,"propTypes",{isMatch:b.a.bool,className:b.a.string});var ga=n("j0q1"),Oa=n.n(ga);function va(){var e=v()(["Edit Client"]);return va=function(){return e},e}function ya(){var e=v()(["New Client"]);return ya=function(){return e},e}function Ea(){var e=v()(["Save"]);return Ea=function(){return e},e}function Ca(){var e=v()(["Cancel"]);return Ca=function(){return e},e}function ja(){var e=v()(["Delete"]);return ja=function(){return e},e}function Sa(){var e=v()(["Address"]);return Sa=function(){return e},e}function Na(){var e=v()(["Personal Info"]);return Na=function(){return e},e}class Aa extends u.PureComponent{render(){var{clientId:e,clientInfo:t,consentLog:n,notificationOptions:a,referralSources:r,notification:o,disableReferralSourceEdit:i}=this.props,s=!e,c=d.a.createElement(A.s,{name:ct},d.a.createElement(vn,{clientInfo:t,consentLog:n,notificationOptions:a})),l=d.a.createElement(it.b,{paddingBottom:32},d.a.createElement(it.a,{name:Object(C.c)(Na())},d.a.createElement(A.s,{name:lt},d.a.createElement(ca,{clientInfo:t,isFreshaClient:t&&t.isFresha,referralSources:r,disableReferralSourceEdit:i}))),d.a.createElement(it.a,{qaType:"address-tab",name:Object(C.c)(Sa())},d.a.createElement(A.s,{name:ut},d.a.createElement(fa,null)))),u=d.a.createElement(N.b,{flex:"column"},o,d.a.createElement(N.b,{flex:"row",grow:1,justifyContent:"space-between"},!s&&d.a.createElement(x.Button,{variant:"danger",onAction:this.props.handleOpenDeleteModal,qaType:"delete-client"},Object(C.c)(ja())),d.a.createElement(N.b,{flex:"row",grow:1}),d.a.createElement(x.Button,{variant:"secondary",qaType:"close-add-client",className:Oa.a.footerButton,onAction:this.props.handleCancel},Object(C.c)(Ca())),d.a.createElement(x.Button,{qaType:"save-client",className:Oa.a.footerButton,onAction:this.props.handleSave,variant:"primary"},Object(C.c)(Ea()))));return d.a.createElement(ot.a,{header:s?Object(C.c)(ya()):Object(C.c)(va()),headerOnAction:this.props.handleCancel,leftPanel:c,rightPanel:l,footer:u})}}l()(Aa,"propTypes",{clientId:b.a.string,clientInfo:b.a.object,notificationOptions:b.a.arrayOf(b.a.string).isRequired,referralSources:b.a.arrayOf(b.a.object).isRequired,handleCancel:b.a.func,handleSave:b.a.func,handleOpenDeleteModal:b.a.func,notification:b.a.element,disableReferralSourceEdit:b.a.bool,consentLog:b.a.object});var Ma=n("aAma"),Ta=n("MoLQ"),Pa=n("QILm"),wa=n.n(Pa);function xa(){var e=v()(["Save"]);return xa=function(){return e},e}function ka({name:e,header:t,ContentComponent:n,validate:a}){var r,o,i;return Object(A.c)({formName:"clientForm",name:e})((i=o=class extends u.PureComponent{constructor(...e){super(...e),l()(this,"handleClose",()=>{this.props.onClose()}),l()(this,"handleSave",()=>{var{formValues:e,saveValues:t}=this.props;a&&!a(e)||(t(),this.handleClose())})}render(){var e=this.props,{formValues:a,saveValues:r,onClose:o}=e,i=wa()(e,["formValues","saveValues","onClose"]);return d.a.createElement(he.i,null,d.a.createElement(he.g,{onClose:this.handleClose},t),d.a.createElement(he.c,{onlyBottomPadding:!0},d.a.createElement(n,i)),d.a.createElement(he.e,null,d.a.createElement(he.a,{type:x.Button,variant:"primary",onAction:this.handleSave},Object(C.c)(xa()))))}},l()(o,"propTypes",{onClose:b.a.func,formValues:b.a.object,saveValues:b.a.func}),r=i))||r}var Ia={clientId:b.a.string,clientInfo:b.a.object,notificationOptions:b.a.arrayOf(b.a.string).isRequired,referralSources:b.a.arrayOf(b.a.object).isRequired,handleCancel:b.a.func,handleSave:b.a.func,handleOpenDeleteModal:b.a.func,handleCloseDeleteModal:b.a.func,loading:b.a.bool,change:b.a.func,touch:b.a.func,notification:b.a.element},Da=n("eWa3"),Ra=n.n(Da);function La(){var e=v()(["Day is invalid"]);return La=function(){return e},e}function qa(){var e=v()(["Month must be selected"]);return qa=function(){return e},e}function Fa(){var e=v()(["Day must be selected"]);return Fa=function(){return e},e}function Ba(){var e=v()(["This field is required"]);return Ba=function(){return e},e}function Va(){var e=v()(["Incorrect email address"]);return Va=function(){return e},e}function Ua(){var e=v()(["This is not a valid mobile phone number"]);return Ua=function(){return e},e}function _a(){var e=v()(["First name is required"]);return _a=function(){return e},e}var Ga=/^[0-9]{11}$/gi;function Ya({birthdayMonth:e,birthdayDay:t,birthdayYear:n}){var a,r,o,i,s={};return!e&&!n||t||(s.birthdayDay=Object(C.c)(Fa())),!t&&!n||e||(s.birthdayMonth=Object(C.c)(qa())),e&&t&&(a=n||2012,r=e,o=t,(i=new Date(a,r-1,o)).getFullYear()!==Number(a)||i.getMonth()!==Number(r)-1||i.getDate()!==Number(o))&&(s.birthdayDay=Object(C.c)(La())),s}var Qa=n("dDYu"),za=n.n(Qa);function Ja(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Za(){var e=v()(["New Client"]);return Za=function(){return e},e}function Wa(){var e=v()(["Edit Client"]);return Wa=function(){return e},e}function Ha(){var e=v()(["Save"]);return Ha=function(){return e},e}function Xa(){var e=v()(["Delete"]);return Xa=function(){return e},e}function Ka(){var e=v()(["Address details"]);return Ka=function(){return e},e}function $a(){var e=v()(["Personal info"]);return $a=function(){return e},e}function er(){var e=v()(["Additional Information"]);return er=function(){return e},e}function tr(){var e=v()(["Client Notes"]);return tr=function(){return e},e}function nr(){var e=v()(["Address details"]);return nr=function(){return e},e}function ar(){var e=v()(["Personal Info"]);return ar=function(){return e},e}var rr=1,or=2,ir=3,sr=ka({name:lt,header:Object(C.c)(ar()),ContentComponent:ca,validate:({personalInfo:e})=>{var t=Ya(e);return We()(t)}}),cr=ka({name:ut,header:Object(C.c)(nr()),ContentComponent:fa});class lr extends u.PureComponent{constructor(...e){super(...e),l()(this,"state",{view:rr}),l()(this,"handleShowBasic",()=>{this.setState({view:rr})}),l()(this,"handleShowPersonal",()=>{this.setState({view:or})}),l()(this,"handleShowAddress",()=>{this.setState({view:ir})})}renderBasicInfo(){var{clientInfo:e,consentLog:t,notificationOptions:n}=this.props;return d.a.createElement(Ma.b,{type:"form",noPadding:!0,shrink:0},d.a.createElement(A.s,{name:ct},d.a.createElement(vn,{isMatch:!0,clientInfo:e,notificationOptions:n,consentLog:t})),d.a.createElement(A.s,{name:lt},d.a.createElement(Cn.b,{label:Object(C.c)(tr())}),d.a.createElement(xn,{isMatch:!0})),d.a.createElement(Cn.b,{label:Object(C.c)(er())}),d.a.createElement(Xe.x,{onAction:this.handleShowPersonal},Object(C.c)($a())),d.a.createElement(Xe.x,{onAction:this.handleShowAddress},Object(C.c)(Ka())))}renderSubview(){var{clientInfo:e}=this.props,{view:t}=this.state;switch(t){case or:return d.a.createElement(sr,{onClose:this.handleShowBasic,clientInfo:e,isFreshaClient:e&&e.isFresha,referralSources:this.props.referralSources,disableReferralSourceEdit:this.props.disableReferralSourceEdit,isMatch:!0});case ir:return d.a.createElement(cr,{onClose:this.handleShowBasic,isMatch:!0});default:return null}}render(){var{clientId:e,notification:t,handleSave:n,handleOpenDeleteModal:a}=this.props,r=d.a.createElement(N.b,{flex:"column"},t,d.a.createElement(N.b,{flex:"row"},e&&d.a.createElement(x.Button,{variant:"danger",className:za.a.footerButton,onAction:a,qaType:"delete-mobile-btn"},Object(C.c)(Xa())),d.a.createElement(x.Button,{className:za.a.footerButton,onAction:n,qaType:"save-mobile-btn",variant:"primary"},Object(C.c)(Ha()))));return d.a.createElement(Ta.a,{className:za.a.self,header:e?Object(C.c)(Wa()):Object(C.c)(Za()),headerOnAction:this.props.handleCancel,footer:r},this.renderBasicInfo(),this.renderSubview())}}l()(lr,"propTypes",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ja(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ja(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Ia));var ur,dr,mr,pr=n("xEy0"),hr=n.n(pr);function br(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function fr(){var e=v()(["New Client"]);return fr=function(){return e},e}function gr(){var e=v()(["Edit Client"]);return gr=function(){return e},e}var Or,vr,yr,Er,Cr,jr,Sr=Object(A.W)("clientForm"),Nr=Object(M.g)()(ur=Object(A.q)({form:"clientForm",immutableProps:["clientId","clientInfo","notificationOptions","referralSources"],validate:function(e){var t,{basicInfo:{firstName:n,contactNumber:a,email:r,notificationSetting:o}={},personalInfo:i={}}=e,s={basicInfo:{},personalInfo:{},addressDetails:{}};return n||(s.basicInfo.firstName=Object(C.c)(_a())),a&&(t=a.replace("\\s","","g"),Ga.test(t))&&(s.basicInfo.contactNumber=Object(C.c)(Ua())),r&&!Ra()(r)&&(s.basicInfo.email=Object(C.c)(Va())),o||(s.basicInfo.notificationSetting=Object(C.c)(Ba())),s.personalInfo=Ya(i),s},enableReinitialize:!0,destroyOnUnmount:!1})(ur=Object(p.b)(e=>({formValues:Sr(e)}))((mr=dr=class extends u.PureComponent{constructor(...e){super(...e),l()(this,"state",{deleteModalOpen:!1,possibleCustomerDuplicatesIds:[]}),l()(this,"handleOpenDeleteModal",()=>{this.setState({deleteModalOpen:!0})}),l()(this,"handleCloseDeleteModal",()=>{this.setState({deleteModalOpen:!1})}),l()(this,"handleCancel",()=>{Object(j.b)(Ce.d)}),l()(this,"handleSave",()=>{var{submit:e}=this.props;e()}),l()(this,"handleReviewCustomerDuplicates",()=>{var{clientId:e,formValues:t}=this.props,n={email:E()(t,"basicInfo.email"),contactNumber:E()(t,"basicInfo.contactNumber"),includeCustomers:!0,customerId:e};S.a.readCustomerMergeClosestDuplicates(n).then(e=>{this.setState({possibleCustomerDuplicatesIds:e.body.data.map(({id:e})=>e)},()=>{Object(j.f)("".concat(j.a.location.pathname,"/duplicates"))})})})}render(){var{clientId:e,clientInfo:t,consentLog:n,notificationOptions:a,referralSources:r,isMatch:o,duplicatesNotificationVisible:i,hasPossibleDuplicates:s,hideNotificationBar:c,loading:l}=this.props,{deleteModalOpen:u,possibleCustomerDuplicatesIds:p}=this.state,h=function(e,{referralSource:t}={}){return!!e.find(({id:e,name:n,isDefault:a})=>e===t&&a&&"Walk-In"!==n)}(r,t),b=s&&i?d.a.createElement(Je.a,{hideNotificationBar:c,handleMergeCustomer:this.handleReviewCustomerDuplicates,className:hr.a.duplicatesNotification,type:Je.a.types.FORM,isMobileNotificationBox:!0,isMatch:o,negativeMargin:!0}):null,f={clientId:e,clientInfo:t,consentLog:n,notificationOptions:a,referralSources:r,handleSave:this.handleSave,handleCancel:this.handleCancel,handleOpenDeleteModal:this.handleOpenDeleteModal,handleCloseDeleteModal:this.handleCloseDeleteModal,change:this.props.change,touch:this.props.touch,notification:b,disableReferralSourceEdit:h};return l?d.a.createElement(T.a,{headerSecondaryAction:this.handleCancel,header:e?Object(C.c)(gr()):Object(C.c)(fr()),type:"white"}):d.a.createElement(N.b,null,o?d.a.createElement(lr,f):d.a.createElement(Aa,f),u&&d.a.createElement(rt.a,{client:t,onClose:this.handleCloseDeleteModal}),[Ce.g,Ce.b].map(e=>d.a.createElement(m.b,{key:e,path:e,component:()=>d.a.createElement(at,{possibleCustomerDuplicatesIds:p})})),d.a.createElement(m.b,{path:Ce.m,component:De}),d.a.createElement(m.b,{path:Ce.n,component:ze}))}},l()(dr,"propTypes",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?br(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):br(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({clientId:b.a.string,isMatch:b.a.bool,hasPossibleDuplicates:b.a.bool,consentLog:b.a.object},A.Q)),ur=mr))||ur)||ur)||ur,Ar=n("yk2N"),Mr=Object(p.b)((e,t)=>{var{groupId:n}=t.match.params;return{group:Re.a.getCustomerMergeGroup(e,n)}})((yr=vr=class extends u.PureComponent{constructor(e){super(e),l()(this,"handleClose",()=>{Object(j.b)(Ce.h)}),e.group||Object(j.f)(Ce.h)}render(){var{group:e}=this.props;if(!e)return null;var{parentCustomer:t,customers:n}=e;return Object(C.g)("%{customersCount} duplicate found","%{customersCount} duplicates found",n.length,{customersCount:Object(Ar.f)(n.length)}),d.a.createElement(he.i,null,d.a.createElement(he.g,{onClose:this.handleClose,subheader:Object(C.g)("%{customersCount} duplicate found","%{customersCount} duplicates found",n.length,{customersCount:Object(Ar.f)(n.length)})},t.name),d.a.createElement(he.c,{onlyBottomPadding:!0},n.map(e=>d.a.createElement(Xe.f,{grow:0,suffix:null,customer:e}))))}},l()(vr,"propTypes",{group:b.a.object}),Or=yr))||Or,Tr=n("0JpQ"),Pr=n("SUXa"),wr=n("0XPj"),xr=n.n(wr),kr=n("sEfC"),Ir=n.n(kr),Dr=n("3WHN"),Rr=n("1UfZ"),Lr=n("EHXo");function qr(){var e=v()(["Mobile number not valid"]);return qr=function(){return e},e}function Fr(){var e=v()(["Client"]);return Fr=function(){return e},e}var Br,Vr,Ur,_r=Object(p.b)(e=>({providerPhonePrefix:Re.a.getProviderPhonePrefix(e),notificationOptions:Re.a.getProviderNotificationOptions(e),defaultNotificationSetting:Re.a.getCustomerDefaultNotifactionSetting(e),referralSources:Re.a.getReferralSourceList(e),formValues:Sr(e)}),{})((jr=Cr=class extends u.PureComponent{constructor(...e){super(...e),l()(this,"state",{loading:!0,hasPossibleDuplicates:!1,duplicatesNotificationVisible:!1}),l()(this,"checkDuplicates",()=>Object(Rr.d)(this.props.formValues).then(e=>{e&&this.setState({duplicatesNotificationVisible:!0,hasPossibleDuplicates:!0})}).catch(()=>{this.setState({loading:!1,duplicatesNotificationVisible:!1,hasPossibleDuplicates:!1})})),l()(this,"checkDuplicatesDebounced",Ir()(this.checkDuplicates,500)),l()(this,"handleFieldChange",(e,t,n,a)=>{var r=Lr.a(e.basicInfo,a.basicInfo);xr()(Rr.b,r).length>0&&(this.hideNotificationBar(),this.checkDuplicatesDebounced())}),l()(this,"hideNotificationBar",()=>{this.setState({duplicatesNotificationVisible:!1})}),l()(this,"handleCancel",()=>{Object(j.b)(Ce.d)}),l()(this,"handleSubmit",e=>(this.setState({loading:!0}),Object(Rr.e)(e).then(e=>{S.a.addCreatedToast(Object(C.c)(Fr())),S.a.notifyClientCreated(E()(e,"body.data.id")),Object(j.b)(Ce.d)}).catch(e=>{this.setState({loading:!1}),Object(A.ib)(e,{fields:[{code:"invalid-phone-number",field:"".concat(ct,".").concat(pt),jsonPointer:/\/contact-number$/,message:Object(C.c)(qr())}]})})))}componentDidMount(){S.a.resetReferralSourceList(),S.a.bulk([S.a.readReferralSourceList,S.a.readProviderLanguagesConfiguration,S.a.readNoShowSettings]).then(()=>{this.setState({loading:!1})}).catch(()=>{this.setState({loading:!1})})}calcInitialValues(e){var{query:{data:t=""}={}}=Object(Dr.c)(this.props);return Lr.b(t,e)}render(){var{providerPhonePrefix:e,notificationOptions:t,referralSources:n,defaultNotificationSetting:a}=this.props,{loading:r,hasPossibleDuplicates:o,duplicatesNotificationVisible:i}=this.state,s=this.calcInitialValues(e),c={[ct]:{[pt]:s.phone||e,[ht]:e,[dt]:s.firstName,[mt]:s.lastName,[bt]:s.email,[ft]:a,[gt]:!0,[vt]:!0}};return d.a.createElement(Nr,{initialValues:c,notificationOptions:t,referralSources:n,onSubmit:this.handleSubmit,loading:r,duplicatesNotificationVisible:i,hasPossibleDuplicates:o,hideNotificationBar:this.hideNotificationBar,asyncBlurFields:Rr.a,asyncValidate:this.checkDuplicates,onChange:this.handleFieldChange})}},l()(Cr,"propTypes",{providerPhonePrefix:b.a.string.isRequired,notificationOptions:b.a.arrayOf(b.a.string).isRequired,referralSources:b.a.arrayOf(b.a.object).isRequired,formValues:b.a.object,defaultNotificationSetting:b.a.string}),Er=jr))||Er,Gr=n("9oTK");function Yr(){var e=v()(["Mobile number not valid"]);return Yr=function(){return e},e}function Qr(){var e=v()(["Client"]);return Qr=function(){return e},e}var zr=Object(p.b)((e,{match:{params:{id:t}={}}={}})=>({clientId:t,clientInfo:Object(je.a)(e,t),consentLog:Re.a.getCustomerMarketingConsentLog(e,t),providerPhonePrefix:Re.a.getProviderPhonePrefix(e),notificationOptions:Re.a.getProviderNotificationOptions(e),referralSources:Re.a.getReferralSourceList(e),formValues:Sr(e)}),{})((Ur=Vr=class extends u.PureComponent{constructor(...e){super(...e),l()(this,"state",{loading:!0,hasPossibleDuplicates:!1,duplicatesNotificationVisible:!1}),l()(this,"checkDuplicates",()=>Object(Rr.d)(this.props.formValues,this.props.clientId).then(e=>{e&&this.setState({hasPossibleDuplicates:!0,duplicatesNotificationVisible:!0})}).catch(()=>{this.setState({loading:!1,hasPossibleDuplicates:!1,duplicatesNotificationVisible:!1})})),l()(this,"checkDuplicatesDebounced",Ir()(this.checkDuplicates,500)),l()(this,"handleFieldChange",(e,t,n,a)=>{var r=Lr.a(e.basicInfo,a.basicInfo);xr()(Rr.b,r).length>0&&(this.hideNotificationBar(),n.dirty&&this.checkDuplicatesDebounced())}),l()(this,"hideNotificationBar",()=>{this.setState({duplicatesNotificationVisible:!1})}),l()(this,"handleCancel",()=>{Object(j.b)(Ce.d)}),l()(this,"handleSubmit",e=>{var{clientId:t}=this.props;return this.setState({loading:!0}),Object(Rr.n)(t,e).then(()=>{S.a.addUpdatedToast(Object(C.c)(Qr())),S.a.notifyClientUpdated(t),Object(j.b)(Ce.d)}).catch(e=>{this.setState({loading:!1}),Object(A.ib)(e,{fields:[{code:"invalid-phone-number",field:"".concat(ct,".").concat(pt),jsonPointer:/\/contact-number$/,message:Object(C.c)(Yr())}]})})})}componentDidMount(){this.fetchData(this.props.clientId)}UNSAFE_componentWillReceiveProps(e){this.props.clientId!==e.clientId&&this.setState({loading:!0},()=>{this.fetchData(e.clientId)})}getFormInitialValues(){var{providerPhonePrefix:e,clientInfo:t}=this.props;if(t){var{firstName:n,lastName:a,email:r,gender:o,telephone:i,contactNumber:s,birthdayDay:c,birthdayMonth:l,birthdayYear:u,note:d,address:m,area:p,city:h,state:b,postCode:f,notificationSetting:g,acceptsMarketingNotifications:O,marketplaceAppointmentConfirmationEnabled:v,displayNote:y,referralSource:E,selectedLanguageCode:C,isFresha:j}=t;return{basicInfo:{firstName:n,lastName:a,email:r,contactNumber:s||e,telephone:i||e,notificationSetting:g,acceptsMarketingNotifications:O,selectedLanguageCode:j||null==C?st.a:C,marketplaceAppointmentConfirmationEnabled:v},personalInfo:{gender:o,referralSource:E,birthdayDay:c?String(c):null,birthdayMonth:l?String(l):null,birthdayYear:u?String(u):null,note:d,displayNote:y},addressDetails:{address:m,area:p,city:h,state:b,postCode:f}}}}fetchData(e){return S.a.resetReferralSourceList(),Object(Gr.all)([Object(Rr.i)(e,{include:"customer-payment-method"}),S.a.bulk([S.a.readReferralSourceList,S.a.readProviderLanguagesConfiguration,S.a.readNoShowSettings,[S.a.readCustomerMarketingConsentLog,e]])]).then(()=>{var{clientInfo:t}=this.props;t&&!t.deletedAt||Object(j.b)(Ce.d),this.setState({loading:!1}),S.a.notifyClientUpdated(e)}).catch(()=>{this.setState({loading:!1,hasPossibleDuplicates:!1,duplicatesNotificationVisible:!1})})}render(){var{clientId:e,clientInfo:t,notificationOptions:n,referralSources:a,consentLog:r}=this.props,{hasPossibleDuplicates:o,duplicatesNotificationVisible:i,loading:s}=this.state;return d.a.createElement(Nr,{initialValues:this.getFormInitialValues(),clientId:e,clientInfo:t,consentLog:r,notificationOptions:n,referralSources:a,onSubmit:this.handleSubmit,loading:s,key:t?"loaded":"empty",duplicatesNotificationVisible:i,hasPossibleDuplicates:o,hideNotificationBar:this.hideNotificationBar,asyncBlurFields:Rr.a,asyncValidate:this.checkDuplicates,onChange:this.handleFieldChange})}},l()(Vr,"propTypes",{clientId:b.a.string,clientInfo:b.a.object,consentLog:b.a.object,providerPhonePrefix:b.a.string.isRequired,notificationOptions:b.a.arrayOf(b.a.string).isRequired,referralSources:b.a.arrayOf(b.a.object).isRequired,formValues:b.a.object}),Br=Ur))||Br,Jr=n("lFKM"),Zr=n.n(Jr),Wr=n("zqxM"),Hr=n.n(Wr),Xr=n("OyCh"),Kr=n("gwpz"),$r=n("akLF"),eo=n("1Mpk"),to=n.n(eo);class no extends u.PureComponent{constructor(...e){super(...e),l()(this,"extractCustomerData",()=>{var{customer:e}=this.props,t=e.onlineProfile||{},n=[e.name!==t.name&&t.name,e.contactNumber?e.contactNumber!==t.contactNumber&&t.contactNumber:e.email!==t.email&&t.email].filter(Boolean);return{customerContact:e.contactNumber||e.email,onlineProfileData:n}})}render(){var{customer:e,groupId:t,duplicatesCount:n,hideDuplicatesCount:a}=this.props,{customerContact:r,onlineProfileData:o}=this.extractCustomerData();return d.a.createElement(N.b,{className:to.a.self,flex:"row"},d.a.createElement(ge.a,{customerId:e.id,className:to.a.avatar}),d.a.createElement(N.b,{flex:"column",justifyContent:"center"},d.a.createElement(x.Text,{className:to.a.name,type:"fresha-paragraph",color:"gray100"},e.name),d.a.createElement(x.Text,{className:to.a.contact,type:"fresha-caption-small",color:"gray100"},r),o.length>0&&d.a.createElement(x.Text,{className:to.a.onlineProfileData,type:"fresha-caption-small",color:"gray100"},"".concat(o.join(", ")," *")),!a&&d.a.createElement(x.Text,{type:"fresha-caption-small",color:"gray100"},Object(C.f)("%{duplicatesCount} Duplicates found. <a>See Details</a>",{duplicatesCount:Object(Ar.f)(n)},{a:e=>d.a.createElement(x.Link,{inheritFont:!0,linkTo:Object(Ce.w)(t),className:to.a.link},e)}))))}}l()(no,"propTypes",{groupId:b.a.string,customer:b.a.shape($r.a.PropTypes),duplicatesCount:b.a.number,hideDuplicatesCount:b.a.bool});var ao=Object(A.W)("mergeCustomers"),ro="GROUPS";class oo extends u.PureComponent{render(){var{customerMergeGroups:e,onSelectAllChange:t}=this.props,n=e.map(e=>({name:d.a.createElement(no,{key:e.id,groupId:e.id,customer:e.parentCustomer,duplicatesCount:e.customers.length}),value:e.id}));return d.a.createElement(x.ReduxForm.CheckBoxFieldArrayField,{name:ro,values:[{values:n}],onSelectAllChange:t,valign:"center"})}}function io({primaryValue:e,secondaryValue:t,className:n}){var a=!!e,r=!(!e||!t||e===t);return d.a.createElement(N.b,{className:n,basis:"33%"},a&&d.a.createElement(x.Text,{type:"fresha-caption",color:"gray100"},e),r&&d.a.createElement(x.Text,{weight:"light",type:"fresha-caption",color:"gray100"},"".concat(t," *")))}l()(oo,"propTypes",{customerMergeGroups:b.a.array,onSelectAllChange:b.a.func}),io.propTypes={primaryValue:b.a.string,secondaryValue:b.a.string,className:b.a.string};var so=n("NyTe"),co=n.n(so);class lo extends u.PureComponent{render(){var{className:e,customer:t}=this.props,n=t.onlineProfile||{};return d.a.createElement(N.b,{className:w()(co.a.self,e),flex:"row",justifyContent:"space-between",alignItems:"center"},d.a.createElement(ge.a,{customerId:t.id}),d.a.createElement(io,{primaryValue:t.name,secondaryValue:n.name,className:co.a.nameCell}),d.a.createElement(io,{primaryValue:t.contactNumber,secondaryValue:n.contactNumber}),d.a.createElement(io,{primaryValue:t.email,secondaryValue:n.email}))}}l()(lo,"propTypes",{className:b.a.string,customer:b.a.shape($r.a.PropTypes)});var uo=n("97hE"),mo=n.n(uo);class po extends u.PureComponent{render(){var{customers:e}=this.props;return d.a.createElement(N.b,{className:mo.a.self,flex:"column"},e.map(e=>d.a.createElement(lo,{key:e.id,customer:e,className:mo.a.row})))}}l()(po,"propTypes",{customers:b.a.arrayOf(b.a.object)});var ho=n("W44r"),bo=n.n(ho);class fo extends u.PureComponent{render(){var{duplicatesCount:e}=this.props;return d.a.createElement(N.b,{className:bo.a.self},d.a.createElement(N.b,{className:bo.a.text},d.a.createElement(x.Text,{type:"fresha-h4",color:"gray100"},Object(C.g)("No duplicates found","%{duplicatesCount} duplicates found",e,{duplicatesCount:Object(Ar.f)(e)})),d.a.createElement(x.Text,{type:"fresha-caption",color:"gray50"},Object(C.f)("Merging combines appointments, sales and profile info of duplicated clients into one\n          client. <a>Learn more</a> about auto merging logic to make sure you understand implication as\n          this action cannot be undone.",null,{a:e=>d.a.createElement(x.Link,{inheritFont:!0,key:"link",linkTo:Rt.l},e)}))))}}l()(fo,"propTypes",{duplicatesCount:b.a.number});var go=n("XtQY"),Oo=n.n(go);function vo(){var e=v()(["Select All"]);return vo=function(){return e},e}class yo extends u.PureComponent{render(){var{customerMergeGroups:e,duplicatesCount:t,onSelectAllChange:n}=this.props,a=e.map(e=>({name:d.a.createElement(po,{key:e.id,customers:e.customers}),value:e.id}));return d.a.createElement(d.a.Fragment,null,d.a.createElement(fo,{duplicatesCount:t}),d.a.createElement(Ma.b,{shrink:0,className:Oo.a.self},d.a.createElement(x.ReduxForm.CheckBoxFieldArrayField,{name:ro,values:[{values:a,label:Object(C.c)(vo())}],onSelectAllChange:n,valign:"center-first"})))}}l()(yo,"propTypes",{customerMergeGroups:b.a.array,duplicatesCount:b.a.number,onSelectAllChange:b.a.func});var Eo,Co,jo,So,No=n("3vt+"),Ao=n.n(No);function Mo(){var e=v()(["Cancel"]);return Mo=function(){return e},e}function To(){var e=v()(["Confirm & Merge"]);return To=function(){return e},e}function Po(){var e=v()(["I understand client merging cannot be undone"]);return Po=function(){return e},e}function wo(){var e=v()(["Confirm Merge"]);return wo=function(){return e},e}var xo,ko,Io,Do=(Eo=Object(M.g)(),Object(m.f)(Co=Eo((So=jo=class extends u.PureComponent{constructor(...e){super(...e),l()(this,"state",{submitting:!1,confirmationChecked:!1}),l()(this,"handleClose",()=>{Object(j.b)(Ce.h)}),l()(this,"handleSubmit",()=>{this.state.submitting||(this.setState({submitting:!0}),this.props.handleSubmit())}),l()(this,"handleCheckboxChange",()=>{this.setState({confirmationChecked:!this.state.confirmationChecked})})}render(){var{isMatch:e}=this.props,{submitting:t,confirmationChecked:n}=this.state,{duplicatesCount:a}=this.props.match.params,r=d.a.createElement(x.Text,{type:"fresha-paragraph",className:Ao.a.description},Object(C.g)("Are you sure you want to merge %{duplicatesCount} duplicate? This action is permanent and cannot be undone.","Are you sure you want to merge %{duplicatesCount} duplicates? This action is permanent and cannot be undone.",a,{duplicatesCount:Object(Ar.f)(a)}));return d.a.createElement(he.i,{size:"small"},d.a.createElement(he.g,{onClose:this.handleClose,subheader:e&&r},Object(C.c)(wo())),d.a.createElement(he.c,{onlyBottomPadding:e},!e&&r,d.a.createElement(x.Form.BooleanField,{checked:this.state.confirmationChecked,onChange:this.handleCheckboxChange,label:Object(C.c)(Po()),noMargin:!e})),d.a.createElement(he.e,null,d.a.createElement(x.Button,{disabled:!n,isPending:t,variant:"primary",onAction:this.handleSubmit,className:Ao.a.button},Object(C.c)(To())),!e&&d.a.createElement(x.Button,{variant:"secondary",disabled:t,onAction:this.handleClose},Object(C.c)(Mo()))))}},l()(jo,"propTypes",{match:b.a.shape({params:b.a.shape({duplicatesCount:b.a.string})}),isMatch:b.a.bool,handleSubmit:b.a.func}),Co=So))||Co)||Co),Ro=n("XS4+"),Lo=n.n(Ro);function qo(){var e=v()(["Cancel"]);return qo=function(){return e},e}function Fo(){var e=v()(["Merge Selected"]);return Fo=function(){return e},e}function Bo(){var e=v()(["At least one group should be selected."]);return Bo=function(){return e},e}var Vo,Uo,_o,Go=Object(p.b)((e,t)=>{var{customerId:n}=t.match.params;return{customerId:n,customerMergeGroups:Re.a.getCustomerMergeGroupsList(e),initialValues:{[ro]:[]},formValues:ao(e),lastId:Re.a.getCustomerMergeGroupLastId(e)}},e=>({selectGroups:(t,n)=>{e(Object(A.L)("mergeCustomers",ro,[...new Set(t.concat(n))]))}}))(xo=Object(A.q)({form:"mergeCustomers",immutableProps:["customerMergeGroups"],validate:e=>({[ro]:0===e[ro].length&&Object(C.c)(Bo())})})(xo=Object(M.g)()((Io=ko=class extends u.PureComponent{constructor(...e){super(...e),l()(this,"state",{loading:!0,duplicatesCount:null,allGroupsLoaded:!1,selectAll:!0,submitting:!1}),l()(this,"onSelectAllChange",e=>{this.setState({selectAll:e})}),l()(this,"setModalContentRef",e=>{this.modalContentRef=e}),l()(this,"mergeCustomersGroups",()=>{S.a.customerMergeAuto(X.a.customerMergeAutoRequest(this.getRequestDataObject())).then(()=>Object(Rr.k)(Rt.i).then(()=>{Object(j.f)(Ce.d)})).catch(()=>{S.a.addGlobalWarningToast(Rt.a),Object(j.f)(Ce.d)})}),l()(this,"handleReadCustomerMergeGroupsListResponse",e=>{var{selectGroups:t,formValues:n}=this.props,{selectAll:a}=this.state,r=e.body.data;a&&t(n[ro],r.map(({id:e})=>e)),r.length<10&&this.setState({allGroupsLoaded:!0})}),l()(this,"handleCancel",()=>{Object(j.b)(Ce.d)}),l()(this,"loadMore",()=>{var{lastId:e}=this.props,{allGroupsLoaded:t}=this.state;return e&&!t?S.a.readCustomerMergeGroupsList({lastId:e}).then(this.handleReadCustomerMergeGroupsListResponse):Object(Gr.resolve)()}),l()(this,"submitForm",()=>{Object(Rr.o)(()=>{this.setState({submitting:!0}),S.a.customerMergeGroupsCountCustomers(X.a.customerMergeGroupsCountCustomersRequest(this.getRequestDataObject())).then(e=>{var t=E()(e,"body.meta.customersCount");Object(j.c)(Object(Ce.v)(t))}).finally(()=>{this.setState({submitting:!1})})})})}componentDidMount(){Object(Gr.all)([S.a.readCustomerMergeGroupsList().then(this.handleReadCustomerMergeGroupsListResponse),S.a.customerMergeGroupsCountCustomers(X.a.customerMergeGroupsCountCustomersRequest(this.getRequestDataObject())).then(e=>{var t=E()(e,"body.meta.customersCount");this.setState({duplicatesCount:t})})]).then(()=>{this.setState({loading:!1})})}componentWillUnmount(){S.a.removeCustomerMergeGroupsFromORM(),Object(Rr.l)()}getSkippedDuplicatesCount(){var{customerMergeGroups:e}=this.props,{selectAll:t,duplicatesCount:n}=this.state,{included:a,excluded:r}=this.getIncludedExcludedGroupsIdsObject(),o=t?r:a,i=e.filter(({id:e})=>o.includes(e)).reduce((e,t)=>e+t.customers.length,0);return t?i:n-i}getIncludedExcludedGroupsIdsObject(){var{formValues:e,customerMergeGroups:t}=this.props,n=e?e[ro]:[];return{included:n,excluded:Hr()(t.map(({id:e})=>e),n)}}getRequestDataObject(){var{customerMergeGroups:e}=this.props,{selectAll:t}=this.state,{included:n,excluded:a}=this.getIncludedExcludedGroupsIdsObject(),r=t?a:n,o=Math.max(...e.map(({id:e})=>parseInt(e,10)));return{toggledCustomerMergeGroupIds:r,selectedAll:t,customerMergeGroupMaxId:Zr()(o)?"".concat(o):null}}render(){var{customerMergeGroups:e,isMatch:t,valid:n}=this.props,{loading:a,duplicatesCount:r,submitting:o}=this.state,i=this.getSkippedDuplicatesCount(),s=null;s=a?d.a.createElement(Kr.a,{grow:1}):t?d.a.createElement(Xr.b,{key:"mobile",scrollComponent:this.modalContentRef,loadMore:this.loadMore},d.a.createElement(N.b,{className:Lo.a.overflowHidden},d.a.createElement(oo,{customerMergeGroups:e,onSelectAllChange:this.onSelectAllChange}))):d.a.createElement(Xr.b,{key:"desktop",loadMore:this.loadMore},d.a.createElement(yo,{duplicatesCount:r,customerMergeGroups:e,onSelectAllChange:this.onSelectAllChange}));var c=d.a.createElement(x.Button,{variant:"primary",isPending:o,disabled:!n,onAction:this.submitForm},Object(C.c)(Fo()));return d.a.createElement(Ta.a,{header:!a&&Object(C.c)("Merge %{duplicatesCount} duplicates",{duplicatesCount:t?Object(Ar.f)(r):""}),subheader:!a&&Object(C.f)("Merging combines appointments, sales and profile info of duplicated clients into one client. <a>Learn more</a> about auto merging logic to make sure you understand implication as this action cannot be undone.",null,{a:e=>d.a.createElement(x.Link,{inheritFont:!0,key:"link",linkTo:Rt.l},e)}),headerOnAction:this.handleCancel,footer:t?c:d.a.createElement(N.b,{flex:"row",justifyContent:"space-around",grow:1},d.a.createElement(N.b,{className:Lo.a.footer,flex:"row",alignItems:"center",justifyContent:"space-between",grow:1},i>0?d.a.createElement(x.Text,{type:"fresha-caption",color:"gray50"},Object(C.c)("%{skippedDuplicatesCount} duplicates skipped",{skippedDuplicatesCount:Object(Ar.f)(i)})):d.a.createElement(N.b,null),d.a.createElement(N.b,{flex:"row"},d.a.createElement(x.Button,{variant:"secondary",onAction:this.handleCancel,key:"cancel-button",className:Lo.a.cancelButton},Object(C.c)(qo())),c))),contentRef:this.setModalContentRef},s,d.a.createElement(m.b,{exact:!0,path:Ce.i,render:()=>d.a.createElement(Do,{handleSubmit:this.mergeCustomersGroups})}))}},l()(ko,"propTypes",{isMatch:b.a.bool,customerMergeGroups:b.a.array,valid:b.a.bool,lastId:b.a.string,selectGroups:b.a.func,formValues:b.a.object}),xo=Io))||xo)||xo)||xo,Yo=n("k8Y/"),Qo=n.n(Yo),zo=n("jwng"),Jo=Object(A.W)("mergeCustomers"),Zo={INITIAL_CUSTOMERS:"INITIAL_CUSTOMERS",MANUALLY_ADDED_CUSTOMERS:"MANUALLY_ADDED_CUSTOMERS"},Wo={[Zo.INITIAL_CUSTOMERS]:[],[Zo.MANUALLY_ADDED_CUSTOMERS]:[]};function Ho(){var e=v()(["Add another client"]);return Ho=function(){return e},e}function Xo(){var e=v()(["Manually Added"]);return Xo=function(){return e},e}function Ko(){var e=v()(["Select all"]);return Ko=function(){return e},e}function $o(e,t){return e.map(e=>{var{id:n}=e;return{name:d.a.createElement(no,{key:n,customer:e,hideDuplicatesCount:!0}),value:n,disabled:t===n}})}var ei,ti,ni,ai=Object(p.b)((e,t)=>({initialCustomers:Re.a.getCustomerMergeIdentitiesArray(e,t.initialCustomersIds),manuallyAddedCustomers:Re.a.getCustomerMergeIdentitiesArray(e,t.manuallyAddedCustomerIds)}))((_o=Uo=class extends u.PureComponent{render(){var e=this.props,{initialCustomers:t,manuallyAddedCustomers:n,mainCustomer:a}=e,r=wa()(e,["initialCustomers","manuallyAddedCustomers","mainCustomer"]);return d.a.createElement(d.a.Fragment,null,d.a.createElement(x.ReduxForm.CheckBoxFieldArrayField,s()({name:Zo.INITIAL_CUSTOMERS,values:[{label:Object(C.c)(Ko()),values:$o([a,...t],a.id)}],hideCount:!0,valign:"center"},r)),d.a.createElement(Cn.b,{label:Object(C.c)(Xo())}),d.a.createElement(x.ReduxForm.CheckBoxFieldArrayField,{name:Zo.MANUALLY_ADDED_CUSTOMERS,values:[{values:$o(n)}],hideSelectAll:!0,valign:"center"}),d.a.createElement(Xe.b,{grow:0,linkTo:Ce.B(a.id)},Object(C.c)(Ho())))}},l()(Uo,"propTypes",{initialCustomers:b.a.array,manuallyAddedCustomers:b.a.array,mainCustomer:b.a.object}),Vo=_o))||Vo;function ri(){var e=v()(["Add another client to merge"]);return ri=function(){return e},e}function oi(){var e=v()(["Select all"]);return oi=function(){return e},e}function ii(e,t){return e.map(e=>({name:d.a.createElement(lo,{key:e.id,customer:e}),value:e.id,disabled:t===e.id}))}var si,ci,li,ui=Object(p.b)((e,t)=>({initialCustomers:Re.a.getCustomerMergeIdentitiesArray(e,t.initialCustomersIds),manuallyAddedCustomers:Re.a.getCustomerMergeIdentitiesArray(e,t.manuallyAddedCustomerIds)}))((ni=ti=class extends u.PureComponent{render(){var e=this.props,{initialCustomers:t,mainCustomer:n,manuallyAddedCustomers:a,onSelectAllChange:r}=e,o=wa()(e,["initialCustomers","mainCustomer","manuallyAddedCustomers","onSelectAllChange"]);return d.a.createElement(d.a.Fragment,null,d.a.createElement(fo,{duplicatesCount:t.length+1}),d.a.createElement(Ma.b,{shrink:0,className:Oo.a.self},d.a.createElement(x.ReduxForm.CheckBoxFieldArrayField,s()({name:Zo.INITIAL_CUSTOMERS,values:[{label:Object(C.c)(oi()),values:ii([n,...t],n.id)}],onSelectAllChange:r,hideCount:!0,valign:"center"},o)),a.length>0&&d.a.createElement(d.a.Fragment,null,d.a.createElement(x.Text,{type:"fresha-h4",className:w()(Oo.a.hint,Oo.a.manuallyAddedCount)},Object(C.c)("%{count} Manually Added",{count:Object(Ar.f)(a.length)})),d.a.createElement(x.ReduxForm.CheckBoxFieldArrayField,{name:Zo.MANUALLY_ADDED_CUSTOMERS,values:[{values:ii(a)}],hideSelectAll:!0,className:Oo.a.marginBottom,valign:"center"})),d.a.createElement(x.Text,{type:"fresha-caption"},d.a.createElement(x.Link,{inheritFont:!0,linkTo:Ce.B(n.id),className:Oo.a.hint},d.a.createElement(x.Icon,{name:"plus",size:"14",color:"blue200"})," ",Object(C.c)(ri())))))}},l()(ti,"propTypes",{initialCustomers:b.a.array,manuallyAddedCustomers:b.a.array,mainCustomer:b.a.object,onSelectAllChange:b.a.func}),ei=ni))||ei,di=n("Cw5A");function mi(){var e=v()(["Search for Client"]);return mi=function(){return e},e}var pi,hi,bi,fi=Object(p.b)((e,t)=>{var{customerId:n}=t.match.params;return{customerId:n}},{})((li=ci=class extends u.PureComponent{constructor(...e){super(...e),l()(this,"state",{modalRef:null}),l()(this,"setModalRef",e=>{!e||this.state.modalRef&&this.state.modalRef===e||this.setState({modalRef:e})}),l()(this,"handleExit",()=>{var{customerId:e}=this.props;Object(j.b)(Ce.x(e))}),l()(this,"handleSetCustomer",e=>{this.props.addCustomer(e),this.handleExit()})}render(){var{ignoredCustomerIds:e}=this.props,{modalRef:t}=this.state;return d.a.createElement(he.i,{size:"small"},d.a.createElement(he.g,{onClose:this.handleExit},Object(C.c)(mi())),d.a.createElement(he.c,{selfRef:this.setModalRef,onlyBottomPadding:!0},t&&d.a.createElement(di.a,{grow:1,isOpen:!0,handleSetCustomer:this.handleSetCustomer,scrollableView:t,ignoredCustomerIds:e,stickySearch:!0})))}},l()(ci,"propTypes",{customerId:b.a.string,ignoredCustomerIds:b.a.arrayOf(b.a.string),addCustomer:b.a.func}),si=li))||si,gi=n("qPyV"),Oi=n.n(gi),vi=n("ahjf"),yi=n.n(vi);function Ei(){var e=v()(["Email"]);return Ei=function(){return e},e}function Ci(){var e=v()(["Mobile"]);return Ci=function(){return e},e}function ji(){var e=v()(["Client Name"]);return ji=function(){return e},e}var Si,Ni,Ai,Mi=Object(C.c)(ji()),Ti=Object(C.c)(Ci()),Pi=Object(C.c)(Ei()),wi=Object(M.g)()(pi=Object(A.q)({form:"client-details-form"})((bi=hi=class extends u.PureComponent{render(){var{selectOptions:e,isFresha:t}=this.props;return d.a.createElement(He.d,{type:"form modal mobile",flex:"column"},!We()(e.names)&&d.a.createElement(x.ReduxForm.SelectField,{disabled:t||1===e.names.length,hideInvalidLabel:!0,label:Mi,name:"name"},e.names.map(({id:e,name:t})=>d.a.createElement("option",{key:e,value:e},t))),!We()(e.contactNumbers)&&d.a.createElement(x.ReduxForm.SelectField,{disabled:t||1===e.contactNumbers.length,hideInvalidLabel:!0,label:Ti,name:"contactNumber"},e.contactNumbers.map(({id:e,contactNumber:t})=>d.a.createElement("option",{key:e,value:e},t))),!We()(e.emails)&&d.a.createElement(x.ReduxForm.SelectField,{disabled:t||1===e.emails.length,hideInvalidLabel:!0,label:Pi,name:"email"},e.emails.map(({id:e,email:t})=>d.a.createElement("option",{key:e,value:e},t))))}},l()(hi,"propTypes",{selectOptions:b.a.object,isFresha:b.a.bool}),pi=bi))||pi)||pi;function xi(){var e=v()(["Cancel"]);return xi=function(){return e},e}function ki(){var e=v()(["Merge & save"]);return ki=function(){return e},e}function Ii(){var e=v()(["Client Details"]);return Ii=function(){return e},e}function Di(){var e=v()(["Select which client details to set after merge:"]);return Di=function(){return e},e}var Ri,Li,qi,Fi=Object(A.W)("client-details-form"),Bi=Object(M.g)()(Si=Object(p.b)((e,t)=>({customers:Re.a.getCustomerMergeIdentitiesArray(e,t.customerIds,"updatedAt"),detailsFormValues:Fi(e)}))((Ai=Ni=class extends u.PureComponent{constructor(e){super(e),l()(this,"onConfirm",()=>{var{onConfirm:e,detailsFormValues:t,customers:n}=this.props;if(e){var{name:a,contactNumber:r,email:o}=t,i={};if(a){var s=n.find(e=>e.id===a);i.firstName=s.firstName,s.lastName&&(i.lastName=s.lastName)}if(r){var c=n.find(e=>e.id===r);i.contactNumber=c.contactNumber}if(o){var l=n.find(e=>e.id===o);i.email=l.email}return e(i)}return Object(Gr.resolve)()}),l()(this,"getSelectOptions",e=>{if(e){var{id:t,name:n,contactNumber:a,email:r}=e;return{names:[{id:t,name:n}],contactNumbers:a?[{id:t,contactNumber:a}]:[],emails:r?[{id:t,email:r}]:[]}}var{customers:o}=this.props,i=o.reduce((e,t)=>{var{name:n,contactNumber:a,email:r,id:o}=t;return e.names.push({id:o,name:n}),a&&e.contactNumbers.push({id:o,contactNumber:a}),r&&e.emails.push({id:o,email:r}),e},{names:[],contactNumbers:[],emails:[]});return i.names=Oi()(i.names,"name"),i.contactNumbers=Oi()(i.contactNumbers,"contactNumber"),i.emails=Oi()(i.emails,"email"),i}),l()(this,"goBack",()=>{Object(j.f)(j.a.location.pathname.replace("/details",""))});var{manuallyNavigated:t,customerIds:n}=this.props;t||Object(j.f)(Object(Ce.x)(n[0]))}render(){var{customers:e,customerIds:t,isMatch:n}=this.props,a=Object(C.c)(Di()),r=e.find(e=>e.isFresha),o=this.getSelectOptions(r),i={name:o.names.length?o.names[0].id:void 0,contactNumber:o.contactNumbers.length?o.contactNumbers[0].id:void 0,email:o.emails.length?o.emails[0].id:void 0};return d.a.createElement(he.i,{size:"small"},d.a.createElement(he.g,{onClose:this.goBack,subheader:n&&a,noBottomPadding:!0},Object(C.c)(Ii())),d.a.createElement(he.c,{onlyBottomPadding:!0},!n&&d.a.createElement(He.d,{type:"noBottomPadding modal mobile"},d.a.createElement(x.Text,{type:"fresha-paragraph",color:"gray50"},a)),d.a.createElement(wi,{initialValues:i,selectOptions:o,customers:e,isFresha:!!r}),d.a.createElement(He.d,{type:"mobile".concat(n?"":" sidePadding")},d.a.createElement(x.Text,{type:"fresha-paragraph",color:"gray50"},Object(C.f)("Other populated fields will be merged based on automated logic. Read more about\n                merging clients <a>here</a>.",{},{a:e=>d.a.createElement(x.Link,{inheritFont:!0,key:"link",linkTo:Rt.l},e)})),d.a.createElement(x.Text,{type:"fresha-paragraph",color:"gray50"},Object(C.c)("Are you sure you want to merge %{duplicates} duplicates? This action is permanent\n                and cannot be undone.",{duplicates:t.length})))),d.a.createElement(he.e,null,d.a.createElement(x.Button,{variant:"primary",onAction:this.onConfirm,withPending:!0,className:yi.a.grow},Object(C.c)(ki())),d.a.createElement(x.Button,{variant:"secondary",onAction:this.goBack,withPending:!0,className:yi.a.grow},Object(C.c)(xi()))))}},l()(Ni,"propTypes",{customers:b.a.arrayOf(b.a.object),isMatch:b.a.bool,onConfirm:b.a.func,detailsFormValues:b.a.object,customerIds:b.a.array.isRequired,manuallyNavigated:b.a.bool.isRequired}),Si=Ai))||Si)||Si,Vi=n("H1vZ"),Ui=n.n(Vi);function _i(){var e=v()(["Cancel"]);return _i=function(){return e},e}function Gi(){var e=v()(["Merge Selected"]);return Gi=function(){return e},e}function Yi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Qi(){var e=v()(["We couldn't load this customer, please try again later"]);return Qi=function(){return e},e}function zi(){var e=v()(["Clients merged"]);return zi=function(){return e},e}function Ji(){var e=v()(["At least one customer should be selected."]);return Ji=function(){return e},e}var Zi,Wi,Hi,Xi=Object(p.b)((e,t)=>{var{customerId:n}=t.match.params;return{mainCustomer:Object(je.a)(e,n),customerId:n,formValues:Jo(e),initialValues:Wo}},e=>({selectInitialCustomers:t=>{e(Object(A.L)("mergeCustomers",Zo.INITIAL_CUSTOMERS,t))},selectAddedCustomer:t=>{e(Object(A.L)("mergeCustomers",Zo.MANUALLY_ADDED_CUSTOMERS,t))}}))(Ri=Object(A.q)({form:"mergeCustomers",validate:e=>{var t=[...e[Zo.INITIAL_CUSTOMERS],...e[Zo.MANUALLY_ADDED_CUSTOMERS]];return{[Zo.INITIAL_CUSTOMERS]:1===t.length&&Object(C.c)(Ji())}}})(Ri=Object(M.g)()((qi=Li=class extends u.PureComponent{constructor(...e){super(...e),l()(this,"state",{loading:!0,initialCustomersIds:[],manuallyAddedCustomerIds:[],hasFreshaClient:!1,manuallyNavigated:!1}),l()(this,"onSelectAllChange",e=>{var{manuallyAddedCustomerIds:t}=this.state;this.props.selectAddedCustomer(e?t:[])}),l()(this,"mergeCustomersGroups",e=>{var{mainCustomer:t}=this.props;return S.a.customerMergeManual(X.a.customerMergeManualRequestFromForm(this.getRequestDataObject(e))).then(e=>{var t=E()(e,"body.data.id");S.a.addGlobalSuccessToast(Object(C.c)(zi())),Object(j.f)(t?Object(Ce.s)(t):Ce.d)}).catch(e=>{throw Object(j.f)(Object(Ce.s)(t.id)),S.a.addGlobalErrorToast(),new Error(e)})}),l()(this,"addCustomer",e=>{Object(Rr.i)(e,{include:"customer-payment-method"}).then(t=>{var n=E()(t,"body.data.attributes.isFresha");if(this.state.hasFreshaClient&&n)S.a.addGlobalErrorToast("You cannot merge two Fresha clients together.");else{var a=[...this.state.manuallyAddedCustomerIds,e];this.setState({manuallyAddedCustomerIds:a,hasFreshaClient:this.state.hasFreshaClient||n},()=>{var t=[...this.props.formValues[Zo.MANUALLY_ADDED_CUSTOMERS],e];this.props.selectAddedCustomer(t),S.a.createCustomerMergeIdentity(e)})}}).catch(()=>{S.a.addGlobalErrorToast(Object(C.c)(Qi()))})}),l()(this,"handleCancel",()=>{var{customerId:e}=this.props;Object(j.f)(Object(Ce.s)(e))}),l()(this,"submitForm",()=>{var{customerId:e}=this.props;this.setState({manuallyNavigated:!0}),Object(j.f)(Object(Ce.y)(e))})}componentDidMount(){var{customerId:e}=this.props;Object(Gr.all)([Object(Rr.i)(e,{include:"customer-payment-method"}),S.a.readCustomerDuplicates(e)]).then(([,{body:{data:t}}])=>{var{selectInitialCustomers:n,mainCustomer:a}=this.props;if(a.deletedAt)Object(j.f)(Ce.d);else{var r=Qo()(t,e=>Object(zo.k)(e.attributes.updatedAt),"desc").map(({id:e})=>e),o=!!t.find(e=>e.attributes.isFresha)||a&&a.isFresha;n([e,...r]),this.setState({initialCustomersIds:r,hasFreshaClient:o,loading:!1}),S.a.createCustomerMergeIdentity(e)}}).catch(()=>{S.a.addGlobalErrorToast(),Object(j.f)(Ce.d)})}getRequestDataObject(e){var{formValues:t}=this.props,{[Zo.INITIAL_CUSTOMERS]:n,[Zo.MANUALLY_ADDED_CUSTOMERS]:a}=t;return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yi(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({customerIds:[...n,...a]},e)}render(){var{isMatch:e,valid:t,formValues:n,mainCustomer:a}=this.props,{loading:r,initialCustomersIds:o,manuallyAddedCustomerIds:i,manuallyNavigated:c}=this.state,l=null;if(r)l=d.a.createElement(Kr.a,{grow:1});else{var u=[...n[Zo.INITIAL_CUSTOMERS],...n[Zo.MANUALLY_ADDED_CUSTOMERS]],p=[a.id,...o,...i],h=Object(Lr.c)(u,p),b=u.length>1;l=e?d.a.createElement(ai,{selectAllIcon:h,isAllSelected:b,mainCustomer:a,initialCustomersIds:o,onSelectAllChange:this.onSelectAllChange,manuallyAddedCustomerIds:i}):d.a.createElement(ui,{selectAllIcon:h,isAllSelected:b,mainCustomer:a,initialCustomersIds:o,onSelectAllChange:this.onSelectAllChange,manuallyAddedCustomerIds:i})}return d.a.createElement(Ta.a,{header:!r&&Object(C.c)("Merge %{duplicates} duplicates",{duplicates:e?o.length+1:""}),subheader:r?"":Object(C.f)("Merging combines appointments, sales and profile info of duplicated clients into one\n          client. <a>Learn more</a> about auto merging logic to make sure you understand implication as\n          this action cannot be undone.",null,{a:e=>d.a.createElement(x.Link,{key:"link",inheritFont:!0,linkTo:Rt.l},e)}),headerOnAction:this.handleCancel,footer:[d.a.createElement(x.Button,{variant:"primary",disabled:!t,onAction:this.submitForm},Object(C.c)(Gi())),!e&&d.a.createElement(x.Button,{variant:"secondary",onAction:this.handleCancel,key:"cancel-button",className:Ui.a.cancelButton},Object(C.c)(_i()))]},l,d.a.createElement(m.b,{exact:!0,path:Ce.o,render:e=>!r&&d.a.createElement(fi,s()({ignoredCustomerIds:[a.id,...o,...i],addCustomer:this.addCustomer},e))}),d.a.createElement(m.b,{exact:!0,path:Ce.l,render:e=>!r&&d.a.createElement(Bi,s()({manuallyNavigated:c,customerIds:[...n[Zo.INITIAL_CUSTOMERS],...n[Zo.MANUALLY_ADDED_CUSTOMERS]],onConfirm:this.mergeCustomersGroups},e))}))}},l()(Li,"propTypes",{customerId:b.a.string,isMatch:b.a.bool,valid:b.a.bool,selectInitialCustomers:b.a.func,selectAddedCustomer:b.a.func,formValues:b.a.object,detailsFormValues:b.a.object,mainCustomer:b.a.object}),Ri=qi))||Ri)||Ri)||Ri,Ki=Object(p.b)(null,{destroyClientForm:()=>Object(A.N)("clientForm")})((Hi=Wi=class extends u.Component{componentWillUnmount(){var{destroyClientForm:e}=this.props;e&&e()}render(){return d.a.createElement(d.a.Fragment,null,d.a.createElement(m.d,null,d.a.createElement(m.b,{path:Ce.a,component:_r}),d.a.createElement(m.b,{path:Ce.f,render:e=>d.a.createElement(f.b,{keys:g.a.CAN_SEE_CUSTOMER_DETAILS,withPlaceholder:!0},d.a.createElement(zr,e))}),d.a.createElement(m.b,{path:Ce.h,render:e=>d.a.createElement(f.b,{keys:[g.a.CUSTOMERS,g.a.CAN_SEE_CUSTOMER_DETAILS],withPlaceholder:!0},d.a.createElement(Go,e))}),d.a.createElement(m.b,{path:Ce.k,render:e=>d.a.createElement(f.b,{keys:[g.a.CUSTOMERS,g.a.CAN_SEE_CUSTOMER_DETAILS],withPlaceholder:!0},d.a.createElement(Xi,e))}),d.a.createElement(m.b,{path:Ce.e,render:e=>d.a.createElement(f.b,s()({},Rt.j,{withPlaceholder:!0}),d.a.createElement(Pr.a,e))}),d.a.createElement(m.b,{path:Ce.d,render:e=>d.a.createElement(f.b,s()({},Rt.j,{withPlaceholder:!0}),d.a.createElement(Tr.a,e))})),d.a.createElement(m.b,{exact:!0,path:Ce.j,component:Mr}))}},l()(Wi,"propTypes",{destroyClientForm:b.a.func}),Zi=Hi))||Zi},A392:function(e,t,n){"use strict";n.d(t,"a",(function(){return X}));var a,r,o,i,s,c,l=n("VkAN"),u=n.n(l),d=n("lSNA"),m=n.n(d),p=n("q1tI"),h=n.n(p),b=n("17x9"),f=n.n(b),g=n("TSYQ"),O=n.n(g),v=n("/MKj"),y=n("yvsu"),E=n("nbpM"),C=n("yk2N"),j=n("ePPS"),S=n("Jje6"),N=n("Qs7Y"),A=n("ILTB"),M=n.n(A),T=n("pVnL"),P=n.n(T),w=n("QILm"),x=n.n(w),k=n("nIiI"),I=n("TJnl"),D=n("PhEd"),R=n("Vows"),L=n("dhJQ"),q=Object(L.g)()(a=Object(v.b)(e=>({isReshedulEnabled:E.a.isReshedulEnabled(e)}))((o=r=class extends p.PureComponent{render(){var e=this.props,{className:t,label:n,isMatch:a,primaryValue:r,secondaryValue:o,description:i,qaType:s,isReshedulEnabled:c}=e,l=x()(e,["className","label","isMatch","primaryValue","secondaryValue","description","qaType","isReshedulEnabled"]),u=o&&r!==o,d="".concat(r).concat(u?" *":"");return a?h.a.createElement(R.e,{className:t,label:n,value:d,description:i}):h.a.createElement(S.b,P()({className:O()(t,M.a.infoRow),qaType:s},l),c?h.a.createElement(D.Text,{type:"fresha-caption",color:"gray50"},n):h.a.createElement(N.d,{type:"body-2"},n),c?h.a.createElement(D.Text,{qaType:"".concat(s,"-content"),type:"fresha-paragraph",color:"gray100"},d):h.a.createElement(N.d,{qaType:"".concat(s,"-content"),type:"form-field-content"},d),i&&h.a.createElement(N.d,{className:M.a.description,qaType:"".concat(s,"-description"),type:"helper"},i))}},m()(r,"propTypes",{className:f.a.string,label:f.a.string,primaryValue:f.a.string,secondaryValue:f.a.string,qaType:f.a.string,description:f.a.string,isMatch:f.a.bool,isReshedulEnabled:f.a.bool}),a=o))||a)||a;function F(){var e=u()(["Doesn’t accept marketing notifications"]);return F=function(){return e},e}function B(){var e=u()(["Accepts marketing notifications"]);return B=function(){return e},e}function V(){var e=u()(["Marketing notifications"]);return V=function(){return e},e}class U extends p.PureComponent{render(){var e=this.props,{acceptsMarketingNotifications:t,consentLog:n}=e,a=x()(e,["acceptsMarketingNotifications","consentLog"]);return h.a.createElement(q,P()({label:Object(j.c)(V()),primaryValue:t?Object(j.c)(B()):Object(j.c)(F()),description:n?Object(j.c)("%{name} updated this setting on %{date}",{name:n.name,date:h.a.createElement(k.a,{key:"consent-log",date:n.date,dateFormat:I.b})}):void 0},a))}}function _(){var e=u()(["Do not ask to confirm appointments with card"]);return _=function(){return e},e}function G(){var e=u()(["Ask to confirm appointments with card"]);return G=function(){return e},e}function Y(){var e=u()(["Cancellation policy"]);return Y=function(){return e},e}function Q(){var e=u()(["Gender"]);return Q=function(){return e},e}function z(){var e=u()(["Date of Birth"]);return z=function(){return e},e}function J(){var e=u()(["Address"]);return J=function(){return e},e}function Z(){var e=u()(["Email"]);return Z=function(){return e},e}function W(){var e=u()(["Telephone"]);return W=function(){return e},e}function H(){var e=u()(["Mobile"]);return H=function(){return e},e}m()(U,"propTypes",{acceptsMarketingNotifications:f.a.bool,consentLog:f.a.shape({name:f.a.string,date:f.a.string})});var X=Object(v.b)((e,t)=>{var n=t.client.id;return{consentLog:E.a.getCustomerMarketingConsentLog(e,n),isMarketplaceAppointmentConfirmationUsable:E.a.isMarketplaceAppointmentConfirmationUsable(e)}})((c=s=class extends p.PureComponent{render(){var{className:e,client:t,isMarketplaceAppointmentConfirmationUsable:n,client:{address:a,area:r,birthdayDay:o,birthdayMonth:i,birthdayYear:s,city:c,contactNumber:l,email:u,gender:d,acceptsMarketingNotifications:m,marketplaceAppointmentConfirmationEnabled:p,postCode:b,state:f,telephone:g,hasOverriddenOnlineProfile:v},consentLog:y}=this.props,E=t.onlineProfile||{},A=Object(C.a)(o,i,s),T=[a,r,c,f,b].filter(e=>e);return h.a.createElement(S.b,{className:O()(M.a.self,e)},l&&h.a.createElement(q,{qaType:"client-contact-number",label:Object(j.c)(H()),primaryValue:l,secondaryValue:E.contactNumber}),g&&h.a.createElement(q,{label:Object(j.c)(W()),primaryValue:g}),u&&h.a.createElement(q,{qaType:"client-email",label:Object(j.c)(Z()),primaryValue:u,secondaryValue:E.email}),T.length>0&&h.a.createElement(q,{qaType:"client-address",label:Object(j.c)(J()),primaryValue:T.join("\n")}),A&&h.a.createElement(q,{label:Object(j.c)(z()),primaryValue:A}),d&&h.a.createElement(q,{qaType:"client-gender",label:Object(j.c)(Q()),primaryValue:d,className:M.a.gender}),h.a.createElement(U,{qaType:"marketing-consent",acceptsMarketingNotifications:m,consentLog:y}),n&&h.a.createElement(q,{qaType:"confirm-with-card",label:Object(j.c)(Y()),primaryValue:p?Object(j.c)(G()):Object(j.c)(_())}),v&&h.a.createElement(N.d,{type:"body-2",className:O()(M.a.legend,M.a.infoRow)},Object(j.c)("* Contact info is different to Fresha online booking profile: %{name}",{name:[E.firstName,E.lastName].filter(Boolean).join(" ")})))}},m()(s,"propTypes",{className:f.a.string,isMarketplaceAppointmentConfirmationUsable:f.a.bool,client:f.a.shape({address:f.a.string,area:f.a.string,birthdayDay:f.a.number,birthdayMonth:f.a.number,birthdayYear:f.a.number,city:f.a.string,contactNumber:f.a.string,displayNote:f.a.bool,email:f.a.string,firstName:f.a.string,name:f.a.string,acceptsMarketingNotifications:f.a.bool,marketplaceAppointmentConfirmationEnabled:f.a.bool,postCode:f.a.string,state:f.a.string,telephone:f.a.string,gender:f.a.string,hasOverriddenOnlineProfile:f.a.bool,onlineProfile:f.a.object}).isRequired,consentLog:f.a.shape(y.a.propTypes)}),i=c))||i},AQgK:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a,r,o,i=n("pVnL"),s=n.n(i),c=n("QILm"),l=n.n(c),u=n("lSNA"),d=n.n(u),m=n("VkAN"),p=n.n(m),h=n("q1tI"),b=n.n(h),f=n("/MKj"),g=n("17x9"),O=n.n(g),v=n("nbpM"),y=n("ePPS"),E=n("jwng"),C=n("yk2N"),j=n("478R"),S=n("Jje6"),N=n("7shN"),A=n.n(N);function M(){var e=p()(["Blocked"]);return M=function(){return e},e}function T(){var e=p()(["Deleted"]);return T=function(){return e},e}function P(){var e=p()(["New Client"]);return P=function(){return e},e}var w={new_customer:{badgeType:"info",formatText:()=>Object(y.c)(P())},deleted_customer:{badgeType:"danger",formatText:()=>Object(y.c)(T())},no_show_appointments:{badgeType:"danger",formatText:({count:e})=>Object(y.g)("%{count} No Show","%{count} No Shows",e,{count:e})},unpaid:{badgeType:"warning",formatText:({amount:e},{currencyCode:t})=>Object(y.c)("%{amount} Unpaid",{amount:Object(C.h)(e,{currencyCode:t})})},birthday:{badgeType:"info",formatText:({date:e})=>Object(y.c)("Birthday %{date}",{date:Object(C.d)(Object(E.k)(e),"day_of_year_short")})},blocked_customer:{badgeType:"danger",formatText:()=>Object(y.c)(M())}},x=Object(f.b)(e=>({currencyCode:v.a.getCurrencyCode(e)}),{})((o=r=class extends h.PureComponent{render(){var e=this.props,{customer:t,currencyCode:n}=e,a=l()(e,["customer","currencyCode"]);return b.a.createElement(S.b,s()({qaType:"customer-badges"},a),t.labels.map(e=>{var t=e,a=w[t.label];return null!=a?b.a.createElement(j.b,{key:t.label,className:A.a.badge,type:a.badgeType,qaType:"badge-".concat(t.label)},a.formatText(t,{currencyCode:n})):null}))}},d()(r,"propTypes",{customer:O.a.shape({labels:O.a.array}),currencyCode:O.a.string}),a=o))||a},Cw5A:function(e,t,n){"use strict";var a=n("tnX3");n.d(t,"b",(function(){return a.a}));var r=n("nDSK");n.d(t,"a",(function(){return r.a})),n.d(t,"c",(function(){return r.b}));n("REKf"),n("5XOi")},DTlD:function(e,t,n){"use strict";n.d(t,"a",(function(){return J}));var a=n("pVnL"),r=n.n(a),o=n("QILm"),i=n.n(o),s=n("lSNA"),c=n.n(s),l=n("mwIZ"),u=n.n(l),d=n("q1tI"),m=n.n(d),p=n("17x9"),h=n.n(p),b=n("TSYQ"),f=n.n(b),g=n("5ZU+"),O=n("XOuL"),v=n("Jje6"),y=n("ZO1O"),E=n("t2yh"),C=n("VkAN"),j=n.n(C),S=n("/MKj"),N=n("PhEd"),A=n("nbpM"),M=n("TIN1"),T=n("ePPS"),P=n("yk2N"),w=n("Qs7Y"),x=n("YjeW"),k=n.n(x);class I extends d.PureComponent{render(){var e=this.props,{className:t,length:n}=e,a=i()(e,["className","length"]);return m.a.createElement(v.b,r()({as:"span",className:f()(k.a.fill,t)},a)," ".repeat(2*n))}}c()(I,"propTypes",{className:h.a.string,length:h.a.number}),c()(I,"defaultProps",{length:2});var D,R,L,q=n("dhJQ"),F=n("QJNd"),B=n.n(F);function V(){var e=j()(["Total Sales"]);return V=function(){return e},e}function U(){var e=j()(["Total Bookings"]);return U=function(){return e},e}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Y=Object(q.g)()(D=Object(S.b)((e,t)=>{var n,{customerId:a}=t,r=!1;if(null!=a&&(n=A.a.getCustomerStatistic(e,a),r=Boolean(n))){var{currencyCode:o}=A.a.getProvider(e),i={currencyCode:o},{totalSales:s}=n;n=G(G({},n),{},{totalSales:Object(P.h)(s,i)})}return{statistics:n,hasStatistics:r,customerId:a,isReshedulEnabled:A.a.isReshedulEnabled(e)}},{})((L=R=class extends d.PureComponent{constructor(...e){super(...e),c()(this,"renderSummaryText",(e,t)=>{var n,{isReshedulEnabled:a,isMatch:r}=this.props;return r?m.a.createElement(w.d,{as:"span",type:e},t):a?m.a.createElement(N.Text,"section-header"===(n=e)?{type:"fresha-h3",color:"gray100"}:"body-1"===n?{type:"fresha-caption",color:"gray50"}:{},t):t})}render(){var e=this.props,{children:t,className:n,customerId:a,hasStatistics:o,statistics:s,isMatch:c}=e,l=i()(e,["children","className","customerId","hasStatistics","statistics","isMatch"]);return m.a.createElement(v.b,r()({className:f()(B.a.self,n),flex:"row",shrink:0},l),m.a.createElement(v.b,{className:B.a.total},m.a.createElement(v.b,{className:B.a.value,qaType:"bookings-count"},o?this.renderSummaryText("section-header",s.bookingsCount):m.a.createElement(I,{length:6})),this.renderSummaryText("body-1",Object(T.c)(U()))),m.a.createElement(v.b,{className:B.a.total},m.a.createElement(v.b,{className:B.a.value,qaType:"total-sales"},o?this.renderSummaryText("section-header",s.totalSales):m.a.createElement(I,{length:12})),this.renderSummaryText("body-1",Object(T.c)(V()))),t)}},c()(R,"propTypes",{children:h.a.node,className:h.a.string,customerId:h.a.string.isRequired,hasStatistics:h.a.bool,statistics:h.a.shape(M.a.propTypes),isMatch:h.a.bool,isReshedulEnabled:h.a.bool}),D=L))||D)||D,Q=n("j7jY"),z=n.n(Q);class J extends d.PureComponent{constructor(...e){super(...e),c()(this,"state",{isLoading:!1}),c()(this,"loadData",e=>{this.setState({isLoading:!0}),g.a.readCustomerStatistics(e).finally(()=>{this.setState({isLoading:!1})})})}componentDidMount(){var{customer:{id:e}}=this.props;this.loadData(e)}UNSAFE_componentWillReceiveProps(e){var t=u()(this.props,"customer.id"),n=u()(e,"customer.id");t!==n&&this.loadData(n)}render(){var e=this.props,{children:t,className:n,customer:{id:a}}=e,o=i()(e,["children","className","customer"]),{isLoading:s}=this.state;return m.a.createElement(O.a,r()({className:f()(n,z.a.self,z.a.columnFlex),flex:"column"},o,{if:s,childrenClassName:z.a.columnFlex}),m.a.createElement(Y,{as:y.d,type:"mobile",className:z.a.section,customerId:a}),m.a.createElement(v.b,{className:z.a.tabs,flex:"column",grow:1},m.a.createElement(E.a,{clientId:a})),t)}}c()(J,"propTypes",{children:h.a.node,className:h.a.string,customer:h.a.object})},"F/Zl":function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n("lSNA"),r=n.n(a),o=n("q1tI"),i=n.n(o),s=n("17x9"),c=n.n(s);class l extends i.a.Component{constructor(e){super(e),this.containerEl=document.querySelector("header .sidebar__toggle.visible-mobile .page-title"),this.setTopNavigationText=this.setTopNavigationText.bind(this)}componentDidMount(){this.setTopNavigationText()}componentDidUpdate(){this.setTopNavigationText()}setTopNavigationText(){this.containerEl instanceof HTMLElement&&(this.containerEl.textContent=this.props.text)}render(){return null}}r()(l,"propTypes",{text:c.a.string.isRequired})},IJve:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n("VkAN"),r=n.n(a),o=n("lSNA"),i=n.n(o),s=n("q1tI"),c=n.n(s),l=n("17x9"),u=n.n(l),d=n("PhEd"),m=n("TSYQ"),p=n.n(m),h=n("ePPS"),b=n("3wSE"),f=n("uopA"),g=(n("TSDZ"),n("8TPp"),n("dsWg")),O=n("D2FV"),v=n.n(O);function y(){var e=r()(["New Client"]);return y=function(){return e},e}function E(){var e=r()(["You do not have any clients yet, create new clients\n          manually or import your full list at once"]);return E=function(){return e},e}function C(){var e=r()(["No Clients"]);return C=function(){return e},e}class j extends s.PureComponent{render(){var{toggleImportModal:e}=this.props;return c.a.createElement(f.a,{icon:"no-clients",name:Object(h.c)(C()),text:Object(h.c)(E())},c.a.createElement(b.d,null,!1,c.a.createElement(d.Button,{variant:"primary",linkTo:g.a,qaType:"new-client-button",className:p()(v.a.grow,v.a.marginLeft)},Object(h.c)(y()))))}}i()(j,"propTypes",{toggleImportModal:u.a.func})},ITHA:function(e,t,n){"use strict";n.d(t,"e",(function(){return y})),n.d(t,"c",(function(){return E})),n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return q})),n.d(t,"d",(function(){return U}));var a=n("QILm"),r=n.n(a),o=n("lSNA"),i=n.n(o),s=n("q1tI"),c=n.n(s),l=n("17x9"),u=n.n(l),d=n("TSYQ"),m=n.n(d),p=n("FAYg"),h=n("sF8u"),b=n("OEHH"),f=n.n(b),g=Object(h.a)(f.a.slideChildren),O=n("l22p"),v=n.n(O);class y extends s.PureComponent{render(){var e,t=this.props,{className:n,children:a}=t,o=r()(t,["className","children"]);return!p.DISABLE_QA_TYPE&&o.qaType&&({qaType:e}=o),c.a.createElement("ul",{"data-qa":e,className:m()(v.a.self,n)},a)}}i()(y,"propTypes",{className:u.a.string,qaType:u.a.string,children:u.a.node.isRequired});var E=g(y),C=n("pVnL"),j=n.n(C),S=n("Puqe"),N=n.n(S),A=n("fJus"),M=n("jLFJ"),T=n("Jje6"),P=n("RLZt"),w=n.n(P),x=["isDisabled","isPending","isComplete","onAction"],k=e=>{var{secondaryActionClassName:t,secondaryAction:n,isActive:a,isHover:o,className:i,children:s,color:l}=e,u=r()(e,["secondaryActionClassName","secondaryAction","isActive","isHover","className","children","color"]),d=m()(w.a.self,{[w.a.hover]:o&&!u.disabled,[w.a.active]:a,[w.a.color]:l,[w.a["color-".concat(l)]]:l},i);return c.a.createElement(T.b,j()({as:"li",className:d},N()(u,x)),c.a.createElement("div",{className:w.a.label},s),n&&c.a.createElement("div",{className:m()(w.a.secondaryAction,t)},n))};k.propTypes={secondaryActionClassName:u.a.string,secondaryAction:u.a.node,className:u.a.string,disabled:u.a.bool,isActive:u.a.bool,isHover:u.a.bool,isPending:u.a.bool,isComplete:u.a.bool,onAction:u.a.func,children:u.a.node,color:u.a.oneOf(Object(A.f)(w.a,"color-"))};var I=Object(M.d)(k),D=n("Z5Oz"),R=n.n(D),L=e=>{var{children:t}=e;return c.a.createElement(T.b,{as:"li",className:R.a.self},c.a.createElement(T.b,null,t))};L.propTypes={children:u.a.node};var q=L,F=n("DoZe"),B=n.n(F),V=({children:e})=>c.a.createElement("span",{className:B.a.self},e);V.propTypes={children:u.a.node.isRequired};var U=V},JBi0:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return Y}));var a,r,o,i=n("pVnL"),s=n.n(i),c=n("lSNA"),l=n.n(c),u=n("VkAN"),d=n.n(u),m=n("q1tI"),p=n.n(m),h=n("17x9"),b=n.n(h),f=n("5ZU+"),g=n("ePPS"),O=n("3Fcl"),v=n("X67z"),y=n("Jje6"),E=n("kZhr"),C=n("TSDZ"),j=n("dhJQ"),S=n("x81N"),N=n("8TPp"),A=n("qGVk"),M=n("/pl8"),T=n("MDPv"),P=n("DuVZ"),w=n("1UfZ"),x=n("/ddM"),k=n.n(x);function I(){var e=d()(["Search by name, e-mail or mobile number"]);return I=function(){return e},e}function D(){var e=d()(["Merge Clients"]);return D=function(){return e},e}function R(){var e=d()(["Import Clients"]);return R=function(){return e},e}function L(){var e=d()(["We couldn't generate this report at the moment. Try again later."]);return L=function(){return e},e}function q(){var e=d()(["Options"]);return q=function(){return e},e}function F(){var e=d()(["Download CSV"]);return F=function(){return e},e}function B(){var e=d()(["Download Excel"]);return B=function(){return e},e}var V=[{id:S.a.XLSX,format:S.a.XLSX,label:Object(g.c)(B())},{id:S.a.CSV,format:S.a.CSV,label:Object(g.c)(F())}],U={icon:C.f.ICON.OPTIONS},_={label:Object(g.c)(q())},G=[v.a.CAN_SEE_CUSTOMER_DETAILS,v.a.DOWNLOAD_CUSTOMERS],Y=Object(E.q)({form:"clientListFilter"})(a=Object(j.g)()((o=r=class extends m.PureComponent{constructor(...e){super(...e),l()(this,"state",{isCompleted:!1}),l()(this,"handleQueryChange",Object(O.a)(()=>{this.props.submit()},{debounce:!0,interval:50}))}getExportConfig(){return{type:P.h,start:w.f,status:w.g,complete:t=>{Object(T.a)(t).then(()=>{this.setState({isCompleted:!0}),e.setTimeout(()=>{this.setState({isCompleted:!1})},1e3)})},error:()=>{f.a.addGlobalErrorToast(Object(g.c)(L()))}}}renderOptionsDropdown(e,t,n){var{toggleImportModal:a,handleMergeCustomer:r,isMatch:o}=this.props,{isCompleted:i}=this.state,c=e||o?C.f:C.g,l=e||o?U:_;return p.a.createElement(M.b,{keys:G},e=>p.a.createElement(c,s()({align:"right",isPending:n,disabled:n,isComplete:i,qaType:"mobile-clients-dropdown"},l),V.map(({id:n,format:a,label:r})=>p.a.createElement(C.c,{key:n,onAction:Object(M.c)(e.downloadCustomers,t(a))},r)),p.a.createElement(C.c,{onAction:a},Object(g.c)(R())),p.a.createElement(C.c,{onAction:Object(M.c)(e.canSeeCustomerDetails,r)},Object(g.c)(D()))))}render(){var{isMatch:e,menuActions:t}=this.props;return p.a.createElement(y.b,{flex:"row",className:k.a.self},p.a.createElement(E.l,{name:"query",placeholder:Object(g.c)(I()),basis:e?void 0:384,shrink:1,grow:1,className:k.a.search,onChange:this.handleQueryChange}),!e&&p.a.createElement(y.b,{grow:1,shrink:1}),p.a.createElement(S.c,{config:this.getExportConfig()},({enqueue:e,isPending:t})=>p.a.createElement(N.b,{position:"right"},n=>this.renderOptionsDropdown(n,e,t))),p.a.createElement(A.a,{actions:t,hideOnMobile:!0,className:k.a.filterButton}))}},l()(r,"propTypes",{isMatch:b.a.bool,submit:b.a.func.isRequired,toggleImportModal:b.a.func,handleMergeCustomer:b.a.func,menuActions:b.a.arrayOf(b.a.object).isRequired}),a=o))||a)||a}).call(this,n("yLpj"))},JraT:function(e,t,n){"use strict";var a=n("zg6z");n.d(t,"a",(function(){return a.a}))},NgSR:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n("17x9"),r=n("9df5"),o=Object(a.shape)({label:a.string.isRequired,date:a.string,count:a.number,amount:a.number}),i=Object(a.shape)({id:a.string.isRequired,name:a.string,contactNumber:a.string,displayNote:a.bool,labels:Object(a.arrayOf)(o),note:a.string,email:a.string,avatar:Object(a.shape)(r.a)})},REKf:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l}));var a=n("mwIZ"),r=n.n(a),o=n("kZhr"),i="checkout-customer-search",s="searchString",c=Object(o.W)(i),l=e=>r()(c(e),s)||""},SUXa:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return G}));var a,r,o,i=n("VkAN"),s=n.n(i),c=n("9oTK"),l=n("lSNA"),u=n.n(l),d=n("mwIZ"),m=n.n(d),p=n("q1tI"),h=n.n(p),b=n("/MKj"),f=n("17x9"),g=n.n(f),O=n("Ty5D"),v=n("TSYQ"),y=n.n(v),E=n("XOD0"),C=n("5ZU+"),j=n("ePPS"),S=n("L8xJ"),N=n("Jje6"),A=n("aAma"),M=n("eTjC"),T=n("dhJQ"),P=n("rb4H"),w=n("8TPp"),x=n("fGW6"),k=n("tYzA"),I=n("yvcj"),D=n("n8CV"),R=n("zYuS"),L=n("dsWg"),q=n("1UfZ"),F=n("W59S"),B=n("wsJH"),V=n.n(B);function U(){var e=s()(["Client Profile"]);return U=function(){return e},e}function _(){var e=s()(["Profile"]);return _=function(){return e},e}var G=Object(T.g)()(a=Object(b.b)((e,t)=>{var n=t.match.params.id;return{client:Object(F.a)(e,n),clientId:n}},{})((o=r=class extends p.PureComponent{constructor(...t){super(...t),u()(this,"state",{loading:!0,error:!1,barVisible:!1}),u()(this,"fetchData",()=>{var{clientId:e}=this.props;Object(c.all)([C.a.bulk([[C.a.readCustomerStatistics,e],[C.a.readCustomerBookings,e,{limit:1}],[C.a.readCustomerMarketingConsentLog,e],C.a.readLocationList,C.a.readNoShowSettings,[C.a.readCustomerDuplicatesCheck,e]]),Object(q.i)(e,{include:"customer-payment-method"})]).then(([[,,,,e]])=>{this.setState({barVisible:m()(e,"body.meta.duplicates-check"),loading:!1,error:!1})}).catch(e=>{this.setState({loading:!1,error:e})})}),u()(this,"retryFetch",()=>{e.location.reload(!0)}),u()(this,"handleMergeCustomer",()=>{Object(E.f)(L.x(this.props.clientId))}),u()(this,"hideNotificationBar",()=>{this.setState({barVisible:!1})})}componentDidMount(){this.fetchData()}renderDesktop(e,t){var{history:n,isMatch:a}=this.props;return h.a.createElement(S.b,{className:V.a.self,color:a?void 0:"gray-2"},h.a.createElement(x.a,{history:n,label:Object(j.c)(_())}),t,h.a.createElement(N.b,{className:V.a.scrollBox},e))}render(){var{isMatch:e,client:t,clientId:n}=this.props,{error:a,loading:r,barVisible:o}=this.state,i=o?h.a.createElement(R.a,{hideNotificationBar:this.hideNotificationBar,handleMergeCustomer:this.handleMergeCustomer,type:R.a.types.PROFILE,isMatch:e}):null,s=h.a.createElement(A.b,{noPadding:e,type:"large",flex:e?"column":"row",className:y()(V.a.container,{[V.a.containerSpa]:e})},h.a.createElement(N.b,{className:V.a.profileContainer},h.a.createElement(k.a,{notification:e?i:null,client:t})),h.a.createElement(N.b,{flex:"column",className:V.a.dataContainer},h.a.createElement(I.a,{clientId:n}),h.a.createElement(D.a,{clientId:n,marginTop:e?void 0:20})),h.a.createElement(O.b,{exact:!0,path:L.c,component:P.a}),h.a.createElement(O.b,{exact:!0,path:L.p,component:P.b}));return h.a.createElement(p.Fragment,null,h.a.createElement(w.d,{title:Object(j.c)(U())}),r||a?h.a.createElement(M.a,{error:a,retry:this.retryFetch}):t&&(e?s:this.renderDesktop(s,i)))}},u()(r,"propTypes",{isMatch:g.a.bool,client:g.a.object,clientId:g.a.string,history:g.a.object}),a=o))||a)||a}).call(this,n("yLpj"))},UtX9:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var a,r,o,i=n("pVnL"),s=n.n(i),c=n("VkAN"),l=n.n(c),u=n("QILm"),d=n.n(u),m=n("lSNA"),p=n.n(m),h=n("q1tI"),b=n.n(h),f=n("17x9"),g=n.n(f),O=n("TSYQ"),v=n.n(O),y=n("ePPS"),E=n("XOD0"),C=n("gwpz"),j=n("uopA"),S=n("MoLQ"),N=n("Jje6"),A=n("3wSE"),M=n("dhJQ"),T=n("mqQb"),P=n.n(T);function w(){var e=l()(["Close"]);return w=function(){return e},e}function x(){var e=l()(["Your request couldn’t be processed at this point. Please try again later or contact our support."]);return x=function(){return e},e}function k(){var e=l()(["Unable to load Data"]);return k=function(){return e},e}var I=Object(M.g)()((o=r=class extends h.PureComponent{render(){var e=this.props,{headerSecondaryAction:t,className:n,header:a,error:r,onClose:o,isMatch:i}=e,c=d()(e,["headerSecondaryAction","className","header","error","onClose","isMatch"]);return b.a.createElement(S.a,s()({header:i?"":a,headerOnAction:t,className:v()(P.a.self,n)},c),b.a.createElement(N.b,{flex:"row",grow:1,alignItems:"center",alignContent:"center",className:P.a.contentWrapper},r?b.a.createElement(j.a,{icon:"window-close",name:Object(y.c)(k()),text:Object(y.c)(x())},b.a.createElement(A.d,null,b.a.createElement(A.f,{onAction:o},Object(y.c)(w())))):b.a.createElement(C.a,{className:P.a.spinner})))}},p()(r,"propTypes",{className:g.a.string,header:g.a.node,headerSecondaryAction:g.a.func,error:g.a.bool,onClose:g.a.func,isMatch:g.a.bool}),p()(r,"defaultProps",{onClose:function(){Object(E.b)("/")}}),a=o))||a},W59S:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return m}));var a=n("lSNA"),r=n.n(a),o=n("CxY0"),i=n("G4qV"),s=n("nbpM"),c=n("fJus");function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=e=>Object(o.parse)(Object(o.format)(e.location),!0),m=Object(i.a)(s.a.getCustomer,s.a.getOnlineProfile,(e,t)=>u(u({},e),{},{onlineProfile:t,hasOverriddenOnlineProfile:!(!e||!t)&&Object(c.g)(e,t,["firstName","lastName","name","email","contactNumber"])}))},Xhf8:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d}));var a=n("9oTK"),r=n("5ZU+"),o=n("nbpM"),i=n("XOD0"),s=n("dsWg"),c=n("REKf");var l=function(e,{lifeTimeInSec:t}){var n={},r=({query:r,offset:o,limit:i,ignoredCustomerIds:s})=>{var c="".concat(o,":").concat(i,":").concat(r,":").concat(s);return n[c]&&n[c].timestamp+1e3*t>=Date.now()?Object(a.resolve)(n[c].data):(delete n[c],e({query:r,offset:o,limit:i,ignoredCustomerIds:s}).then(e=>{var t=Date.now();return n[c]={timestamp:t,data:e.body.data.map(e=>e.id)},Object(a.resolve)(n[c].data)}))};return r.reset=()=>{n={}},r}(r.a.searchCustomerList,{lifeTimeInSec:5});function u({query:e,offset:t,limit:n,ignoredCustomerIds:r}){return(i,s)=>l({query:e,offset:t,limit:n,ignoredCustomerIds:r}).then(e=>{var t=s(),n=o.a.getCustomerSearchResultList(t);return Object(a.resolve)(n.filter(t=>e.includes(t.id)))})}function d(){return(e,t)=>{var n=t(),a=Object(c.c)(n),r=encodeURIComponent(a);Object(i.c)("".concat(s.a,"?data=").concat(r))}}},Z0vX:function(e,t,n){"use strict";n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return v}));var a=n("pVnL"),r=n.n(a),o=n("QILm"),i=n.n(o),s=n("lSNA"),c=n.n(s),l=n("q1tI"),u=n.n(l),d=n("17x9"),m=n.n(d),p=n("TSYQ"),h=n.n(p),b=n("Jje6"),f=n("FviC"),g=n.n(f);class O extends l.PureComponent{render(){var e=this.props,{className:t,isSteps:n}=e,a=i()(e,["className","isSteps"]);return u.a.createElement(b.b,r()({as:"ol",className:h()(g.a.self,{[g.a.steps]:n},t)},a))}}c()(O,"propTypes",{className:m.a.string,isSteps:m.a.bool});class v extends l.PureComponent{render(){var e=this.props,{className:t}=e,n=i()(e,["className"]);return u.a.createElement(b.b,r()({as:"li",className:h()(g.a.item,t)},n))}}c()(v,"propTypes",{className:m.a.string})},dEH0:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n("VkAN"),r=n.n(a),o=n("lSNA"),i=n.n(o),s=n("q1tI"),c=n.n(s),l=n("17x9"),u=n.n(l),d=n("ePPS"),m=n("OyCh"),p=n("uopA"),h=n("Vows");function b(){var e=r()(["No clients found"]);return b=function(){return e},e}class f extends s.PureComponent{render(){var{items:e,onLoadMore:t,notification:n}=this.props;return c.a.createElement(m.b,{threshold:150,loadMore:t,withPadding:!0},n,e.length>0?e.map(e=>c.a.createElement(h.f,{key:e.id,grow:0,shrink:0,customer:e,onAction:()=>this.props.onItemClick(e.id),qaType:"client-".concat(e.id)})):c.a.createElement(p.a,{icon:"no-results-found",text:Object(d.c)(b())}))}}i()(f,"propTypes",{items:u.a.arrayOf(u.a.object).isRequired,onLoadMore:u.a.func.isRequired,onItemClick:u.a.func,notification:u.a.node})},fGW6:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n("VkAN"),r=n.n(a),o=n("lSNA"),i=n.n(o),s=n("q1tI"),c=n.n(s),l=n("17x9"),u=n.n(l),d=n("ePPS"),m=n("Jje6"),p=n("35RN"),h=n("F/Zl"),b=n("dsWg");function f(){var e=r()(["Clients"]);return f=function(){return e},e}class g extends s.PureComponent{render(){var{history:e,label:t}=this.props,n=Object(d.c)(f()),a=t||n,r=[Object(p.a)(n,b.t)];return t&&r.push(Object(p.a)(t)),c.a.createElement(m.b,null,c.a.createElement(h.a,{text:a}),c.a.createElement(p.b,{history:e,paths:r}))}}i()(g,"propTypes",{history:u.a.object.isRequired,label:u.a.string})},n8CV:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n("pVnL"),r=n.n(a),o=n("QILm"),i=n.n(o),s=n("lSNA"),c=n.n(s),l=n("q1tI"),u=n.n(l),d=n("17x9"),m=n.n(d),p=n("Jje6"),h=n("ZO1O"),b=n("t2yh"),f=n("+3SW"),g=n.n(f);class O extends l.PureComponent{render(){var e=this.props,{clientId:t}=e,n=i()(e,["clientId"]);return u.a.createElement(p.b,{className:g.a.wrapper},u.a.createElement(h.d,r()({className:g.a.self},n),u.a.createElement(b.a,{clientId:t,profileView:!0})))}}c()(O,"propTypes",{clientId:m.a.string.isRequired})},nDSK:function(e,t,n){"use strict";n.d(t,"b",(function(){return ie})),n.d(t,"a",(function(){return ce}));var a,r,o,i=n("pVnL"),s=n.n(i),c=n("QILm"),l=n.n(c),u=n("VkAN"),d=n.n(u),m=n("lSNA"),p=n.n(m),h=n("sEfC"),b=n.n(h),f=n("q1tI"),g=n.n(f),O=n("17x9"),v=n.n(O),y=n("TSYQ"),E=n.n(y),C=n("/MKj"),j=n("ePPS"),S=n("nbpM"),N=n("Jje6"),A=n("ZO1O"),M=n("i6OX"),T=n("3wSE"),P=n("kZhr"),w=n("uopA"),x=n("OyCh"),k=n("ITHA"),I=n("gwpz"),D=n("Vows"),R=n("j+da"),L=n("qGVk"),q=n("Xhf8"),F=n("REKf"),B=n("vN+2"),V=n.n(B),U=n("JZM8"),_=n.n(U),G=n("7GkX"),Y=n.n(G),Q=n("QFIv"),z=n.n(Q);function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(){var e=d()(["Search client"]);return W=function(){return e},e}var H,X,K,$=Y()(N.b.propTypes),ee=Object(P.q)({onSubmit:V.a})((o=r=class extends f.PureComponent{constructor(...e){super(...e),p()(this,"focusHandler",e=>{var{onFocus:t}=this.props;"function"==typeof t&&t(e)})}render(){var e=this.props,{className:t,autoFocus:n,onFocus:a,children:r}=e,o=l()(e,["className","autoFocus","onFocus","children"]);return g.a.createElement(N.b,s()({className:E()(z.a.self,t),flex:"row",alignItems:"center",qaType:"customer-input"},_()(o,$)),g.a.createElement(P.l,{name:"searchString",placeholder:Object(j.c)(W()),className:z.a.searchField,onFocus:this.focusHandler,autoFocus:n,grow:1}),r)}},p()(r,"propTypes",Z(Z({},P.Q),{},{className:v.a.string,children:v.a.node,mobile:v.a.bool,autoFocus:v.a.bool,onFocus:v.a.func})),a=o))||a,te=n("1SFb"),ne=n.n(te);function ae(){var e=d()(["Create new client"]);return ae=function(){return e},e}function re(){var e=d()(["No clients found"]);return re=function(){return e},e}function oe(){var e=d()(["Create new Client"]);return oe=function(){return e},e}var ie=()=>Object(P.gb)(F.b),se={appear:ne.a.enter,appearActive:ne.a.enterActive,enter:ne.a.enter,enterActive:ne.a.enterActive,exit:ne.a.leave,exitActive:ne.a.leaveActive},ce=Object(C.b)(e=>({searchString:Object(F.c)(e),reshedulEnabled:S.a.isReshedulEnabled(e)}),{searchCustomerList:q.b,setSearch:e=>Object(P.L)(F.b,F.a,e)})((K=X=class extends f.PureComponent{constructor(e){super(e),p()(this,"state",{searchString:"",searchOptions:null,nextOffset:0,hasMore:!0}),p()(this,"menuActions",[{id:"add-client",tooltip:Object(j.c)(oe()),onAction:this.props.handleCreateCustomer,content:g.a.createElement(M.b,{name:"plus"}),qaType:"customer-create"}]),p()(this,"setStateFromProps",e=>{var{searchString:t,isOpen:n}=e;t!==this.state.searchString?this.updateSearchString(t):!n&&t&&this.props.setSearch("")}),p()(this,"updateSearchString",b()((e="")=>{this.setState({searchString:e.trim(),searchOptions:null,nextOffset:0,hasMore:!0,isSearchFetching:!0},this.loadMoreCustomers)},300)),p()(this,"loadMoreCustomers",()=>{var{searchString:e,searchOptions:t,nextOffset:n,hasMore:a}=this.state,{ignoredCustomerIds:r}=this.props;return a&&(this.promise&&this.promise.cancel(),this.promise=this.props.searchCustomerList({query:e,offset:n,limit:50,ignoredCustomerIds:r}).then(e=>{var a=e.length>=50;return this.promise=null,this.setState({searchOptions:(t||[]).concat(e),nextOffset:n+50,hasMore:a,isSearchFetching:!1}),a})),this.promise}),this.setStateFromProps(e)}UNSAFE_componentWillReceiveProps(e){this.setStateFromProps(e)}componentWillUnmount(){this.updateSearchString.cancel()}renderSearchOptions(){var{searchOptions:e,isSearchFetching:t}=this.state,{scrollableView:n}=this.props;return g.a.createElement(x.b,{loadMore:this.loadMoreCustomers,threshold:50,scrollComponent:n},e&&0===e.length&&g.a.createElement(w.a,{icon:"no-results-found",text:Object(j.c)(re())}),t?g.a.createElement(I.a,{grow:1}):g.a.createElement(k.e,{qaType:"customer-list"},g.a.createElement(N.b,{flex:"column",as:R.c,animateEachChild:!0,exit:!1,appear:!0,transitionProps:{classNames:se,timeout:200}},(e||[]).map(e=>g.a.createElement(D.f,{key:e.id,onAction:()=>this.props.handleSetCustomer(e.id),customer:e,qaType:"customer-search-result-".concat(e.id)})))))}render(){var e=this.props,{className:t,mobile:n,autoFocus:a,isOpen:r,searchString:o,searchCustomerList:i,setSearch:c,handleOpenSearch:u,handleSetCustomer:d,handleCreateCustomer:m,stickySearch:p,scrollableView:h,reshedulEnabled:b}=e,f=l()(e,["className","mobile","autoFocus","isOpen","searchString","searchCustomerList","setSearch","handleOpenSearch","handleSetCustomer","handleCreateCustomer","stickySearch","scrollableView","reshedulEnabled"]);return g.a.createElement(A.d,s()({className:E()(ne.a.self,t),type:"mobile noMargin noPadding",grow:0,shrink:1},f),g.a.createElement(N.b,{grow:0,shrink:0,className:E()(ne.a.header,{[ne.a.sticky]:p})},g.a.createElement(ee,{form:F.b,mobile:n,autoFocus:a,onFocus:u},!b&&n&&m&&g.a.createElement(T.b,{qaType:"customer-create",className:ne.a.createClientIcon,size:"big",color:b?"blue-dark":"fresha-black",name:"add-client",onAction:m})),r&&!n&&m&&g.a.createElement(T.n,{className:ne.a.createClient,onAction:m,qaType:"customer-create"},g.a.createElement(M.b,{name:"plus",size:"standard",marginRight:8}),Object(j.c)(ae()))),r&&this.renderSearchOptions(),b&&n&&g.a.createElement(L.a,{actions:this.menuActions,inModal:!0}))}},p()(X,"propTypes",{className:v.a.string,mobile:v.a.bool.isRequired,autoFocus:v.a.bool,isOpen:v.a.bool.isRequired,searchString:v.a.string,searchCustomerList:v.a.func.isRequired,setSearch:v.a.func.isRequired,handleOpenSearch:v.a.func,handleSetCustomer:v.a.func.isRequired,handleCreateCustomer:v.a.func,stickySearch:v.a.bool,scrollableView:v.a.oneOfType([v.a.node,v.a.object]),ignoredCustomerIds:v.a.arrayOf(v.a.string),reshedulEnabled:v.a.bool}),H=K))||H},ofCH:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n("lSNA"),r=n.n(a),o=n("VkAN"),i=n.n(o),s=n("mwIZ"),c=n.n(s),l=n("q1tI"),u=n.n(l),d=n("17x9"),m=n.n(d),p=n("PhEd"),h=n("ePPS"),b=n("cB5T"),f=n("g5rd"),g=n("dmMp"),O=n("dsWg"),v=n("13Hx"),y=n.n(v);function E(){var e=i()(["No clients found"]);return E=function(){return e},e}function C(){var e=i()(["Female"]);return C=function(){return e},e}function j(){var e=i()(["Male"]);return j=function(){return e},e}function S(){var e=i()(["Gender"]);return S=function(){return e},e}function N(){var e=i()(["Email"]);return N=function(){return e},e}function A(){var e=i()(["Mobile number"]);return A=function(){return e},e}function M(){var e=i()(["Name"]);return M=function(){return e},e}var T=[{id:"avatar",text:null,align:g.b.CENTER,sortable:!1,width:92},{id:"name",text:Object(h.c)(M()),align:g.b.LEFT,sortable:!0},{id:"contactNumber",text:Object(h.c)(A()),align:g.b.LEFT,sortable:!0},{id:"email",text:Object(h.c)(N()),align:g.b.LEFT,sortable:!0},{id:"gender",text:Object(h.c)(S()),align:g.b.LEFT,sortable:!0}],P=T.map(({id:e})=>e),w=(e,t)=>e.onlineProfile&&void 0!==e.onlineProfile[t]&&e.onlineProfile[t]!==e[t];class x extends l.PureComponent{constructor(...e){super(...e),r()(this,"createRowClickHandler",e=>()=>{var{onRowClick:t}=this.props;t&&t(e.id)})}renderCell(e,t){switch(e.id){case"avatar":return u.a.createElement(g.e,{key:e.id,className:y.a.avatarCell},u.a.createElement(f.a,{customerId:c()(t,"id")}));case"gender":return u.a.createElement(g.e,{qaType:"client-gender-".concat(t.id),key:e.id},"male"===t[e.id]&&Object(h.c)(j()),"female"===t[e.id]&&Object(h.c)(C()));case"name":return u.a.createElement(g.e,{qaType:"client-".concat(e.id,"-").concat(t.id),key:e.id},u.a.createElement(p.Link,{inheritFont:!0,linkTo:O.s(t.id)},t[e.id],w(t,e.id)&&" *"));default:return u.a.createElement(g.e,{qaType:"client-".concat(e.id,"-").concat(t.id),key:e.id},t[e.id],w(t,e.id)&&" *")}}render(){var{sortBy:e,sortOrder:t,onSortChange:n,items:a,limit:r,totalRowsCount:o,loading:i,onLoadMore:s}=this.props,c=o>a.length;return a.length>0?u.a.createElement(g.d,{className:y.a.self,qaType:"client-table"},T.map(({id:a,text:r,align:o,sortable:i,width:s})=>u.a.createElement(g.f,{key:a,align:o,onAction:()=>n(a),sortOrder:e===a?t:void 0,sortable:i,width:s},r)),a.map((e,t)=>u.a.createElement(g.h,{qaType:"client-".concat(e.id),key:e.id,rowIndex:t,className:y.a.row,onClick:this.createRowClickHandler(e)},T.map(t=>this.renderCell(t,e)))),u.a.createElement(g.g,null,u.a.createElement(b.a,{rowsCount:a.length,totalRowsCount:o,hasMoreRows:c,limit:r,isFetchingMoreData:i,onLoadMoreData:s}))):u.a.createElement(p.Placeholder,{icon:"clients-search",text:u.a.createElement(p.Text,{type:"fresha-h2",color:"gray100"},Object(h.c)(E()))})}}r()(x,"propTypes",{sortBy:m.a.oneOf(P),sortOrder:m.a.oneOf(g.a),onSortChange:m.a.func.isRequired,items:m.a.arrayOf(m.a.object).isRequired,totalRowsCount:m.a.number.isRequired,limit:m.a.number.isRequired,loading:m.a.bool,onLoadMore:m.a.func.isRequired,onRowClick:m.a.func.isRequired}),r()(x,"defaultProps",{sortBy:null,sortOrder:null,loading:!1})},qGVk:function(e,t,n){"use strict";n.d(t,"b",(function(){return L})),n.d(t,"a",(function(){return ee}));var a=n("pVnL"),r=n.n(a),o=n("QILm"),i=n.n(o),s=n("lSNA"),c=n.n(s),l=n("lSCD"),u=n.n(l),d=n("pZt1"),m=n.n(d),p=n("q1tI"),h=n.n(p),b=n("17x9"),f=n.n(b),g=n("TSYQ"),O=n.n(g),v=n("pQ8y"),y=n("VeD8"),E=n("JqEL");class C extends p.PureComponent{constructor(e){super(e),this.state={isRendered:!1}}componentDidMount(){this.timeout=setTimeout(()=>this.setState({isRendered:!0}),this.props.delay)}componentWillUnmount(){Object(E.d)(this.timeout)}render(){return this.state.isRendered?p.Children.only(this.props.children):null}}c()(C,"propTypes",{delay:f.a.number,children:f.a.node}),c()(C,"defaultProps",{delay:500});n("uHid");var j=n("DTRD"),S=n("jXSx"),N=n("i6OX"),A=n("Jje6"),M=n("9wjN"),T=n("ww3E"),P=n("R3Cl"),w=n.n(P);class x extends p.Component{constructor(e){super(e),this.state={showTooltip:!1},this.handleActionRef=this.handleActionRef.bind(this)}UNSAFE_componentWillMount(){this.props.tooltip&&(this.timeout=setTimeout(()=>{this.setState({showTooltip:!0})},300))}componentWillUnmount(){clearTimeout(this.timeout)}handleActionRef(e){if(Object(E.h)(e)){"object"==typeof this.actionRefListener&&this.actionRefListener.remove();var{action:t}=this.props;this.actionRefListener=Object(E.a)(e,"touchstart",e=>{e.preventDefault(),"function"==typeof t&&t(e)},{passive:!1})}}render(){var e=this.props,{content:t,disabled:n,tooltip:a,expanded:o,action:s,qaType:c,buttonClassName:l,noFillIcon:u}=e,d=i()(e,["content","disabled","tooltip","expanded","action","qaType","buttonClassName","noFillIcon"]),{showTooltip:m}=this.state;return h.a.createElement(A.b,{className:O()(w.a.self,{[w.a.expanded]:o,[w.a.whiteIcon]:!u}),onClick:s,selfRef:this.handleActionRef,qaType:c},h.a.createElement(T.a,r()({disabled:n,type:"info float",className:O()(w.a.action,l),noFillIcon:u},d),t),h.a.createElement(y.a,null,o&&m?h.a.createElement(v.a,{classNames:{enter:w.a.tooltipAppear,enterActive:w.a.tooltipAppearActive,exit:w.a.tooltipLeave,exitActive:w.a.tooltipLeaveActive},timeout:200},h.a.createElement("div",{className:w.a.tooltip},a)):null))}}c()(x,"propTypes",{content:f.a.node.isRequired,disabled:f.a.bool,expanded:f.a.bool,tooltip:f.a.string,action:f.a.func,qaType:A.b.propTypes.qaType,buttonClassName:f.a.string,noFillIcon:f.a.bool});var k=n("tdHr"),I=n.n(k);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class L extends h.a.PureComponent{constructor(...e){super(...e),c()(this,"state",{isOpen:!1,showOverlay:!1}),c()(this,"onRootActionTouchStart",()=>{this.setState({showOverlay:!0})}),c()(this,"onRootActionMouseEnter",()=>{this.props.disabled||(this.setState({showOverlay:!1}),this.showActions())}),c()(this,"hideActions",()=>{this.setState({isOpen:!1})}),c()(this,"showActions",()=>{this.setState({isOpen:!0})}),c()(this,"renderActions",()=>this.props.actions.map((e,t)=>{var n=t,{onAction:a}=e,o=i()(e,["onAction"]);return h.a.createElement(v.a,{key:n,classNames:{enter:I.a.actionEnter,enterActive:I.a.actionEnterActive,exit:I.a.actionLeave,exitActive:I.a.actionLeaveActive},timeout:{enter:250,exit:200}},h.a.createElement(x,r()({},o,{action:()=>{this.hideActions(),"function"==typeof a&&a()},expanded:!0})))}))}UNSAFE_componentWillReceiveProps(e){!this.props.disabled&&e.disabled&&this.setState({isOpen:!1,showOverlay:!1})}get isOpen(){return this.state.isOpen&&this.state.showOverlay}render(){var{rootAction:e,disabled:t,noFillRootIcon:n,floatClassName:a,transitionSelfAppear:o,transitionSelfAppearActive:s,inModal:c}=this.props,{isOpen:l}=this.state,{onAction:d}=e,p=i()(e,["onAction"]);return h.a.createElement(S.b,{stopActionEvents:!1},h.a.createElement(j.a,{show:this.isOpen,onAction:this.hideActions},h.a.createElement(C,{delay:800},h.a.createElement(y.a,{appear:!0,enter:!1,exit:!1},h.a.createElement(v.a,{classNames:{appear:o,appearActive:s},timeout:500},h.a.createElement(A.b,{className:O()(I.a.self,a,{[I.a.mobile]:Object(M.f)(),[I.a.inModal]:c}),qaType:"floating-menu-button"},h.a.createElement(y.a,{appear:!0,enter:!1},l||t?null:h.a.createElement(v.a,{classNames:{appear:I.a.rootActionEnter,appearActive:I.a.rootActionEnterActive,exit:I.a.rootActionLeave,exitActive:I.a.rootActionLeaveActive},timeout:200},h.a.createElement(x,r()({action:()=>{if(this.props.actions.length>1)this.showActions();else{var e=m()(this.props.actions);e&&u()(e.onAction)&&e.onAction()}"function"==typeof d&&d()},onMouseEnter:this.onRootActionMouseEnter,onTouchStart:this.onRootActionTouchStart,noFillIcon:n,"data-qa":"floating-root-menu-button"},p)))))))),h.a.createElement("div",{className:O()(I.a.self,I.a.open,{[I.a.mobile]:Object(M.f)(),[I.a.inModal]:c}),onMouseLeave:this.hideActions},h.a.createElement(y.a,null,l&&this.renderActions()))))}}c()(L,"defaultProps",{rootAction:{content:h.a.createElement(N.b,{name:"plus"})},transitionSelfAppear:I.a.selfAppear,transitionSelfAppearActive:I.a.selfAppearActive}),c()(L,"propTypes",{actions:f.a.arrayOf(f.a.shape(R(R({},x.propTypes),{},{content:f.a.node,onAction:f.a.func}))).isRequired,rootAction:f.a.shape(x.propTypes),disabled:f.a.bool,noFillRootIcon:f.a.bool,floatClassName:f.a.string,transitionSelfAppear:f.a.string,transitionSelfAppearActive:f.a.string,inModal:f.a.bool});var q,F,B,V=n("VkAN"),U=n.n(V),_=n("/MKj"),G=n("PhEd"),Y=n("ePPS"),Q=n("dhJQ"),z=n("3wSE"),J=n("TSDZ"),Z=n("nbpM"),W=n("3+wM"),H=n.n(W);function X(){var e=U()(["Add New"]);return X=function(){return e},e}function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ee=Object(Q.g)()(q=Object(_.b)(e=>({isReshedulEnabled:Z.a.isReshedulEnabled(e)}))((B=F=class extends p.PureComponent{render(){var{isMatch:e,hideOnDesktop:t,hideOnMobile:n,iconOnlyOnDesktop:a,actions:r,label:o,className:i,inModal:s,isReshedulEnabled:c,buttonSize:l}=this.props;if(e&&!n)return h.a.createElement(L,{actions:r,inModal:s});if(!e&&!t){var u=r.slice();u.reverse();var d={as:G.Button,variant:"primary",size:l,iconSize:"16",iconColor:"white",wrapChildren:!0,showRipple:!1};if(u.length>1){var m=$(a?{label:null,as:z.f,showIcon:!0,icon:"plus",size:"large",className:O()(H.a.self,H.a.iconOnly,i),iconClassName:H.a.iconOnlyIcon,align:"right",qaType:"floating-menu-button"}:{label:o,as:z.f,showIcon:!1,className:O()(H.a.self,i),align:"right",qaType:"floating-menu-button"},c?d:{});return h.a.createElement(J.g,m,u.map(({id:e,onAction:t,tooltip:n,linkTo:a,qaType:r})=>h.a.createElement(J.c,{key:e,onAction:t,linkTo:a,qaType:r},n)))}if(1===r.length){var{tooltip:p,onAction:b}=r[0],f=a?{showIcon:!0,icon:"plus",size:"large",className:O()(H.a.iconOnly,i),iconClassName:H.a.iconOnlyIcon,onAction:b,qaType:"floating-menu-button"}:{showIcon:!1,onAction:b,className:i,qaType:"floating-menu-button"};return h.a.createElement(z.f,f,a?null:p)}return null}return null}},c()(F,"propTypes",{isMatch:f.a.bool,hideOnDesktop:f.a.bool,hideOnMobile:f.a.bool,iconOnlyOnDesktop:f.a.bool,actions:f.a.arrayOf(f.a.object),label:f.a.string,className:f.a.string,inModal:f.a.bool,isReshedulEnabled:f.a.bool,buttonSize:f.a.oneOf(["small","default","large"])}),c()(F,"defaultProps",{hideOnDesktop:!1,hideOnMobile:!1,iconOnlyOnDesktop:!1,actions:[],label:Object(Y.c)(X()),buttonSize:"default"}),q=B))||q)||q},qkhh:function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));var a,r,o,i=n("VkAN"),s=n.n(i),c=n("lSNA"),l=n.n(c),u=n("q1tI"),d=n.n(u),m=n("17x9"),p=n.n(m),h=n("PhEd"),b=n("5ZU+"),f=n("XOD0"),g=n("ePPS"),O=n("/Q2I"),v=n("dhJQ"),y=n("dsWg");function E(){var e=s()(["Delete"]);return E=function(){return e},e}function C(){var e=s()(["Delete Client"]);return C=function(){return e},e}function j(){var e=s()(["Are you sure? This action cannot be undone."]);return j=function(){return e},e}function S(){var e=s()(["Are you sure? This client will no longer be blocked, this action cannot be undone."]);return S=function(){return e},e}function N(){var e=s()(["Unable to remove client, please try again later"]);return N=function(){return e},e}function A(){var e=s()(["Client"]);return A=function(){return e},e}var M=Object(v.g)()((o=r=class extends u.PureComponent{constructor(...e){super(...e),l()(this,"handleDelete",()=>{var{client:{id:e}}=this.props;return b.a.deleteCustomer(e).then(()=>{b.a.notifyClientDeleted(e),b.a.addDeletedToast(Object(g.c)(A())),Object(f.b)(y.d)}).catch(()=>{b.a.addErrorToast(Object(g.c)(N()))})})}render(){var{client:{blocked:e},onClose:t,isMatch:n}=this.props,a=e?Object(g.c)(S()):Object(g.c)(j());return d.a.createElement(O.i,{size:"small"},d.a.createElement(O.g,{onClose:t,subheader:n&&a,qaType:"delete-client-modal-header"},Object(g.c)(C())),d.a.createElement(O.c,{onlyBottomPadding:n,qaType:"delete-client-modal-content"},!n&&d.a.createElement(h.Text,{type:"fresha-paragraph",color:"gray100"},a)),d.a.createElement(O.e,null,d.a.createElement(h.Button,{onAction:this.handleDelete,withPending:!0,qaType:"delete-client-modal-button",variant:"danger"},Object(g.c)(E()))))}},l()(r,"propTypes",{client:p.a.shape({id:p.a.string.isRequired,blocked:p.a.bool}),isMatch:p.a.bool,onClose:p.a.func}),a=o))||a},rb4H:function(e,t,n){"use strict";n.d(t,"a",(function(){return le})),n.d(t,"b",(function(){return ge}));var a,r,o,i=n("lSNA"),s=n.n(i),c=n("VkAN"),l=n.n(c),u=n("mwIZ"),d=n.n(u),m=n("q1tI"),p=n.n(m),h=n("/MKj"),b=n("17x9"),f=n.n(b),g=n("5ZU+"),O=n("XOD0"),v=n("ePPS"),y=n("kZhr"),E=n("dhJQ"),C=n("Qs7Y"),j=n("3wSE"),S=n("tPh7"),N=n("/Q2I"),A=n("1UfZ"),M=n("dsWg"),T=n("gQMU"),P=n.n(T),w=n("ZO1O"),x=n("uZ2f");function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(){var e=l()(["Note"]);return D=function(){return e},e}function R(){var e=l()(["Add note"]);return R=function(){return e},e}function L(){var e=l()(["Other"]);return L=function(){return e},e}function q(){var e=l()(["Select blocking reason"]);return q=function(){return e},e}function F(){var e=l()(["Blocking reason"]);return F=function(){return e},e}function B(){var e=l()(["Select blocking reason"]);return B=function(){return e},e}var V,U,_,G="customer-block-form",Y="blockReason",Q="note",z=Object(y.W)(G),J=[y.kb.required(P()(Q)),y.kb.maxLength(100)],Z=Object(y.q)({form:G,destroyOnUnmount:!1})(a=Object(h.b)(e=>({blockReason:d()(z(e),"blockReason")}))((o=r=class extends m.PureComponent{render(){var{blockReason:e,blockReasons:t,mobile:n}=this.props;return p.a.createElement(w.d,{type:"plain popup-form bottom-space"},p.a.createElement(x.r,{name:Y,label:n?Object(v.c)(B()):Object(v.c)(F()),invalidValueLabel:n?"":Object(v.c)(q()),xpos:n?"":"middle"},t.map(e=>p.a.createElement("option",{key:e,value:e},e)),p.a.createElement("option",{key:"",value:"0"},Object(v.c)(L()))),"0"===e&&p.a.createElement(x.s,{multiline:!0,rows:n?1:3,type:"textarea",placeholder:Object(v.c)(R()),name:Q,validate:J,label:n&&Object(v.c)(D()),xpos:n?"":"middle"}))}},s()(r,"propTypes",I(I({},y.Q),{},{blockReasons:f.a.arrayOf(f.a.string).isRequired,mobile:f.a.bool.isRequired})),a=o))||a)||a;function W(){var e=l()(["Block"]);return W=function(){return e},e}function H(){var e=l()(["Cancel"]);return H=function(){return e},e}function X(){var e=l()(["Block Client"]);return X=function(){return e},e}function K(){var e=l()(["Are you sure you want to block this client?"]);return K=function(){return e},e}function $(){var e=l()(["Blocking client failed"]);return $=function(){return e},e}function ee(){var e=l()(["Client blocked"]);return ee=function(){return e},e}function te(){var e=l()(["Blocked clients are also automatically excluded from any marketing messages."]);return te=function(){return e},e}function ne(){var e=l()(["Blocking prevents this client from booking online appointments with you, they will find no available time slots."]);return ne=function(){return e},e}var ae,re,oe,ie=["Too many no shows","Too many late cancellations","Too many reschedules","Rude or inappropriate to staff","Refused to pay","Booked fake appointments"],se=Object(v.c)(ne()),ce=Object(v.c)(te()),le=Object(E.g)()(V=Object(h.b)(e=>({submitting:Object(y.bb)(G)(e)}),{destroyForm:()=>Object(y.N)(G),submitForm:()=>Object(y.hb)(G)})((_=U=class extends m.PureComponent{constructor(...e){super(...e),s()(this,"handleClose",()=>{this.props.destroyForm(),Object(O.b)(Object(M.s)(this.customerId))}),s()(this,"handleSubmit",({note:e,blockReason:t})=>{var n=e||t||"";return Object(A.c)(this.customerId,n).then(()=>{g.a.addGlobalSuccessToast(Object(v.c)(ee())),this.handleClose()}).catch(()=>g.a.addGlobalErrorToast(Object(v.c)($())))})}componentDidMount(){this.customerId=d()(this.props,"match.params.id")}render(){var{isMatch:e,submitting:t}=this.props,n=Object(v.c)(K());return p.a.createElement(N.i,{size:"small"},p.a.createElement(N.g,{noBottomPadding:e,secondaryAction:p.a.createElement(j.e,{onAction:this.handleClose}),subheader:e&&n},Object(v.c)(X())),p.a.createElement(N.c,{noPadding:!0},!e&&p.a.createElement(S.a,{forceShow:!0},p.a.createElement(C.d,{qaType:"block-client-modal-title",type:"bold"},n)),p.a.createElement(S.a,{qaType:"block-client-modal-firstParagraph",noTopPadding:!0,forceShow:!0},se),p.a.createElement(S.a,{qaType:"block-client-modal-secondParagraph",noTopPadding:!0,forceShow:!0},ce),p.a.createElement(Z,{blockReasons:ie,onSubmit:this.handleSubmit,mobile:e})),p.a.createElement(N.e,{modalWindow:!0,embeddedToaster:!1,noPadding:!0},p.a.createElement(N.b,null,p.a.createElement(j.a,{onAction:this.handleClose,grow:1,basis:"100%",qaType:"cancel_confirm_button"},Object(v.c)(H())),p.a.createElement(j.f,{onAction:this.props.submitForm,grow:1,basis:"100%",isPending:t,qaType:"block_confirm_button"},Object(v.c)(W())))))}},s()(U,"propTypes",{destroyForm:f.a.func.isRequired,isMatch:f.a.bool,submitForm:f.a.func,submitting:f.a.bool}),V=_))||V)||V;function ue(){var e=l()(["Unblock"]);return ue=function(){return e},e}function de(){var e=l()(["Cancel"]);return de=function(){return e},e}function me(){var e=l()(["Unblock Client"]);return me=function(){return e},e}function pe(){var e=l()(["This will allow the client to book online appointments with you and to receive marketing messages."]);return pe=function(){return e},e}function he(){var e=l()(["Are you sure you want to unblock this client?"]);return he=function(){return e},e}function be(){var e=l()(["Unblocking client failed"]);return be=function(){return e},e}function fe(){var e=l()(["Client unblocked"]);return fe=function(){return e},e}var ge=Object(E.g)()((oe=re=class extends m.PureComponent{constructor(...e){super(...e),s()(this,"handleUnblock",()=>Object(A.m)(this.customerId).then(()=>{g.a.addGlobalSuccessToast(Object(v.c)(fe())),this.handleClose()}).catch(()=>g.a.addGlobalErrorToast(Object(v.c)(be())))),s()(this,"handleClose",()=>{Object(O.b)(Object(M.s)(this.customerId))})}componentDidMount(){this.customerId=d()(this.props,"match.params.id")}render(){var{isMatch:e}=this.props,t=Object(v.c)(he()),n=Object(v.c)(pe());return p.a.createElement(N.i,{size:"small"},p.a.createElement(N.g,{noBottomPadding:e,secondaryAction:p.a.createElement(j.e,{onAction:this.handleClose}),subheader:e&&t},Object(v.c)(me())),p.a.createElement(N.c,{onlyBottomPadding:!0},!e&&p.a.createElement(S.a,{forceShow:!0},t),p.a.createElement(S.a,{noTopPadding:!0,forceShow:!0},n)),p.a.createElement(N.e,{modalWindow:!0,embeddedToaster:!1,noPadding:!0},p.a.createElement(N.b,null,p.a.createElement(j.a,{qaType:"unblock-client-modal-button-cancel",onAction:this.handleClose,grow:1,basis:"100%"},Object(v.c)(de())),p.a.createElement(j.f,{qaType:"unblock-client-modal-button-unblock",onAction:this.handleUnblock,grow:1,basis:"100%",withPending:!0},Object(v.c)(ue())))))}},s()(re,"propTypes",{isMatch:f.a.bool}),ae=oe))||ae},t2yh:function(e,t,n){"use strict";n.d(t,"a",(function(){return vt}));var a=n("VkAN"),r=n.n(a),o=n("lSNA"),i=n.n(o),s=n("q1tI"),c=n.n(s),l=n("17x9"),u=n.n(l),d=n("ePPS"),m=n("QqEi"),p=n("pVnL"),h=n.n(p),b=n("/MKj"),f=n("nbpM"),g=n("sQHA"),O=n("Jje6"),v=n("XOuL"),y=n("uopA"),E=n("3wSE"),C=n("lSCD"),j=n.n(C),S=n("PhEd"),N=n("ZO1O"),A=n("gwpz"),M=n("Qs7Y"),T=n("Vows"),P=n("mwIZ"),w=n.n(P),x=n("5ZU+");function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function I(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({limit:100},t);return x.a.readCustomerProductSaleItems(e,n).then(e=>{var{offset:t,limit:a}=n,r=w()(e,"body.data",[]);return{nextOffset:t+a,hasMore:r.length===a,itemIds:r.map(e=>e.id)}})}var D,R,L,q=n("YtiB"),F=n.n(q);function B(){var e=r()(["Past"]);return B=function(){return e},e}function V(){var e=r()(["Upcoming"]);return V=function(){return e},e}function U(){var e=r()(["Past"]);return U=function(){return e},e}function _(){var e=r()(["Upcoming"]);return _=function(){return e},e}var G,Y,Q,z=Object(b.b)(e=>({providerMoment:f.a.providerMoment(e),isReshedulEnabled:f.a.isReshedulEnabled(e)}))((L=R=class extends s.PureComponent{constructor(...e){super(...e),i()(this,"state",{loading:!1,hasMore:!0,offset:0,itemIds:[],appointmentList:[],totalCount:0}),i()(this,"getYear",e=>e&&e.year()),i()(this,"shouldAddYear",(e,t,n)=>{var{providerMoment:a}=this.props;return 0===e&&n!==a().year()||e>0&&t[e-1].meta.year!==n}),i()(this,"addYearMeta",(e,t,n)=>{var a=this.getYear(t[0].start);return e.push({data:t,meta:{showYear:this.shouldAddYear(n,e,a),year:a}}),e}),i()(this,"promise",null),i()(this,"loadMore",(e=this.props.loadMoreLength)=>{var{clientId:t,type:n}=this.props,{offset:a,hasMore:r}=this.state;return r&&!this.promise&&(this.setState({loading:!0}),this.promise=function(e,t){return x.a.readCustomerBookings(e,t).then(e=>{var{offset:n,limit:a}=t,r=w()(e,"body.data",[]),o=w()(e,"body.meta.bookingsCount",0);return{nextOffset:n+a,itemIds:r.map(e=>e.id),totalCount:o}})}(t,{limit:e,offset:a,only:n}).then(e=>{var{itemIds:t,nextOffset:n,totalCount:a}=e,r=this.state.itemIds.concat(t);return this.promise=null,this.setState((e,t)=>({loading:!1,offset:n,hasMore:r.length<a,itemIds:r,appointmentList:r.map(e=>t.itemsDict[e]).reduce(this.addYearMeta,[]),totalCount:a})),e}).catch(()=>(this.setState({loading:!1,hasMore:!1}),{error:!0}))),this.promise})}componentDidMount(){this.loadMore(this.props.initialLength).then(e=>{this.props.initialCallback(this.props.type,e.totalCount?e.totalCount:0,e.error)})}componentWillUnmount(){this.promise&&j()(this.promise.cancel)&&this.promise.cancel()}render(){var{loadMoreLength:e,profileView:t,type:n,qaType:a,isReshedulEnabled:r}=this.props,{appointmentList:o,hasMore:i,itemIds:s,loading:l,totalCount:u}=this.state;return 0===s.length?null:c.a.createElement(O.b,{className:F.a.self,qaType:a},c.a.createElement(N.d,{type:"transparent plain",className:F.a.section},r?c.a.createElement(S.Text,{type:"fresha-h3",color:"gray100"},Object(d.c)("%{type} (%{count})",{type:n===g.n.UPCOMING?Object(d.c)(_()):Object(d.c)(U()),count:u})):c.a.createElement(M.d,{type:"group-title"},Object(d.c)("%{type} (%{count})",{type:n===g.n.UPCOMING?Object(d.c)(V()):Object(d.c)(B()),count:u}))),c.a.createElement(O.b,{className:F.a.list},o.map(e=>{var{data:n,meta:a}=e;return c.a.createElement(O.b,{key:n[0].id},a.showYear&&c.a.createElement(O.b,{className:F.a.year},c.a.createElement(M.d,{type:"section-name"},a.year)),c.a.createElement(T.c,{shouldLink:t,bookings:n,qaType:"appointment-row-button"}))}),l&&c.a.createElement(A.a,null)),!l&&i&&c.a.createElement(N.d,{type:"transparent plain",className:F.a.loadMore},c.a.createElement(E.n,{onAction:this.loadMore},c.a.createElement(M.d,{as:"span",type:"link"},Object(d.c)("Load %{count} more",{count:Math.min(e,u-s.length)})))))}},i()(R,"propTypes",{initialCallback:u.a.func,initialLength:u.a.number.isRequired,loadMoreLength:u.a.number.isRequired,clientId:u.a.string.isRequired,itemsDict:u.a.object.isRequired,profileView:u.a.bool,providerMoment:u.a.func,type:u.a.oneOf(g.o),qaType:u.a.string,isReshedulEnabled:u.a.bool}),D=L))||D,J=n("Av8N"),Z=n.n(J);function W(){var e=r()(["This client has no upcoming or past appointments"]);return W=function(){return e},e}function H(){var e=r()(["No Appointments"]);return H=function(){return e},e}function X(){var e=r()(["here"]);return X=function(){return e},e}function K(){var e=r()(["Oops, something went wrong"]);return K=function(){return e},e}var $,ee,te,ne,ae,re,oe=Object(b.b)((e,{clientId:t})=>({itemsDict:f.a.getCustomerBookingHistory(e,t)}))((Q=Y=class extends s.PureComponent{constructor(...e){super(...e),i()(this,"state",{empty:!1,initialLoading:!0}),i()(this,"stats",{[g.n.UPCOMING]:null,[g.n.PAST]:null}),i()(this,"handleLoaded",(e,t,n=!1)=>{if(this.stats[e]={count:t,error:n},Object.values(this.stats).some(e=>e&&e.error))this.setState({empty:!0,initialLoading:!1,error:!0});else if(Object.values(this.stats).every(e=>null!==e)){var a=Object.values(this.stats).reduce((e,t)=>e+t.count,0);this.setState({empty:a<=0,initialLoading:!1,error:n})}}),i()(this,"reloadSection",()=>{this.setState({empty:!1,error:!1,initialLoading:!0})})}render(){var{empty:e,initialLoading:t,error:n}=this.state;return c.a.createElement(O.b,{className:Z.a.self},c.a.createElement(v.a,{if:t},e&&(n?c.a.createElement(y.a,{icon:"connection-error",name:Object(d.c)(K())},Object(d.c)("Click %{retryButton} to try again or contact our support.",{retryButton:c.a.createElement(E.n,{as:"span",onAction:this.reloadSection},Object(d.c)(X()))})):c.a.createElement(y.a,{icon:"no-appointments",name:Object(d.c)(H()),text:Object(d.c)(W())})),!e&&!n&&c.a.createElement(c.a.Fragment,null,c.a.createElement(z,h()({initialCallback:this.handleLoaded,initialLength:2,loadMoreLength:5,type:g.n.UPCOMING,qaType:"upcoming-appointments"},this.props)),c.a.createElement(z,h()({initialCallback:this.handleLoaded,initialLength:20,loadMoreLength:20,type:g.n.PAST,qaType:"past-appointments"},this.props)))))}},i()(Y,"propTypes",{clientId:u.a.string.isRequired,itemsDict:u.a.object.isRequired}),G=Q))||G,ie=n("TSYQ"),se=n.n(ie),ce=n("ivFB"),le=n("A392"),ue=n("dhJQ"),de=Object(b.b)((e,t)=>({client:f.a.getCustomer(e,t.clientId)}))($=Object(ue.g)()((te=ee=class extends s.PureComponent{render(){return c.a.createElement(N.d,{grow:1,type:se()("plain transparent",{noPadding:this.props.isMatch})},c.a.createElement(le.a,{client:this.props.client}))}},i()(ee,"propTypes",{client:u.a.shape(ce.a.propTypes).isRequired,isMatch:u.a.bool}),$=te))||$)||$,me=n("IZOP"),pe=n.n(me),he=n("5KxP"),be=n("dwNy"),fe=n("478R"),ge=n("dmMp"),Oe=n("KvEn"),ve=n("QXy2"),ye=n("QPrj"),Ee=n.n(ye);function Ce(){var e=r()(["Total"]);return Ce=function(){return e},e}function je(){var e=r()(["Location"]);return je=function(){return e},e}function Se(){var e=r()(["Invoice date"]);return Se=function(){return e},e}function Ne(){var e=r()(["Invoice#"]);return Ne=function(){return e},e}function Ae(){var e=r()(["Status"]);return Ae=function(){return e},e}function Me(){var e=r()(["Voided"]);return Me=function(){return e},e}function Te(){var e=r()(["Exchange"]);return Te=function(){return e},e}function Pe(){var e=r()(["Refund"]);return Pe=function(){return e},e}function we(){var e=r()(["Unpaid"]);return we=function(){return e},e}function xe(){var e=r()(["Part paid"]);return xe=function(){return e},e}function ke(){var e=r()(["Completed"]);return ke=function(){return e},e}var Ie={[be.e.PAID]:{type:fe.a.SUCCESS,text:Object(d.c)(ke())},[be.e.PART_PAID]:{type:fe.a.WARNING,text:Object(d.c)(xe())},[be.e.UNPAID]:{type:fe.a.WARNING,text:Object(d.c)(we())},[be.e.REFUND]:{type:fe.a.DANGER,text:Object(d.c)(Pe())},[be.e.EXCHANGE]:{type:fe.a.SUCCESS,text:Object(d.c)(Te())},[be.e.VOIDED]:{type:fe.a.DANGER,text:Object(d.c)(Me())}},De="status",Re="receiptNumber",Le="invoiceDate",qe="locationName",Fe="totalGross",Be=[{id:De,text:Object(d.c)(Ae()),align:ge.b.LEFT,width:120},{id:Re,text:Object(d.c)(Ne()),align:ge.b.LEFT,width:120},{id:Le,text:Object(d.c)(Se()),align:ge.b.LEFT,width:120},{id:qe,text:Object(d.c)(je()),align:ge.b.LEFT,width:120},{id:Fe,text:Object(d.c)(Ce()),align:ge.b.RIGHT,width:120}],Ve=Be.filter(e=>e.id!==qe);function Ue(e){return e.reduce((e,{width:t})=>e+t,0)}var _e=Ue(Be),Ge=Ue(Ve),Ye=pe()()((re=ae=class extends s.PureComponent{constructor(...e){super(...e),i()(this,"renderCell",(e,t)=>{var{enableLinks:n}=this.props,a=t[e.id],r=a;switch(e.id){case De:var{type:o,text:i}=Ie[a];r=c.a.createElement(fe.b,{type:o},i);break;case Re:r=n?c.a.createElement(E.n,{linkTo:Object(he.h)(t.id)},a):a;break;case Le:r=a.format("D MMM YYYY");break;case Fe:r=c.a.createElement(Oe.a,{price:a});break;default:r=a}return c.a.createElement(ge.e,{key:e.id,align:e.align},r)})}render(){var{hasMoreRows:e,hasMultipleLocations:t,limit:n,loading:a,loadMore:r,sales:o,totalRowsCount:i,size:s}=this.props,l=t?Be:Ve,u=t?_e:Ge,m=s.width&&s.width<u;return c.a.createElement(O.b,{className:Ee.a.self},c.a.createElement(ge.d,{className:Ee.a.table,pinFirstColumn:m},l.map(({id:e,text:t,align:n,width:a})=>c.a.createElement(ge.f,{key:e,align:n,width:a},t)),o.map(e=>c.a.createElement(ge.h,{key:e.id},l.map(t=>this.renderCell(t,e)))),c.a.createElement(ge.g,null,c.a.createElement(v.a,{if:a,type:"paginated-resource",spinnerSize:"medium",flex:"column"},c.a.createElement(O.b,{flex:"column"},Object(d.c)("Showing %{rowsCount} of %{totalRowsCount} results",{rowsCount:o.length,totalRowsCount:i}),e&&c.a.createElement(E.r,{onAction:r},Object(d.c)("Load %{limit} more",{limit:n})))))))}},i()(ae,"propTypes",{enableLinks:u.a.bool,hasMoreRows:u.a.bool.isRequired,hasMultipleLocations:u.a.bool,sales:u.a.arrayOf(u.a.shape({invoiceDate:ve.b})).isRequired,loadMore:u.a.func.isRequired,loading:u.a.bool,limit:u.a.number.isRequired,totalRowsCount:u.a.number.isRequired,size:u.a.shape({width:u.a.number})}),ne=re))||ne,Qe=n("OyCh");class ze extends s.PureComponent{render(){var{hasMultipleLocations:e,sales:t,loadMore:n,enableLinks:a}=this.props;return c.a.createElement(Qe.b,{flex:"column",threshold:150,loadMore:n},t.map(t=>c.a.createElement(T.m,{enableLinks:a,hasMultipleLocations:e,key:t.id,sale:t})))}}i()(ze,"propTypes",{enableLinks:u.a.bool,hasMultipleLocations:u.a.bool,sales:u.a.arrayOf(u.a.shape({id:u.a.string})).isRequired,loadMore:u.a.func.isRequired});var Je,Ze,We,He=n("Mi3G"),Xe=n.n(He);function Ke(){var e=r()(["here"]);return Ke=function(){return e},e}function $e(){var e=r()(["Oops, something went wrong"]);return $e=function(){return e},e}function et(){var e=r()(["Use the checkout feature to create a new sale for this client"]);return et=function(){return e},e}function tt(){var e=r()(["No Sales History"]);return tt=function(){return e},e}var nt,at,rt,ot=Object(ue.g)()(Je=Object(b.b)((e,{clientId:t})=>({items:f.a.getCustomerSaleHistoryDict(e,t),hasMultipleLocations:f.a.getLocationList(e).length>1}))((We=Ze=class extends s.PureComponent{constructor(...e){super(...e),i()(this,"state",{loading:!1,offset:0,hasMore:!0,itemIds:[],totalSalesCount:0,error:!1}),i()(this,"promise",null),i()(this,"loadMore",()=>{var{clientId:e}=this.props,{hasMore:t,offset:n}=this.state;return t&&!this.promise&&(this.setState({loading:!0}),this.promise=function(e,t){return x.a.readCustomerSaleList(e,t).then(e=>{var{offset:n,limit:a}=t,r=w()(e,"body.data",[]);return{nextOffset:n+a,hasMore:r.length===a,totalSalesCount:w()(e,"body.meta.salesCount",0),itemIds:r.map(e=>e.id)}})}(e,{limit:20,offset:n}).then(({totalSalesCount:e,nextOffset:t,hasMore:n,itemIds:a})=>{this.promise=null,this.setState(r=>({loading:!1,offset:t,hasMore:n,itemIds:r.itemIds.concat(a),totalSalesCount:e}))}).catch(()=>{this.setState({loading:!1,hasMore:!1,error:!0})})),this.promise}),i()(this,"reloadSection",()=>{this.promise=null,this.setState({loading:!0,error:!1,hasMore:!0},this.loadMore)})}componentDidMount(){this.loadMore()}componentWillUnmount(){this.promise&&this.promise.cancel()}render(){var{hasMultipleLocations:e,isMatch:t,items:n,profileView:a}=this.props,{itemIds:r,hasMore:o,loading:i,totalSalesCount:s,error:l}=this.state,u=r.map(e=>n[e]);return c.a.createElement(O.b,{flex:"column",grow:1,className:Xe.a.self},c.a.createElement(v.a,{if:i},u.length>0&&(a&&!t?c.a.createElement(Ye,{enableLinks:a,hasMoreRows:o,hasMultipleLocations:e,sales:u,loadMore:this.loadMore,loading:i,limit:20,totalRowsCount:s}):c.a.createElement(ze,{enableLinks:a,hasMultipleLocations:e,sales:u,loadMore:this.loadMore})),!l&&!i&&!o&&0===u.length&&c.a.createElement(y.a,{icon:"no-sales",name:Object(d.c)(tt()),text:Object(d.c)(et())}),l&&c.a.createElement(y.a,{icon:"connection-error",name:Object(d.c)($e())},Object(d.c)("Click %{retryButton} to try again or contact our support.",{retryButton:c.a.createElement(E.n,{as:"span",onAction:this.reloadSection},Object(d.c)(Ke()))}))))}},i()(Ze,"propTypes",{isMatch:u.a.bool.isRequired,clientId:u.a.string.isRequired,hasMultipleLocations:u.a.bool,items:u.a.object.isRequired,profileView:u.a.bool}),Je=We))||Je)||Je,it=n("v18t"),st=n.n(it);function ct(){var e=r()(["Use the checkout feature to create a new sale for this client"]);return ct=function(){return e},e}function lt(){var e=r()(["No Sales History"]);return lt=function(){return e},e}function ut(){var e=r()(["here"]);return ut=function(){return e},e}function dt(){var e=r()(["Oops, something went wrong"]);return dt=function(){return e},e}var mt=Object(b.b)((e,{clientId:t})=>({items:f.a.getCustomerSaleProducts(e,t)}),{})((rt=at=class extends s.PureComponent{constructor(...e){super(...e),i()(this,"state",{loading:!1,offset:0,hasMore:!0,error:!1}),i()(this,"promise",null),i()(this,"loadMore",()=>{var{clientId:e}=this.props,{offset:t,hasMore:n}=this.state;return n&&!this.promise&&(this.setState({loading:!0}),this.promise=I(e,{offset:t}).then(({nextOffset:e,hasMore:t})=>{this.promise=null,this.setState({loading:!1,offset:e,hasMore:t})}).catch(()=>{this.setState({loading:!1,hasMore:!1,error:!0})})),this.promise}),i()(this,"reloadSection",()=>{this.promise=null,this.setState({loading:!0,error:!1,hasMore:!0},this.loadMore)})}componentWillUnmount(){this.promise&&this.promise.cancel()}render(){var{items:e}=this.props,{loading:t,error:n}=this.state;return c.a.createElement(Qe.b,{flex:"column",className:st.a.self,loadMore:this.loadMore,threshold:150},!n&&!t&&e.map(e=>c.a.createElement(T.u,{key:e.id,item:e})),!t&&n&&c.a.createElement(y.a,{icon:"connection-error",name:Object(d.c)(dt())},Object(d.c)("Click %{retryButton} to try again or contact our support.",{retryButton:c.a.createElement(E.n,{as:"span",onAction:this.reloadSection},Object(d.c)(ut()))})),!t&&!n&&0===e.length&&c.a.createElement(y.a,{icon:"no-products",name:Object(d.c)(lt()),text:Object(d.c)(ct())}))}},i()(at,"propTypes",{clientId:u.a.string.isRequired,items:u.a.arrayOf(u.a.object).isRequired}),nt=rt))||nt,pt=n("uv4m"),ht=n.n(pt);function bt(){var e=r()(["Info"]);return bt=function(){return e},e}function ft(){var e=r()(["Invoices"]);return ft=function(){return e},e}function gt(){var e=r()(["Products"]);return gt=function(){return e},e}function Ot(){var e=r()(["Appointments"]);return Ot=function(){return e},e}class vt extends s.PureComponent{render(){return c.a.createElement(m.b,{flexContent:!0,noTabsMargin:!0,className:ht.a.self,contentClassName:ht.a.tabContainer},c.a.createElement(m.a,{name:Object(d.c)(Ot())},c.a.createElement(oe,this.props)),c.a.createElement(m.a,{name:Object(d.c)(gt())},c.a.createElement(mt,this.props)),c.a.createElement(m.a,{name:Object(d.c)(ft())},c.a.createElement(ot,this.props)),!this.props.profileView&&c.a.createElement(m.a,{name:Object(d.c)(bt())},c.a.createElement(de,this.props)))}}i()(vt,"propTypes",{clientId:u.a.string.isRequired,profileView:u.a.bool})},tYzA:function(e,t,n){"use strict";n.d(t,"a",(function(){return Q}));var a,r,o,i=n("VkAN"),s=n.n(i),c=n("lSNA"),l=n.n(c),u=n("q1tI"),d=n.n(u),m=n("17x9"),p=n.n(m),h=n("TSYQ"),b=n.n(h),f=n("PhEd"),g=n("XOD0"),O=n("X67z"),v=n("+Gzo"),y=n("JqEL"),E=n("ePPS"),C=n("/pl8"),j=n("g5rd"),S=n("Jje6"),N=n("ZO1O"),A=n("A392"),M=n("JraT"),T=n("AQgK"),P=n("TSDZ"),w=n("dhJQ"),x=n("8TPp"),k=n("QXy2"),I=n("dsWg"),D=n("LJ0S"),R=n.n(D),L=n("qkhh");function q(){var e=s()(["New appointment"]);return q=function(){return e},e}function F(){var e=s()(["New appointment"]);return F=function(){return e},e}function B(){var e=s()(["Delete"]);return B=function(){return e},e}function V(){var e=s()(["Merge"]);return V=function(){return e},e}function U(){var e=s()(["Edit"]);return U=function(){return e},e}function _(){var e=s()(["Block"]);return _=function(){return e},e}function G(){var e=s()(["Unblock"]);return G=function(){return e},e}function Y(){var e=s()(["This client has been deactivated, so you can't perform any action"]);return Y=function(){return e},e}var Q=Object(w.g)()((o=r=class extends u.PureComponent{constructor(...e){super(...e),l()(this,"state",{deleteModalOpen:!1}),l()(this,"handleGoBack",()=>{Object(g.b)(I.d)}),l()(this,"handleEdit",()=>{Object(g.c)(I.u(this.props.client.id))}),l()(this,"handleToggleBlocked",()=>{var{blocked:e,id:t}=this.props.client;e?Object(g.c)(I.C(t)):Object(g.c)(I.q(t))}),l()(this,"toggleDeleteModal",()=>{this.setState({deleteModalOpen:!this.state.deleteModalOpen})}),l()(this,"handleCall",()=>{Object(y.g)(this.props.client.contactNumber)}),l()(this,"handleMerge",()=>{var{client:e}=this.props;Object(g.f)(I.x(e.id))}),l()(this,"handleCreateAppointment",()=>{var{client:e}=this.props;Object(g.f)(Object(v.G)(e.id))}),l()(this,"renderDeletedInfo",()=>d.a.createElement(S.b,{flex:"row",className:R.a.buttons},d.a.createElement(f.Text,{type:"fresha-caption",color:"gray50"},Object(E.c)(Y()))))}renderCommonActions(e){var{client:t}=this.props,n=t.blocked?Object(E.c)(G()):Object(E.c)(_());return d.a.createElement(d.a.Fragment,null,d.a.createElement(f.DropdownAction,{onAction:Object(C.c)(e.canSeeCustomerDetails,this.handleEdit),qaType:"client-edit-button"},Object(E.c)(U())),d.a.createElement(f.DropdownAction,{onAction:Object(C.c)(e.canSeeCustomerDetails,this.handleMerge),qaType:"client-merge-button"},Object(E.c)(V())),d.a.createElement(f.DropdownAction,{onAction:Object(C.c)(e.canSeeCustomerDetails,this.handleToggleBlocked),qaType:"client-block-button"},n),d.a.createElement(f.DropdownAction,{danger:!0,onAction:Object(C.c)(e.canSeeCustomerDetails,this.toggleDeleteModal),qaType:"client-delete-button"},Object(E.c)(B())))}renderHeaderActions(){var{client:e}=this.props;return d.a.createElement(C.b,{keys:[O.a.CAN_BOOK_APPOINTMENTS,O.a.CAN_SEE_CUSTOMER_DETAILS]},t=>d.a.createElement(P.f,{icon:P.f.ICON.OPTIONS,qaType:"client-more-options-button"},d.a.createElement(f.DropdownAction,{qaType:"client-profile-dropdown-new-appt",onAction:Object(C.c)(t.canBookAppointments,this.handleCreateAppointment)},Object(E.c)(F())),e.contactNumber&&!e.obfuscatedContactNumber&&d.a.createElement(f.DropdownAction,{onAction:this.handleCall},Object(E.c)("Call %{phone}",{phone:e.contactNumber})),this.renderCommonActions(t)))}renderButtons(){return d.a.createElement(S.b,{flex:"row",className:R.a.buttons},d.a.createElement(C.b,{keys:[O.a.CAN_BOOK_APPOINTMENTS,O.a.CAN_SEE_CUSTOMER_DETAILS]},e=>d.a.createElement(d.a.Fragment,null,d.a.createElement(f.DropdownMenuButton,{qaType:"client-more-options-button",className:R.a.desktopDropDown},this.renderCommonActions(e)),d.a.createElement(f.Button,{variant:"primary",onAction:Object(C.c)(e.canBookAppointments,this.handleCreateAppointment),qaType:"new-appointment-button",className:R.a.newAppointmentDesktopButton},Object(E.c)(q())))))}renderBlockNote(){var{client:e}=this.props;return d.a.createElement(f.Text,{type:"fresha-paragraph",color:"red200",className:R.a.blockNote,qaType:"client-block-notes"},e.blockNote)}render(){var{client:e,isMatch:t,notification:n}=this.props,a=e.onlineProfile||{},r=e.name!==a.name,o=a.name&&r?" *":"",{deleteModalOpen:i}=this.state;return d.a.createElement(N.d,{className:R.a.self,type:b()({plain:t,noPadding:t})},d.a.createElement(S.b,{textAlign:"center",className:R.a.clientHeader},d.a.createElement(j.a,{className:R.a.avatar,customerId:e.id,size:j.e.SIZE.VERY_LARGE}),d.a.createElement(f.Text,{qaType:"client-name",type:"fresha-temporary-28",className:R.a.name},"".concat(e.name).concat(o)),d.a.createElement(T.a,{customer:e,className:R.a.badges,qaType:"custom-badges"}),e.blocked&&e.blockNote&&this.renderBlockNote(),e.deletedAt?this.renderDeletedInfo():d.a.createElement(x.b,{position:"right"},e=>e?this.renderHeaderActions():this.renderButtons()),d.a.createElement(x.b,{position:"left"},e=>e?d.a.createElement(x.a,{icon:"arrow-left-cropped",onAction:this.handleGoBack}):null),e.note&&e.displayNote&&d.a.createElement(M.a,{note:e.note,className:R.a.note})),n,d.a.createElement(S.b,null,d.a.createElement(S.b,{className:R.a.separator}),d.a.createElement(A.a,{client:e})),i&&d.a.createElement(L.a,{client:e,onClose:this.toggleDeleteModal}))}},l()(r,"propTypes",{client:p.a.shape({id:p.a.string,blocked:p.a.bool,displayNote:p.a.bool,contactNumber:p.a.string,obfuscatedContactNumber:p.a.string,name:p.a.string,note:p.a.string,blockNote:p.a.string,onlineProfile:p.a.object,deletedAt:k.b}),isMatch:p.a.bool,notification:p.a.element}),a=o))||a},tnX3:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return de}));var a,r,o,i=n("pVnL"),s=n.n(i),c=n("QILm"),l=n.n(c),u=n("VkAN"),d=n.n(u),m=n("lSNA"),p=n.n(m),h=n("9oTK"),b=n("Puqe"),f=n.n(b),g=n("mwIZ"),O=n.n(g),v=n("7GkX"),y=n.n(v),E=n("q1tI"),C=n.n(E),j=n("17x9"),S=n.n(j),N=n("TSYQ"),A=n.n(N),M=n("/MKj"),T=n("Ty5D"),P=n("gY1J"),w=n("ePPS"),x=n("JqEL"),k=n("5ZU+"),I=n("nbpM"),D=n("XOD0"),R=n("Jje6"),L=n("DTlD"),q=n("uopA"),F=n("/Q2I"),B=n("dhJQ"),V=n("Vows"),U=n("6+t1"),_=n("rb4H"),G=n("/pl8"),Y=n("X67z"),Q=n("dsWg"),z=n("NgSR"),J=n("Xhf8"),Z=n("nDSK"),W=n("5XOi"),H=n("3qA6"),X=n.n(H);function K(){var e=d()(["Use the search to add a client, or keep empty to save as walk-in."]);return K=function(){return e},e}function $(){var e=d()(["Add client"]);return $=function(){return e},e}function ee(){var e=d()(["Block client"]);return ee=function(){return e},e}function te(){var e=d()(["Unblock client"]);return te=function(){return e},e}function ne(){var e=d()(["Edit client details"]);return ne=function(){return e},e}function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function re(){var e=d()(["Client Details"]);return re=function(){return e},e}function oe(){var e=d()(["Search client"]);return oe=function(){return e},e}var ie=()=>"translateX(100%)";function se(e){return Object(h.all)([k.a.readCustomer(e,{include:"customer-payment-method"}),k.a.readCustomerMarketingConsentLog(e)])}var ce={className:S.a.string,isMatch:S.a.bool,children:S.a.node,canResetCustomer:S.a.bool,customer:z.a,onSetCustomer:S.a.func,isActive:S.a.bool,onSetActive:S.a.func,displayEmptyPlaceholder:S.a.bool,forceInfo:S.a.bool,disableInfo:S.a.bool,removeCustomerText:S.a.string,dispatch:S.a.func,clientContext:S.a.object},le=y()(ce),ue=[P.c.CREATE,P.c.START_EDIT,P.c.EDIT],de=Object(B.g)()(a=Object(M.b)(e=>({clientContext:I.a.getClientContext(e)}))((o=r=class extends E.Component{constructor(t){super(t),p()(this,"setModalRef",e=>{!e||this.state.modalRef&&this.state.modalRef===e||this.setState({modalRef:e})}),p()(this,"deriveStateFromProps",e=>{var t,{customer:n}=e,a=O()(n,"id");a&&a!==this.loadedCustomerId&&(this.loadedCustomerId=a,a!==P.d&&se(a),t={searchActive:!1,infoActive:!1});var{searchActive:r,infoActive:o}=this.state||{};return this.isActive(e)||!r&&!o||(t={searchActive:!1,infoActive:!1}),t}),p()(this,"customerModalEventsHandler",void 0),p()(this,"handleSetCustomer",e=>{se(e).then(()=>{var{onSetCustomer:t}=this.props;t&&t(e)}),this.handleCloseDetails(),this.setState({searchModalOpen:!1})}),p()(this,"handleResetCustomer",()=>{this.handleCloseDetails(),this.props.onSetCustomer(null)}),p()(this,"handleCreateCustomer",()=>{k.a.resetCustomerContext(P.c.START_CREATE),this.props.dispatch(Object(J.a)())}),p()(this,"handleEditCustomer",()=>{var{customer:e}=this.props;k.a.resetCustomerContext(P.c.START_EDIT,e.id),Object(D.c)(Object(Q.u)(e.id))}),p()(this,"handleToggleBlockCustomer",()=>{var{customer:t}=this.props;Object(D.c)(Object(Q.r)({customer:t,currentPath:e.location.pathname}))}),p()(this,"handleOpenSearch",()=>{var{onSetActive:e}=this.props,t=e&&(()=>e(!0));this.setState({searchActive:!0},t)}),p()(this,"handleOpenInfo",()=>{var{onSetActive:e}=this.props,t=e&&(()=>e(!0));this.setState({infoActive:!0},t)}),p()(this,"handleCloseDetails",()=>{var{onSetActive:e}=this.props,t=e&&(()=>e(!1));this.setState({searchActive:!1,infoActive:!1},t)}),p()(this,"toggleSearchModal",()=>{this.setState({searchModalOpen:!this.state.searchModalOpen})}),p()(this,"handleCall",()=>{Object(x.g)(this.props.customer.contactNumber)}),p()(this,"renderSearchClientModal",()=>{var{isMatch:e}=this.props,{modalRef:t}=this.state;return C.a.createElement(F.i,{noPadding:!0},C.a.createElement(F.g,{onClose:this.toggleSearchModal,noBottomPadding:!0},Object(w.c)(oe())),C.a.createElement(F.c,{selfRef:this.setModalRef,onlyBottomPadding:!0},t&&C.a.createElement(Z.a,{grow:1,isOpen:!0,mobile:e,handleSetCustomer:this.handleSetCustomer,handleCreateCustomer:this.handleCreateCustomer,stickySearch:e,scrollableView:t})))}),p()(this,"renderClientDetailsModal",(e,t)=>{var{customer:n,isMatch:a}=this.props;return C.a.createElement(F.i,null,C.a.createElement(F.g,{onClose:this.handleCloseDetails},Object(w.c)(re())),C.a.createElement(F.c,{onlyBottomPadding:!0},C.a.createElement(W.a,{customer:n,detailsMode:e,isMatch:a,dropdownActions:t}),C.a.createElement(L.a,{customer:n,grow:1})))}),this.state=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({infoActive:!1,searchActive:!1,searchModalOpen:!1},this.deriveStateFromProps(t))}componentDidMount(){var{clientContext:{operation:e,clientId:t},customer:n}=this.props,a=!n||n.id!==t;k.a.resetCustomerContext(),a&&ue.includes(e)&&this.handleSetCustomer(t)}UNSAFE_componentWillReceiveProps(e){var t=this.deriveStateFromProps(e);t&&this.setState(t)}componentWillUnmount(){this.disableCustomerModalEventListeners()}isActive(e=this.props){var{isActive:t,onSetActive:n}=e;return void 0!==t?t:!n}disableCustomerModalEventListeners(){this.customerModalEventsHandler&&window.jQuery(window.document).off("customerUpdated customerDeleted",this.customerModalEventsHandler)}render(){var e=this.props,{className:t,isMatch:n,displayEmptyPlaceholder:a,customer:r,canResetCustomer:o,removeCustomerText:i,forceInfo:c,disableInfo:u,children:d,clientContext:m}=e,p=l()(e,["className","isMatch","displayEmptyPlaceholder","customer","canResetCustomer","removeCustomerText","forceInfo","disableInfo","children","clientContext"]),{searchActive:h,infoActive:b,searchModalOpen:g}=this.state,O=r&&r.id===P.d,v=this.isActive(),y=v&&h,E=v&&(b||c)&&r&&!O,j=E&&(!r.deletedAt||o),S=e=>[{show:n&&r&&!!r.contactNumber&&!r.obfuscatedContactNumber,onAction:this.handleCall,text:Object(w.c)("Call %{number}",{number:r&&r.contactNumber}),qaType:"customer-call"},{show:r&&!r.deletedAt,onAction:Object(G.c)(e.canSeeCustomerDetails,this.handleEditCustomer),text:Object(w.c)(ne()),qaType:"customer-edit"},{show:r&&!r.deletedAt,onAction:this.handleToggleBlockCustomer,text:r&&r.blocked?Object(w.c)(te()):Object(w.c)(ee()),qaType:"customer-block"},{show:o,onAction:this.handleResetCustomer,text:i,danger:!0,qaType:"customer-remove"}];return C.a.createElement(G.b,{keys:Y.a.CAN_SEE_CUSTOMER_DETAILS},e=>C.a.createElement(R.b,s()({grow:1,flex:"column",className:A()(X.a.self,t)},f()(p,le)),!r||y?n&&!y?C.a.createElement(V.b,{onAction:this.toggleSearchModal,qaType:"add-client-rb"},Object(w.c)($())):C.a.createElement(Z.a,{isOpen:y,mobile:n,autoFocus:y,handleOpenSearch:this.handleOpenSearch,handleSetCustomer:this.handleSetCustomer,handleCreateCustomer:this.handleCreateCustomer,grow:y?1:0}):C.a.createElement(W.a,{dropdownActions:S(e),detailsMode:j&&!n,customer:O?void 0:r,onAction:O?o?this.handleOpenSearch:void 0:u||E?void 0:this.handleOpenInfo}),!y&&C.a.createElement(R.b,{grow:1,shrink:1,flex:"column",className:X.a.children},C.a.createElement(R.b,{grow:1,shrink:1,flex:"column",className:A()({[X.a.withVerticalScroll]:!n})},a&&!n&&!r&&C.a.createElement(q.a,{icon:"fresh-no-results-found",iconColor:"original",text:Object(w.c)(K())}),d),!n&&r&&!O&&C.a.createElement(U.c,{getTranslateValue:ie,in:E,transitionAppear:!1},C.a.createElement(L.a,{className:A()(X.a.customerStats,X.a.withVerticalScroll),customer:r,grow:1}))),g&&this.renderSearchClientModal(),n&&E&&this.renderClientDetailsModal(j,S(e)),C.a.createElement(T.b,{exact:!0,path:"*".concat(Q.c),component:_.a}),C.a.createElement(T.b,{exact:!0,path:"*".concat(Q.p),component:_.b})))}},p()(r,"propTypes",ce),p()(r,"defaultProps",{canResetCustomer:!1,forceInfo:!1,disableInfo:!1}),a=o))||a)||a}).call(this,n("yLpj"))},uHid:function(e,t,n){"use strict";(function(e){var t=n("lSNA"),a=n.n(t),r=n("q1tI"),o=n("17x9"),i=n.n(o);class s extends r.PureComponent{constructor(e){super(e),this.state={isRendered:!1}}componentDidMount(){this.timeout=e.requestAnimationFrame(()=>{e.requestAnimationFrame(()=>{this.setState({isRendered:!0})})})}componentWillUnmount(){e.cancelAnimationFrame(this.timeout)}render(){var e=this.state.isRendered?this.props:{};return this.props.children(e)}}a()(s,"propTypes",{children:i.a.func})}).call(this,n("yLpj"))},uWUL:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a=n("VkAN"),r=n.n(a),o=n("q1tI"),i=n.n(o),s=n("17x9"),c=n.n(s),l=n("PhEd"),u=n("FAYg"),d=n("ePPS"),m=n("kWUZ"),p=n("i6OX"),h=n("/Q2I"),b=n("Z0vX"),f=n("Jje6"),g=n("Qy2B"),O=n.n(g);function v(){var e=r()(["Download import file"]);return v=function(){return e},e}function y(){var e=r()(["Copy and paste your client details into the spreadsheet"]);return y=function(){return e},e}function E(){var e=r()(["Download your import spreadsheet using the button below"]);return E=function(){return e},e}function C(){var e=r()(["Follow the simple instructions below to import clients to your Fresha partner account"]);return C=function(){return e},e}function j(){var e=r()(["Import Clients to Fresha"]);return j=function(){return e},e}function S({onClose:e}){var t="".concat(u.LEGACY_API_URL,"/customers/export.csv");return i.a.createElement(h.i,{sidebarContent:i.a.createElement(p.b,{name:"import-client",color:"original",size:"xxl"}),sidebarClassName:O.a.sidebar},i.a.createElement(h.g,{onClose:e},Object(d.c)(j())),i.a.createElement(h.c,{noPadding:!0},i.a.createElement(f.b,{className:O.a.wrapper},i.a.createElement(l.Text,{type:"fresha-paragraph",color:"gray50"},Object(d.c)(C())),i.a.createElement(b.b,{isSteps:!0,className:O.a.list},i.a.createElement(b.a,null,i.a.createElement(l.Text,{type:"fresha-paragraph",color:"gray100"},Object(d.c)(E()))),i.a.createElement(b.a,null,i.a.createElement(l.Text,{type:"fresha-paragraph",color:"gray100"},Object(d.c)(y()))),i.a.createElement(b.a,null,i.a.createElement(l.Text,{type:"fresha-paragraph",color:"gray100"},Object(d.c)("Email it back to us on %{email} and we'll add the clients to your account!",{email:i.a.createElement(l.Link,{inheritFont:!0,key:"contact-link",linkTo:"mailto:".concat(m.c)},m.c)})))))),i.a.createElement(h.e,null,i.a.createElement(l.Button,{variant:"primary",qaType:"download-import-file",linkTo:t},Object(d.c)(v()))))}S.propTypes={onClose:c.a.func.isRequired}},yvcj:function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));var a=n("VkAN"),r=n.n(a),o=n("lSNA"),i=n.n(o),s=n("q1tI"),c=n.n(s),l=n("17x9"),u=n.n(l),d=n("/MKj"),m=n("TSYQ"),p=n.n(m),h=n("TIN1"),b=n("nbpM"),f=n("ePPS"),g=n("Jje6"),O=n("ZO1O"),v=n("dhJQ"),y=n("PhEd"),E=n("yk2N"),C=n("DsbD"),j=n.n(C);function S(e){var t,{value:n,label:a,big:r,red:o,currencyCode:i}=e;return t=i?Object(E.h)(n,{currencyCode:i}):n,c.a.createElement(g.b,{className:p()(j.a.self,r?j.a.bigBox:j.a.smallBox,{[j.a.red]:o&&n>0})},c.a.createElement(y.Text,{className:j.a.value,type:"fresha-h3",color:"gray100"},t),c.a.createElement(y.Text,{type:"fresha-caption",color:"gray50"},a))}S.propTypes={value:u.a.oneOfType([u.a.string,u.a.number]),label:u.a.string.isRequired,big:u.a.bool,red:u.a.bool,currencyCode:u.a.string};var N,A,M,T=n("rc2L"),P=n.n(T);function w(){var e=r()(["No Shows"]);return w=function(){return e},e}function x(){var e=r()(["Cancelled"]);return x=function(){return e},e}function k(){var e=r()(["Completed"]);return k=function(){return e},e}function I(){var e=r()(["All bookings"]);return I=function(){return e},e}function D(){var e=r()(["Outstanding"]);return D=function(){return e},e}function R(){var e=r()(["Total Sales"]);return R=function(){return e},e}var L=Object(v.g)()(N=Object(d.b)((e,t)=>({clientStats:b.a.getCustomerStatistic(e,t.clientId),currencyCode:b.a.getCurrencyCode(e)}),{})((M=A=class extends s.PureComponent{render(){var{clientStats:{bookingsCount:e,cancelledBookingsCount:t,completedBookingsCount:n,noShowBookingsCount:a,outstandingSales:r,totalSales:o},currencyCode:i,isMatch:s}=this.props;return c.a.createElement(g.b,{className:P.a.self},c.a.createElement(O.d,{type:p()("noPadding",{plain:s})},c.a.createElement(g.b,{flex:"row",className:P.a.row},c.a.createElement(S,{value:o,label:Object(f.c)(R()),big:!0,currencyCode:i}),c.a.createElement(S,{value:r,label:Object(f.c)(D()),big:!0,currencyCode:i,red:!0})),c.a.createElement(g.b,{flex:"row",className:P.a.row},c.a.createElement(S,{value:e,label:Object(f.c)(I())}),c.a.createElement(S,{value:n,label:Object(f.c)(k())}),c.a.createElement(S,{value:t,label:Object(f.c)(x())}),c.a.createElement(S,{value:a,label:Object(f.c)(w()),red:!0}))))}},i()(A,"propTypes",{clientStats:u.a.shape(h.a.propTypes),currencyCode:u.a.string,isMatch:u.a.bool}),N=M))||N)||N},zYuS:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var a=n("VkAN"),r=n.n(a),o=n("lSNA"),i=n.n(o),s=n("q1tI"),c=n.n(s),l=n("17x9"),u=n.n(l),d=n("TSYQ"),m=n.n(d),p=n("PhEd"),h=n("ePPS"),b=n("SFs4"),f=n("vfnK"),g=n("X67z"),O=n("/pl8"),v=n("DuVZ"),y=n("v4xV"),E=n.n(y);function C(){var e=r()(["Review Duplicates"]);return C=function(){return e},e}function j(){var e=r()(["An existing client has identical contact info, switch clients now to\n        prevent adding duplicates"]);return j=function(){return e},e}function S(){var e=r()(["Review & merge"]);return S=function(){return e},e}function N(){var e=r()(["We found duplicated Client Profiles. Use smart merging to combine all data into one item."]);return N=function(){return e},e}function A(){var e=r()(["Review & merge"]);return A=function(){return e},e}function M(){var e=r()(["This client has duplicate profiles, use smart merging to combine them together."]);return M=function(){return e},e}var T={PROFILE:"profile",MERGE_RUNNING:"merge_running",LIST:"list",FORM:"form"};class P extends s.PureComponent{getNotificationText(){var{type:e}=this.props,t={notification:"",button:""};switch(e){case T.PROFILE:t.notification=Object(h.c)(M()),t.button=Object(h.c)(A());break;case T.LIST:t.notification=Object(h.c)(N()),t.button=Object(h.c)(S());break;case T.MERGE_RUNNING:t.notification=v.d;break;case T.FORM:t.notification=Object(h.c)(j()),t.button=Object(h.c)(C())}return t}render(){var{isMatch:e,handleMergeCustomer:t,hideNotificationBar:n,className:a,isMobileNotificationBox:r,negativeMargin:o}=this.props,i=this.getNotificationText();return c.a.createElement(O.b,{keys:g.a.CAN_SEE_CUSTOMER_DETAILS},r&&e||!e?c.a.createElement(f.b,{className:m()(E.a.notificationBar,a,{[E.a.negativeMargin]:o,[E.a.mobile]:e}),onClose:n,notificationText:i.notification,buttonText:i.button,buttonAction:t,buttonQaType:"review-duplicates-button",notificationTextQaType:"review-duplicates-text"}):c.a.createElement(b.b,{className:m()(a),icon:"light-bulb-yellow",title:c.a.createElement(c.a.Fragment,null,i.notification," ",i.button&&c.a.createElement(p.Link,{inheritFont:!0,className:E.a.link,onAction:t},i.button))}))}}i()(P,"types",T),i()(P,"propTypes",{type:u.a.oneOf(Object.values(T)).isRequired,isMatch:u.a.bool.isRequired,handleMergeCustomer:u.a.func.isRequired,hideNotificationBar:u.a.func.isRequired,className:u.a.string,isMobileNotificationBox:u.a.bool,negativeMargin:u.a.bool}),i()(P,"defaultProps",{isMobileNotificationBox:!1})},zg6z:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return x}));var a,r,o,i=n("pVnL"),s=n.n(i),c=n("VkAN"),l=n.n(c),u=n("QILm"),d=n.n(u),m=n("lSNA"),p=n.n(m),h=n("DzJC"),b=n.n(h),f=n("q1tI"),g=n.n(f),O=n("17x9"),v=n.n(O),y=n("TSYQ"),E=n.n(y),C=n("ePPS"),j=n("Jje6"),S=n("Qs7Y"),N=n("3wSE"),A=n("dhJQ"),M=n("Xszq"),T=n.n(M);function P(){var e=l()(["Show more"]);return P=function(){return e},e}function w(){var e=l()(["Show less"]);return w=function(){return e},e}var x=Object(A.g)()((o=r=class extends f.PureComponent{constructor(...e){super(...e),p()(this,"state",{more:!1,collapsible:!1}),p()(this,"onShowMoreClick",()=>{this.setState({more:!this.state.more},this.setContainerHeight)}),p()(this,"calculateIfShowMore",()=>{if(this.refContent){var e=this.refContent.getBoundingClientRect().height;e!==this.textHeight&&(this.textHeight=e,e>this.maxHeight?this.setState({collapsible:!0},this.setContainerHeight):(this.setState({collapsible:!1,more:!1}),this.refNote.style.height=""))}}),p()(this,"raf",null),p()(this,"maxHeight",32),p()(this,"textHeight",null),p()(this,"refNote",null),p()(this,"refContent",null),p()(this,"resizeEventListener",b()(this.calculateIfShowMore,100)),p()(this,"refHandlers",{note:e=>{this.refNote=e},content:e=>{this.refContent=e}})}componentDidMount(){this.raf=e.requestAnimationFrame(this.calculateIfShowMore),e.addEventListener("resize",this.resizeEventListener)}componentDidUpdate(){this.raf=e.requestAnimationFrame(this.calculateIfShowMore)}componentWillUnmount(){e.cancelAnimationFrame(this.raf),e.removeEventListener("resize",this.resizeEventListener),this.resizeEventListener.cancel()}setContainerHeight(){this.refNote.style.height="".concat(this.state.more?this.textHeight:this.maxHeight,"px")}render(){var e=this.props,{className:t,note:n,isMatch:a}=e,r=d()(e,["className","note","isMatch"]),{collapsible:o,more:i}=this.state;return g.a.createElement(j.b,s()({qaType:"customer-note",className:E()(T.a.self,t)},r),g.a.createElement(j.b,{className:T.a.scrollArea},g.a.createElement(j.b,{selfRef:this.refHandlers.note,className:E()(T.a.note,{[T.a.collapsible]:o})},g.a.createElement(S.d,{qaType:"customer-note-text",selfRef:this.refHandlers.content,breakWord:!0,type:a?"body-1":"body-2"},n))),o&&g.a.createElement(N.n,{qaType:"customer-note-link",className:T.a.showMore,onAction:this.onShowMoreClick},i?Object(C.c)(w()):Object(C.c)(P())))}},p()(r,"propTypes",{className:v.a.string,note:v.a.string.isRequired,isMatch:v.a.bool}),a=o))||a}).call(this,n("yLpj"))}}]);